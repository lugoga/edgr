<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 A grammar for graphics | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 A grammar for graphics | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 A grammar for graphics | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2019-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-grammar-for-graphics.html">
<link rel="next" href="graphics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.6/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/Dygraph.Plugins.Unzoom-1.0/unzoom.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i>Sources</a></li>
<li class="chapter" data-level="" data-path="note-to-the-reader.html"><a href="note-to-the-reader.html"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-learn-computer-programming"><i class="fa fa-check"></i><b>1.1</b> Why learn computer Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r-1"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-features-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Features of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
<li class="chapter" data-level="1.3.9" data-path="intro.html"><a href="intro.html#getting-help-in-r"><i class="fa fa-check"></i><b>1.3.9</b> Getting Help in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-started.html"><a href="get-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="get-started.html"><a href="get-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-started.html"><a href="get-started.html#r-operators"><i class="fa fa-check"></i><b>2.1.1</b> R operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-started.html"><a href="get-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-started.html"><a href="get-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-started.html"><a href="get-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-started.html"><a href="get-started.html#naming-conventions"><i class="fa fa-check"></i><b>2.2.2</b> Naming conventions</a></li>
<li class="chapter" data-level="2.2.3" data-path="get-started.html"><a href="get-started.html#functions"><i class="fa fa-check"></i><b>2.2.3</b> Functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="get-started.html"><a href="get-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-started.html"><a href="get-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="get-started.html"><a href="get-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-started.html"><a href="get-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-started.html"><a href="get-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="get-started.html"><a href="get-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="get-started.html"><a href="get-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="get-started.html"><a href="get-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="get-started.html"><a href="get-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="get-started.html"><a href="get-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="get-started.html"><a href="get-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="get-started.html"><a href="get-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="get-started.html"><a href="get-started.html#tibbles"><i class="fa fa-check"></i><b>2.7</b> tibbles</a><ul>
<li class="chapter" data-level="2.7.1" data-path="get-started.html"><a href="get-started.html#column-names"><i class="fa fa-check"></i><b>2.7.1</b> Column Names</a></li>
<li class="chapter" data-level="2.7.2" data-path="get-started.html"><a href="get-started.html#add-rows-and-columns"><i class="fa fa-check"></i><b>2.7.2</b> Add rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="get-started.html"><a href="get-started.html#exercise"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
<li class="chapter" data-level="2.9" data-path="get-started.html"><a href="get-started.html#exercise-1"><i class="fa fa-check"></i><b>2.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>3</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="3.0.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types-1"><i class="fa fa-check"></i><b>3.0.1</b> Data Types</a></li>
<li class="chapter" data-level="3.0.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors-1"><i class="fa fa-check"></i><b>3.0.2</b> Vectors</a></li>
<li class="chapter" data-level="3.0.3" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element-1"><i class="fa fa-check"></i><b>3.0.3</b> Indexing the element</a></li>
<li class="chapter" data-level="3.0.4" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector-1"><i class="fa fa-check"></i><b>3.0.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="3.0.5" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector-1"><i class="fa fa-check"></i><b>3.0.5</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="3.0.6" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>3.0.6</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="3.0.7" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>3.0.7</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="3.0.8" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>3.0.8</b> Rounding off numbers</a></li>
<li class="chapter" data-level="3.1" data-path="dataTypes.html"><a href="dataTypes.html#data-frame-1"><i class="fa fa-check"></i><b>3.1</b> Data Frame</a><ul>
<li class="chapter" data-level="3.1.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>3.1.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>3.2</b> Matrix</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>3.2.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="3.2.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>3.2.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>3.3</b> Arrays</a></li>
<li class="chapter" data-level="3.4" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>3.4</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>4</b> Vector Data</a><ul>
<li class="chapter" data-level="4.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="vector.html"><a href="vector.html#numeric-vector"><i class="fa fa-check"></i><b>4.2</b> Numeric Vector</a></li>
<li class="chapter" data-level="4.3" data-path="vector.html"><a href="vector.html#integer-vector"><i class="fa fa-check"></i><b>4.3</b> Integer vector</a></li>
<li class="chapter" data-level="4.4" data-path="vector.html"><a href="vector.html#character-vector"><i class="fa fa-check"></i><b>4.4</b> Character vector</a></li>
<li class="chapter" data-level="4.5" data-path="vector.html"><a href="vector.html#logical-vector"><i class="fa fa-check"></i><b>4.5</b> Logical Vector</a></li>
<li class="chapter" data-level="4.6" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>4.6</b> Vector Data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>4.6.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>4.7</b> Reading vector data</a><ul>
<li class="chapter" data-level="4.7.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>4.7.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="4.7.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>4.7.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>4.8</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="4.9" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>4.9</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>5</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="5.1" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>5.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="5.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>5.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="5.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>5.3</b> Writing t a File</a></li>
<li class="chapter" data-level="5.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>5.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="5.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>5.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="5.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>5.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>6.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-functionality"><i class="fa fa-check"></i><b>6.2</b> dplyr functionality</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#filter-keep-rows-matching-criteria"><i class="fa fa-check"></i><b>6.3</b> filter: Keep rows matching criteria</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#needed-packages"><i class="fa fa-check"></i><b>6.4</b> Needed packages</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#select-pick-columns-by-name"><i class="fa fa-check"></i><b>6.5</b> select: Pick columns by name</a></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#chaining-or-pipelining"><i class="fa fa-check"></i><b>6.6</b> “Chaining” or “Pipelining”</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#pipping-with"><i class="fa fa-check"></i><b>6.7</b> Pipping with</a><ul>
<li class="chapter" data-level="6.7.1" data-path="dplyr.html"><a href="dplyr.html#choosing-columns-select-rename"><i class="fa fa-check"></i><b>6.7.1</b> Choosing columns: <code>select()</code>, <code>rename()</code></a></li>
<li class="chapter" data-level="6.7.2" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filter-between-slice-sample_n-top_n-distinct"><i class="fa fa-check"></i><b>6.7.2</b> Choosing rows: filter, between, slice, sample_n, top_n, distinct</a></li>
<li class="chapter" data-level="6.7.3" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>6.7.3</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="6.7.4" data-path="dplyr.html"><a href="dplyr.html#grouping-and-counting-summarise-tally-count-group_size-n_groups-ungroup"><i class="fa fa-check"></i><b>6.7.4</b> Grouping and counting: summarise, tally, count, group_size, n_groups, ungroup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>7</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="7.1" data-path="tidy.html"><a href="tidy.html#gather-function"><i class="fa fa-check"></i><b>7.1</b> gather( ) function:</a></li>
<li class="chapter" data-level="7.2" data-path="tidy.html"><a href="tidy.html#separate-function"><i class="fa fa-check"></i><b>7.2</b> separate( ) function:</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html"><i class="fa fa-check"></i><b>8</b> Working with Dates and Time</a><ul>
<li class="chapter" data-level="8.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#getting-the-date-and-time-with-localtime"><i class="fa fa-check"></i><b>8.1</b> Getting the Date and Time with localtime</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-strings-to-dates"><i class="fa fa-check"></i><b>8.2</b> Converting strings to Dates</a><ul>
<li class="chapter" data-level="8.2.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#convert-strings-to-dates"><i class="fa fa-check"></i><b>8.2.1</b> convert strings to dates</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-date-with-lubridate-package"><i class="fa fa-check"></i><b>8.3</b> Converting date with <strong>lubridate</strong> package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="isodate-converts-to-a-posixct-object.html"><a href="isodate-converts-to-a-posixct-object.html"><i class="fa fa-check"></i><b>9</b> ISOdate converts to a POSIXct object</a><ul>
<li class="chapter" data-level="9.1" data-path="isodate-converts-to-a-posixct-object.html"><a href="isodate-converts-to-a-posixct-object.html#gmt-2013-05-22-120000-gmt"><i class="fa fa-check"></i><b>9.1</b> [1] “2012-01-02 12:00:00 GMT” “2013-05-22 12:00:00 GMT”</a></li>
<li class="chapter" data-level="9.2" data-path="isodate-converts-to-a-posixct-object.html"><a href="isodate-converts-to-a-posixct-object.html#gmt-2015-02-28-120000-gmt"><i class="fa fa-check"></i><b>9.2</b> [3] “2014-07-15 12:00:00 GMT” “2015-02-28 12:00:00 GMT”</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="truncate-the-unused-time-data-by-converting-with-as-date.html"><a href="truncate-the-unused-time-data-by-converting-with-as-date.html"><i class="fa fa-check"></i><b>10</b> truncate the unused time data by converting with as.Date</a><ul>
<li class="chapter" data-level="10.1" data-path="truncate-the-unused-time-data-by-converting-with-as-date.html"><a href="truncate-the-unused-time-data-by-converting-with-as-date.html#section"><i class="fa fa-check"></i><b>10.1</b> [1] “2012-01-02” “2013-05-22” “2014-07-15” “2015-02-28”</a></li>
<li class="chapter" data-level="10.2" data-path="truncate-the-unused-time-data-by-converting-with-as-date.html"><a href="truncate-the-unused-time-data-by-converting-with-as-date.html#creating-date-sequences"><i class="fa fa-check"></i><b>10.2</b> Creating Date Sequences</a></li>
<li class="chapter" data-level="10.3" data-path="truncate-the-unused-time-data-by-converting-with-as-date.html"><a href="truncate-the-unused-time-data-by-converting-with-as-date.html#calculations-with-dates"><i class="fa fa-check"></i><b>10.3</b> Calculations with Dates</a></li>
<li class="chapter" data-level="10.4" data-path="truncate-the-unused-time-data-by-converting-with-as-date.html"><a href="truncate-the-unused-time-data-by-converting-with-as-date.html#time-difference-of-15-days"><i class="fa fa-check"></i><b>10.4</b> Time difference of 15 days</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="example-with-time-zones.html"><a href="example-with-time-zones.html"><i class="fa fa-check"></i><b>11</b> example with time zones</a><ul>
<li class="chapter" data-level="11.1" data-path="example-with-time-zones.html"><a href="example-with-time-zones.html#time-interval"><i class="fa fa-check"></i><b>11.1</b> Time Interval</a></li>
<li class="chapter" data-level="11.2" data-path="example-with-time-zones.html"><a href="example-with-time-zones.html#ctd-list"><i class="fa fa-check"></i><b>11.2</b> ctd list</a></li>
<li class="chapter" data-level="11.3" data-path="example-with-time-zones.html"><a href="example-with-time-zones.html#arithmetic-with-date-times"><i class="fa fa-check"></i><b>11.3</b> Arithmetic with date times</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>12</b> Raster Data</a><ul>
<li class="chapter" data-level="12.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>12.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="12.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>12.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="12.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>12.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="12.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>12.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="12.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>12.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="12.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>12.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>12.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="12.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>12.3</b> Raster resolution</a></li>
<li class="chapter" data-level="12.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>12.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="12.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>12.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="12.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>12.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>12.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="12.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>12.7</b> Raster time series data</a></li>
<li class="chapter" data-level="12.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>12.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>13</b> Control flow</a><ul>
<li class="chapter" data-level="13.1" data-path="control-flow.html"><a href="control-flow.html#for-loop"><i class="fa fa-check"></i><b>13.1</b> for loop</a><ul>
<li class="chapter" data-level="13.1.1" data-path="control-flow.html"><a href="control-flow.html#for-loop-on-array"><i class="fa fa-check"></i><b>13.1.1</b> For loop on array</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="control-flow.html"><a href="control-flow.html#if-and-else-statement"><i class="fa fa-check"></i><b>13.2</b> if and else statement</a></li>
<li class="chapter" data-level="13.3" data-path="control-flow.html"><a href="control-flow.html#functions-1"><i class="fa fa-check"></i><b>13.3</b> Functions</a><ul>
<li class="chapter" data-level="13.3.1" data-path="control-flow.html"><a href="control-flow.html#core-functions"><i class="fa fa-check"></i><b>13.3.1</b> core functions</a></li>
<li class="chapter" data-level="13.3.2" data-path="control-flow.html"><a href="control-flow.html#user-defined-functions"><i class="fa fa-check"></i><b>13.3.2</b> user defined functions</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="control-flow.html"><a href="control-flow.html#packages"><i class="fa fa-check"></i><b>13.4</b> packages</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="functions-and-packages.html"><a href="functions-and-packages.html"><i class="fa fa-check"></i><b>14</b> Functions and packages</a><ul>
<li class="chapter" data-level="14.0.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#core-functions-1"><i class="fa fa-check"></i><b>14.0.1</b> core functions</a></li>
<li class="chapter" data-level="14.0.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#user-defined-functions-1"><i class="fa fa-check"></i><b>14.0.2</b> user defined functions</a></li>
<li class="chapter" data-level="14.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#packages-1"><i class="fa fa-check"></i><b>14.1</b> packages</a></li>
<li class="chapter" data-level="14.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#function-pipelines"><i class="fa fa-check"></i><b>14.2</b> function pipelines</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>15</b> A grammar for graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#a-profile-data-frame"><i class="fa fa-check"></i><b>15.1</b> A profile data frame</a></li>
<li class="chapter" data-level="15.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#fundamental-parts-of-ggplot2"><i class="fa fa-check"></i><b>15.2</b> Fundamental Parts of <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="15.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#basic-plots"><i class="fa fa-check"></i><b>15.3</b> Basic plots</a><ul>
<li class="chapter" data-level="15.3.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scatterplot"><i class="fa fa-check"></i><b>15.3.1</b> scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#linegraph"><i class="fa fa-check"></i><b>15.4</b> Linegraph</a><ul>
<li class="chapter" data-level="15.4.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#histogram"><i class="fa fa-check"></i><b>15.4.1</b> histogram</a></li>
<li class="chapter" data-level="15.4.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#boxplot"><i class="fa fa-check"></i><b>15.4.2</b> boxplot</a></li>
<li class="chapter" data-level="15.4.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#barplot"><i class="fa fa-check"></i><b>15.4.3</b> barplot</a></li>
<li class="chapter" data-level="15.4.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#barplot-for-values"><i class="fa fa-check"></i><b>15.4.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#advanced-plots"><i class="fa fa-check"></i><b>15.5</b> Advanced plots</a><ul>
<li class="chapter" data-level="15.5.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#facets"><i class="fa fa-check"></i><b>15.5.1</b> Facets</a></li>
<li class="chapter" data-level="15.5.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#sea-surface-temperature"><i class="fa fa-check"></i><b>15.5.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="15.5.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#subplot"><i class="fa fa-check"></i><b>15.5.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#colour"><i class="fa fa-check"></i><b>15.6</b> Colour</a></li>
<li class="chapter" data-level="15.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#size"><i class="fa fa-check"></i><b>15.7</b> size</a></li>
<li class="chapter" data-level="15.8" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scaling"><i class="fa fa-check"></i><b>15.8</b> scaling</a></li>
<li class="chapter" data-level="15.9" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides"><i class="fa fa-check"></i><b>15.9</b> Guides</a></li>
<li class="chapter" data-level="15.10" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#add-on-packages"><i class="fa fa-check"></i><b>15.10</b> Add-on packages</a></li>
<li class="chapter" data-level="15.11" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#ggridges"><i class="fa fa-check"></i><b>15.11</b> ggridges</a></li>
<li class="chapter" data-level="15.12" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>15.12</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="15.13" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#metr"><i class="fa fa-check"></i><b>15.13</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html"><i class="fa fa-check"></i><b>16</b> A grammar for graphics</a><ul>
<li class="chapter" data-level="16.1" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#geoms"><i class="fa fa-check"></i><b>16.1</b> geoms</a><ul>
<li class="chapter" data-level="16.1.1" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#regression-line"><i class="fa fa-check"></i><b>16.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="16.1.2" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>16.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#aes"><i class="fa fa-check"></i><b>16.2</b> aes()</a><ul>
<li class="chapter" data-level="16.2.1" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#color"><i class="fa fa-check"></i><b>16.2.1</b> Color</a></li>
<li class="chapter" data-level="16.2.2" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#shape"><i class="fa fa-check"></i><b>16.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#axis-and-labels"><i class="fa fa-check"></i><b>16.3</b> Axis and labels</a></li>
<li class="chapter" data-level="16.4" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#text-annotaion"><i class="fa fa-check"></i><b>16.4</b> Text annotaion</a></li>
<li class="chapter" data-level="16.5" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#scales"><i class="fa fa-check"></i><b>16.5</b> Scales</a></li>
<li class="chapter" data-level="16.6" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#guides-1"><i class="fa fa-check"></i><b>16.6</b> Guides</a></li>
<li class="chapter" data-level="16.7" data-path="a-grammar-for-graphics-1.html"><a href="a-grammar-for-graphics-1.html#themes"><i class="fa fa-check"></i><b>16.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>17</b> Making Maps</a><ul>
<li class="chapter" data-level="17.1" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>17.1</b> Static Maps</a></li>
<li class="chapter" data-level="17.2" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>17.2</b> Introduction</a><ul>
<li class="chapter" data-level="17.2.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>17.2.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="graphics.html"><a href="graphics.html#basemap"><i class="fa fa-check"></i><b>17.3</b> Basemap</a></li>
<li class="chapter" data-level="17.4" data-path="graphics.html"><a href="graphics.html#creating-contour-map"><i class="fa fa-check"></i><b>17.4</b> Creating contour map</a></li>
<li class="chapter" data-level="17.5" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>17.5</b> Inset maps</a><ul>
<li class="chapter" data-level="17.5.1" data-path="graphics.html"><a href="graphics.html#choropleth-maps"><i class="fa fa-check"></i><b>17.5.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>17.6</b> Animated maps</a></li>
<li class="chapter" data-level="17.7" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>17.7</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="animation.html"><a href="animation.html"><i class="fa fa-check"></i><b>18</b> Animation</a><ul>
<li class="chapter" data-level="18.1" data-path="animation.html"><a href="animation.html#animation-1"><i class="fa fa-check"></i><b>18.1</b> Animation</a></li>
<li class="chapter" data-level="18.2" data-path="animation.html"><a href="animation.html#isosurface"><i class="fa fa-check"></i><b>18.2</b> isosurface</a></li>
<li class="chapter" data-level="18.3" data-path="animation.html"><a href="animation.html#checking-for-proper-interpolation-methods"><i class="fa fa-check"></i><b>18.3</b> checking for proper interpolation methods</a><ul>
<li class="chapter" data-level="18.3.1" data-path="animation.html"><a href="animation.html#fluorescence-section"><i class="fa fa-check"></i><b>18.3.1</b> Fluorescence section</a></li>
<li class="chapter" data-level="18.3.2" data-path="animation.html"><a href="animation.html#temperature-section"><i class="fa fa-check"></i><b>18.3.2</b> Temperature section</a></li>
<li class="chapter" data-level="18.3.3" data-path="animation.html"><a href="animation.html#dissolved-oxygen-section"><i class="fa fa-check"></i><b>18.3.3</b> Dissolved Oxygen section</a></li>
<li class="chapter" data-level="18.3.4" data-path="animation.html"><a href="animation.html#salinity-section"><i class="fa fa-check"></i><b>18.3.4</b> Salinity section</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="forecast-time-series.html"><a href="forecast-time-series.html"><i class="fa fa-check"></i><b>19</b> Forecast time series</a><ul>
<li class="chapter" data-level="19.1" data-path="forecast-time-series.html"><a href="forecast-time-series.html#introduction-2"><i class="fa fa-check"></i><b>19.1</b> introduction</a></li>
<li class="chapter" data-level="19.2" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data"><i class="fa fa-check"></i><b>19.2</b> Data</a></li>
<li class="chapter" data-level="19.3" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-processing"><i class="fa fa-check"></i><b>19.3</b> Data processing</a></li>
<li class="chapter" data-level="19.4" data-path="forecast-time-series.html"><a href="forecast-time-series.html#forecasting"><i class="fa fa-check"></i><b>19.4</b> Forecasting</a></li>
<li class="chapter" data-level="19.5" data-path="forecast-time-series.html"><a href="forecast-time-series.html#visualize-the-forecasted-values"><i class="fa fa-check"></i><b>19.5</b> Visualize the forecasted values</a></li>
<li class="chapter" data-level="19.6" data-path="forecast-time-series.html"><a href="forecast-time-series.html#conclusion"><i class="fa fa-check"></i><b>19.6</b> conclusion</a></li>
<li class="chapter" data-level="19.7" data-path="forecast-time-series.html"><a href="forecast-time-series.html#reference"><i class="fa fa-check"></i><b>19.7</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="packages-2.html"><a href="packages-2.html"><i class="fa fa-check"></i><b>20</b> packages</a><ul>
<li class="chapter" data-level="20.1" data-path="packages-2.html"><a href="packages-2.html#one-sample-t-test"><i class="fa fa-check"></i><b>20.1</b> One Sample t Test</a></li>
<li class="chapter" data-level="20.2" data-path="packages-2.html"><a href="packages-2.html#paired-t-test"><i class="fa fa-check"></i><b>20.2</b> Paired t test</a></li>
<li class="chapter" data-level="20.3" data-path="packages-2.html"><a href="packages-2.html#levenes-test"><i class="fa fa-check"></i><b>20.3</b> Levene’s Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-grammar-for-graphics-1" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> A grammar for graphics</h1>
<div id="geoms" class="section level2">
<h2><span class="header-section-number">16.1</span> geoms</h2>
<p>In this section, we will create some of the most routinely used plots to explore data using the <code>geom_</code> functions.</p>
<p>We will use the following libraries in this post:</p>
<ul>
<li><strong>readr</strong></li>
<li><strong>ggplot2</strong></li>
<li><strong>tibble</strong></li>
<li><strong>dplyr</strong></li>
</ul>
<p>Which are part of the tidyverse. By loading the tidyverse, we also load all the packages mentioned above</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)</code></pre>
<p>All the data sets used in this post can be found here and code can be downloaded from <a href="www.">here</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">octopus =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;./data/octopus_data.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   date = col_date(format = &quot;&quot;),
##   village = col_character(),
##   port = col_character(),
##   ground = col_character(),
##   sex = col_character(),
##   dml = col_double(),
##   tl = col_double(),
##   weight = col_double(),
##   lat = col_double(),
##   lon = col_double()
## )</code></pre>
<p>The variables representing the <code>X</code> and <code>Y</code> axis can be specified either in <code>ggplot()</code> or in <code>geom_point()</code>. We will learn to modify the appearance of the points in a different post.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
<div id="regression-line" class="section level3">
<h3><span class="header-section-number">16.1.1</span> Regression Line</h3>
<p>You can fit the regression on the scatterplot with <code>geom_smooth()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">lm =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;linear model&quot;</span>)

gam =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;GAM&quot;</span>)

loess =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;LOESS&quot;</span>)

egg<span class="op">::</span><span class="kw">ggarrange</span>(lm,gam, loess, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-390-1.png" width="672" /></p>
</div>
<div id="horizontal-vertical-lines" class="section level3">
<h3><span class="header-section-number">16.1.2</span> Horizontal/ vertical lines</h3>
<p>A segment of horizontal or vertical line can be added on the plot using egg::ggarrange</p>
<div id="vertical-line" class="section level4">
<h4><span class="header-section-number">16.1.2.1</span> Vertical Line</h4>
<p>For the vertical line, the <code>x</code> axis intercept must be specified in <code>geom_vline()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">100</span>, <span class="dt">linetype =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
</div>
<div id="vertical-line-1" class="section level4">
<h4><span class="header-section-number">16.1.2.2</span> Vertical Line</h4>
<p>In similar manner, for the horizontal line, the <code>y</code> axis intercept must be specified in <code>geom_hline()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">2</span>, <span class="dt">linetype =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-392-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="aes" class="section level2">
<h2><span class="header-section-number">16.2</span> aes()</h2>
<p>In this section, we focus on the <code>aesthetics</code> i.e. color, shape, size, alpha, line type, line width etc. We can map these to variables or specify values for them. If we want to map the above to variables, we have to specify them within the <code>aes()</code> function. We will look at both methods in the following sections.</p>
<p>Explore aesthetics such as</p>
<ul>
<li>color</li>
<li>shape</li>
<li>size</li>
<li>fill</li>
<li>alpha</li>
<li>width</li>
</ul>
<div id="color" class="section level3">
<h3><span class="header-section-number">16.2.1</span> Color</h3>
<p>In <strong>ggplot2</strong>, when we mention color or colour, it usually refers to the color of the geoms. The <code>fill</code> argument is used to specify the color of the shapes in certain cases. In this section, we will see how we can specify the color for the different geoms we learnt in the previous post.</p>
<p>For points, the color argument specifies the color of the point for certain shapes and border for others. The fill argument is used to specify the background for some shapes and will not work with other shapes. Let us look at an example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
<p>If you do not want to map a variable to color, you can specify it separately using the color argument but in this case it should be outside the aes() function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-394-1.png" width="672" /></p>
</div>
<div id="shape" class="section level3">
<h3><span class="header-section-number">16.2.2</span> shape</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">shape =</span> sex)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
<p>Let us map size of points to a variable. It is advised to map size only to continuous variables and not categorical variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex, <span class="dt">size =</span> dml)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-396-1.png" width="672" /></p>
</div>
</div>
<div id="axis-and-labels" class="section level2">
<h2><span class="header-section-number">16.3</span> Axis and labels</h2>
<p>In this section, we learn about about aesthetic and focus on</p>
<ul>
<li>add title and subtitle to the plot</li>
<li>modify axis labels</li>
<li>modify axis range</li>
<li>remove axis
format axis</li>
</ul>
<p>Let us start with a simple scatter plot. We will continue to use the octopus data set and examine the relationship between total length and body weight using <code>geom_point()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">oct =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)</code></pre>
<p>We add the axis labels, title and subtitle for the plot using the <code>labs()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Octopus&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;The total length and body weight of octopus&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-398-1.png" width="672" />
## Axis Range
Often times, you may want to modify the range of the axis value. In <strong>ggplot2</strong>, we can achieve this using <code>scale_</code>function</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Octopus&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;The total length and body weight of octopus&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">180</span>,<span class="dv">30</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">1</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
<p>Sometimes the axis label become a reduntat</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-400-1.png" width="672" /></p>
</div>
<div id="text-annotaion" class="section level2">
<h2><span class="header-section-number">16.4</span> Text annotaion</h2>
<p>Annotation help to add custom text to the plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">20</span>, <span class="dt">y =</span> <span class="fl">2.2</span>, <span class="dt">label =</span> <span class="st">&quot;outlier&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
<div id="scales" class="section level2">
<h2><span class="header-section-number">16.5</span> Scales</h2>
<p>Scales help to modify the axis. <strong>ggplot2</strong> and its extensions has several <code>scale_*()</code> functions for that purpose. These function allows to modify titles, labels, limits, breaks and position of the axis.</p>
<p>The x and y-axis of a continuous data is modified with the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, 
       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">150</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">50</span>,<span class="dv">150</span>,<span class="dv">20</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(.<span class="dv">5</span>, <span class="dv">3</span>, <span class="fl">.5</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-402-1.png" width="672" /></p>
<p>The x and y-axis of a continuous data is modified with the <code>scale_x_discrete()</code> and <code>scale_y_continuous()</code> functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.16</span>,<span class="fl">0.25</span>,.<span class="dv">02</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
<p>when the data has been transformed, for instance because of the low value, chlorophyll-a are often stretched with the log-tranformation for visual appeal. But the log-transformed values make no sense about concentration and hence the real values must replace them. We can change the tick labels using the labels argument. When adding labels, tick breaks and labels must have the same length.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>()))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), 
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">1.8</span>,<span class="op">-</span><span class="fl">1.4</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),
                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.16</span>,<span class="fl">0.25</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
<p>The position of the axes can be changed using the <code>position</code> argument. For instance, to move the the x-axis to the top of the plot you only need to specify <code>position = top</code> as written in code below;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>()))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>,
                   <span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), 
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">1.8</span>,<span class="op">-</span><span class="fl">1.4</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),
                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.16</span>,<span class="fl">0.25</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-405-1.png" width="672" /></p>
<p>Fill the boxplot with season to specify the colors and arrange the colors manual with <code>scale_fill_manual()</code> function as written below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl, <span class="dt">fill =</span> season))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>),
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.16</span>,<span class="fl">0.25</span>,.<span class="dv">02</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
<p>Note the order of layers matter here: you <code>scale_fill_manual()</code> function must start before <code>scale_x_discrete()</code> function. Otherwise the colours you specify mismatch with legend colors as shown</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl, <span class="dt">fill =</span> season))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>),
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.16</span>,<span class="fl">0.25</span>,.<span class="dv">02</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-407-1.png" width="672" /></p>
<p>The <code>scale_*_reverse()</code> allows to reverse the order of the axis. For instance, when plotting profiles, we reverse y-xis and position the label of x-axis at the top</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> algoa.average, 
       <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> pressure))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-409-1.png" width="672" /></p>
</div>
<div id="guides-1" class="section level2">
<h2><span class="header-section-number">16.6</span> Guides</h2>
<p><code>guides()</code> helps to set, modify and remove legend for a specific aesthetic. It has two functions—<code>guide_legend()</code> or <code>guide_colorbar()</code>. Let make a section plot of the fluorescence with the default options for the legend</p>
<pre class="sourceCode r"><code class="sourceCode r">section =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>),
       <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> pressure, <span class="dt">z =</span> fluorescence)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">.15</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>( <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">200</span>,<span class="dv">0</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), 
                       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="fl">1.25</span>, <span class="dt">length.out =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="kw">round</span>(<span class="dv">2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Section of oxygen along latitude&quot;</span>, metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="op">-</span><span class="fl">10.54</span>)))

section</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
<p>We can add the contour labels and remove the legend in a graph</p>
<pre class="sourceCode r"><code class="sourceCode r">section <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-411-1.png" width="672" /></p>
<p>The <code>guide_colorbar()</code> modify the look and appearance of the legend to smooth colorbar. for instane the code of lines below highlight the key arguments that one has to specify to modify the legend of colorbar.</p>
<pre class="sourceCode r"><code class="sourceCode r">section <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>),
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">label.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">nbin =</span> <span class="dv">12</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>,
                               <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">barheight =</span> <span class="dv">15</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
<p>If you want the legend to appear as individual key, use <code>guide_colorbar()</code> as written in the code below</p>
<pre class="sourceCode r"><code class="sourceCode r">section <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
                             <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                             <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">13</span>),
                             <span class="dt">title.hjust =</span> <span class="fl">.5</span>,<span class="dt">nrow =</span> <span class="dv">1</span>,
                             <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                             <span class="dt">keywidth =</span> <span class="fl">3.</span>, <span class="dt">keyheight =</span> <span class="fl">.8</span>,
                             <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                             <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">11</span>),
                             <span class="dt">label.position =</span> <span class="st">&quot;bottom&quot;</span>))</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-413-1.png" width="672" /></p>
</div>
<div id="themes" class="section level2">
<h2><span class="header-section-number">16.7</span> Themes</h2>
<p>Themes in <strong>ggplot</strong> modify the appearance of all non data compoments in the plot like: axis, legend, panel, plot area, background, margin, facets etc. Let’s create a profile plot of temperature with default theme settings</p>
<pre class="sourceCode r"><code class="sourceCode r">profile =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">color =</span> station))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Pressure [m]&quot;</span>,<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)))

profile</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-414-1.png" width="672" /></p>
<p>We can modify the size and color of axis label with the <code>axis.text()</code> and axis title with <code>axis.title()</code> functions. You can use <code>axis.title.y</code> to modify the Y axis title and to modify the title of both the axis together, <code>use axis.title</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-415-1.png" width="672" /></p>
<p>To modify the appearance of the axis ticks, use the <code>axis.ticks_*</code> argument. You can change the color, size, linetype and length of the ticks using the <code>element_line()</code> function as shown below.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
<p>The <code>panel_grid</code> argument is used to modify the appearance of the gridlines. You can change the color, size and linetype of the line using the element_line() function.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-417-1.png" width="672" /></p>
<p>The background of the legend can be modified using the legend.background argument. You can change the background color, the border color and line type using <code>element_rect()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
<p>Now, let us look at modifying the non-data components of a legend.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-419-1.png" width="672" /></p>
<p>The appearance of the text can be modified using the legend.text argument. You can change the color, size and font using the element_text() function. The position and direction of the legend can be changed using <code>legend.position()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">profile <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Stations&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</code></pre>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-420-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-grammar-for-graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
