<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Reading NetCDF | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Reading NetCDF | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Reading NetCDF | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2019-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="forecast-time-series.html">
<link rel="next" href="packages-2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.6/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/Dygraph.Plugins.Unzoom-1.0/unzoom.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i>Sources</a></li>
<li class="chapter" data-level="" data-path="note-to-the-reader.html"><a href="note-to-the-reader.html"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-learn-computer-programming"><i class="fa fa-check"></i><b>1.1</b> Why learn computer Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r-1"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-features-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Features of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
<li class="chapter" data-level="1.3.9" data-path="intro.html"><a href="intro.html#getting-help-in-r"><i class="fa fa-check"></i><b>1.3.9</b> Getting Help in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-started.html"><a href="get-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="get-started.html"><a href="get-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-started.html"><a href="get-started.html#r-operators"><i class="fa fa-check"></i><b>2.1.1</b> R operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-started.html"><a href="get-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-started.html"><a href="get-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-started.html"><a href="get-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-started.html"><a href="get-started.html#naming-conventions"><i class="fa fa-check"></i><b>2.2.2</b> Naming conventions</a></li>
<li class="chapter" data-level="2.2.3" data-path="get-started.html"><a href="get-started.html#functions"><i class="fa fa-check"></i><b>2.2.3</b> Functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="get-started.html"><a href="get-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-started.html"><a href="get-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="get-started.html"><a href="get-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-started.html"><a href="get-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-started.html"><a href="get-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="get-started.html"><a href="get-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="get-started.html"><a href="get-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="get-started.html"><a href="get-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="get-started.html"><a href="get-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="get-started.html"><a href="get-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="get-started.html"><a href="get-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="get-started.html"><a href="get-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="get-started.html"><a href="get-started.html#tibbles"><i class="fa fa-check"></i><b>2.7</b> tibbles</a><ul>
<li class="chapter" data-level="2.7.1" data-path="get-started.html"><a href="get-started.html#column-names"><i class="fa fa-check"></i><b>2.7.1</b> Column Names</a></li>
<li class="chapter" data-level="2.7.2" data-path="get-started.html"><a href="get-started.html#add-rows-and-columns"><i class="fa fa-check"></i><b>2.7.2</b> Add rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="get-started.html"><a href="get-started.html#exercise"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
<li class="chapter" data-level="2.9" data-path="get-started.html"><a href="get-started.html#exercise-1"><i class="fa fa-check"></i><b>2.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html"><i class="fa fa-check"></i><b>3</b> Get familiar with R Markdown</a><ul>
<li class="chapter" data-level="3.1" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#r-markdown"><i class="fa fa-check"></i><b>3.1</b> R Markdown</a></li>
<li class="chapter" data-level="3.2" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#text-formating"><i class="fa fa-check"></i><b>3.2</b> Text Formating</a></li>
<li class="chapter" data-level="3.3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#hyperlinks"><i class="fa fa-check"></i><b>3.3</b> Hyperlinks</a></li>
<li class="chapter" data-level="3.4" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#images"><i class="fa fa-check"></i><b>3.4</b> Images</a></li>
<li class="chapter" data-level="3.5" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#tables"><i class="fa fa-check"></i><b>3.5</b> Tables</a></li>
<li class="chapter" data-level="3.6" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#cross-referencing"><i class="fa fa-check"></i><b>3.6</b> Cross-referencing</a></li>
<li class="chapter" data-level="3.7" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#bibliographies"><i class="fa fa-check"></i><b>3.7</b> Bibliographies</a></li>
<li class="chapter" data-level="3.8" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#create-.rmd-file"><i class="fa fa-check"></i><b>3.8</b> Create .Rmd FIle</a></li>
<li class="chapter" data-level="3.9" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#rendering-markdown"><i class="fa fa-check"></i><b>3.9</b> Rendering Markdown</a></li>
<li class="chapter" data-level="3.10" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#structure-of-an-rmarkdown-file"><i class="fa fa-check"></i><b>3.10</b> Structure of an Rmarkdown FIle</a></li>
<li class="chapter" data-level="3.11" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inserting-code-chunk"><i class="fa fa-check"></i><b>3.11</b> Inserting code chunk</a></li>
<li class="chapter" data-level="3.12" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-name"><i class="fa fa-check"></i><b>3.12</b> Chunk name</a></li>
<li class="chapter" data-level="3.13" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-options"><i class="fa fa-check"></i><b>3.13</b> Chunk options</a></li>
<li class="chapter" data-level="3.14" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inline-code"><i class="fa fa-check"></i><b>3.14</b> Inline code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>4</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="4.0.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types-1"><i class="fa fa-check"></i><b>4.0.1</b> Data Types</a></li>
<li class="chapter" data-level="4.0.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors-1"><i class="fa fa-check"></i><b>4.0.2</b> Vectors</a></li>
<li class="chapter" data-level="4.0.3" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element-1"><i class="fa fa-check"></i><b>4.0.3</b> Indexing the element</a></li>
<li class="chapter" data-level="4.0.4" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="4.0.5" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.5</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="4.0.6" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>4.0.6</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="4.0.7" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>4.0.7</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="4.0.8" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>4.0.8</b> Rounding off numbers</a></li>
<li class="chapter" data-level="4.1" data-path="dataTypes.html"><a href="dataTypes.html#data-frame-1"><i class="fa fa-check"></i><b>4.1</b> Data Frame</a><ul>
<li class="chapter" data-level="4.1.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>4.1.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>4.2</b> Matrix</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>4.2.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>4.2.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>4.3</b> Arrays</a></li>
<li class="chapter" data-level="4.4" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>4.4</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>5</b> Vector Data</a><ul>
<li class="chapter" data-level="5.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="vector.html"><a href="vector.html#numeric-vector"><i class="fa fa-check"></i><b>5.2</b> Numeric Vector</a></li>
<li class="chapter" data-level="5.3" data-path="vector.html"><a href="vector.html#integer-vector"><i class="fa fa-check"></i><b>5.3</b> Integer vector</a></li>
<li class="chapter" data-level="5.4" data-path="vector.html"><a href="vector.html#character-vector"><i class="fa fa-check"></i><b>5.4</b> Character vector</a></li>
<li class="chapter" data-level="5.5" data-path="vector.html"><a href="vector.html#logical-vector"><i class="fa fa-check"></i><b>5.5</b> Logical Vector</a></li>
<li class="chapter" data-level="5.6" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>5.6</b> Vector Data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>5.6.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>5.7</b> Reading vector data</a><ul>
<li class="chapter" data-level="5.7.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>5.7.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="5.7.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>5.7.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>5.8</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="5.9" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>5.9</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Introduction to tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>6.1</b> readr</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>6.2</b> dplyr</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#tidyr"><i class="fa fa-check"></i><b>6.3</b> tidyr</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#ggplot2"><i class="fa fa-check"></i><b>6.4</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>7</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="7.1" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>7.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="7.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>7.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="7.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>7.3</b> Writing t a File</a></li>
<li class="chapter" data-level="7.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>7.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="7.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>7.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="7.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>7.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>8</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="8.1" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>8.1</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="8.2" data-path="tidy.html"><a href="tidy.html#spread-from-long-to-wide-format"><i class="fa fa-check"></i><b>8.2</b> spread() —from long to wide format</a></li>
<li class="chapter" data-level="8.3" data-path="tidy.html"><a href="tidy.html#separate"><i class="fa fa-check"></i><b>8.3</b> separate()</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>9</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="9.1" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>9.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="9.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>9.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="9.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>9.3</b> Data</a></li>
<li class="chapter" data-level="9.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>9.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="9.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>9.5</b> select</a><ul>
<li class="chapter" data-level="9.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>9.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="9.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>9.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>9.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html"><i class="fa fa-check"></i><b>10</b> Working with Dates and Time</a><ul>
<li class="chapter" data-level="10.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#getting-the-date-and-time-with-localtime"><i class="fa fa-check"></i><b>10.1</b> Getting the Date and Time with localtime</a></li>
<li class="chapter" data-level="10.2" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-strings-to-dates"><i class="fa fa-check"></i><b>10.2</b> Converting strings to Dates</a><ul>
<li class="chapter" data-level="10.2.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#convert-strings-to-dates"><i class="fa fa-check"></i><b>10.2.1</b> convert strings to dates</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-date-with-lubridate-package"><i class="fa fa-check"></i><b>10.3</b> Converting date with <strong>lubridate</strong> package</a></li>
<li class="chapter" data-level="10.4" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#create-dates-by-merging-data"><i class="fa fa-check"></i><b>10.4</b> Create Dates by Merging Data</a></li>
<li class="chapter" data-level="10.5" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#isodate-converts-to-a-posixct-object"><i class="fa fa-check"></i><b>10.5</b> ISOdate converts to a POSIXct object</a></li>
<li class="chapter" data-level="10.6" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#extract-and-manipulate-parts-of-dates"><i class="fa fa-check"></i><b>10.6</b> Extract and Manipulate Parts of Dates</a></li>
<li class="chapter" data-level="10.7" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#creating-date-sequences"><i class="fa fa-check"></i><b>10.7</b> Creating Date Sequences</a></li>
<li class="chapter" data-level="10.8" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#calculations-with-dates"><i class="fa fa-check"></i><b>10.8</b> Calculations with Dates</a></li>
<li class="chapter" data-level="10.9" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-difference-of-15-days"><i class="fa fa-check"></i><b>10.9</b> Time difference of 15 days</a></li>
<li class="chapter" data-level="10.10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#example-with-time-zones"><i class="fa fa-check"></i><b>10.10</b> example with time zones</a></li>
<li class="chapter" data-level="10.11" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-interval"><i class="fa fa-check"></i><b>10.11</b> Time Interval</a></li>
<li class="chapter" data-level="10.12" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#ctd-list"><i class="fa fa-check"></i><b>10.12</b> ctd list</a></li>
<li class="chapter" data-level="10.13" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#arithmetic-with-date-times"><i class="fa fa-check"></i><b>10.13</b> Arithmetic with date times</a></li>
<li class="chapter" data-level="10.14" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#dealing-with-time-zones"><i class="fa fa-check"></i><b>10.14</b> Dealing with Time Zones</a></li>
<li class="chapter" data-level="10.15" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#case-study-working-with-date-and-time-of-argo-float-observations"><i class="fa fa-check"></i><b>10.15</b> Case study: Working with Date and Time of Argo float observations</a></li>
<li class="chapter" data-level="10.16" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-1"><i class="fa fa-check"></i><b>10.16</b> Data</a></li>
<li class="chapter" data-level="10.17" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-processing"><i class="fa fa-check"></i><b>10.17</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>11</b> Control flow</a><ul>
<li class="chapter" data-level="11.1" data-path="control-flow.html"><a href="control-flow.html#for-loop"><i class="fa fa-check"></i><b>11.1</b> for loop</a><ul>
<li class="chapter" data-level="11.1.1" data-path="control-flow.html"><a href="control-flow.html#for-loop-on-array"><i class="fa fa-check"></i><b>11.1.1</b> For loop on array</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="control-flow.html"><a href="control-flow.html#if-and-else-statement"><i class="fa fa-check"></i><b>11.2</b> if and else statement</a></li>
<li class="chapter" data-level="11.3" data-path="control-flow.html"><a href="control-flow.html#functions-1"><i class="fa fa-check"></i><b>11.3</b> Functions</a><ul>
<li class="chapter" data-level="11.3.1" data-path="control-flow.html"><a href="control-flow.html#core-functions"><i class="fa fa-check"></i><b>11.3.1</b> core functions</a></li>
<li class="chapter" data-level="11.3.2" data-path="control-flow.html"><a href="control-flow.html#user-defined-functions"><i class="fa fa-check"></i><b>11.3.2</b> user defined functions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="control-flow.html"><a href="control-flow.html#packages"><i class="fa fa-check"></i><b>11.4</b> packages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functions-and-packages.html"><a href="functions-and-packages.html"><i class="fa fa-check"></i><b>12</b> Functions and packages</a><ul>
<li class="chapter" data-level="12.0.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#core-functions-1"><i class="fa fa-check"></i><b>12.0.1</b> core functions</a></li>
<li class="chapter" data-level="12.0.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#user-defined-functions-1"><i class="fa fa-check"></i><b>12.0.2</b> user defined functions</a></li>
<li class="chapter" data-level="12.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#packages-1"><i class="fa fa-check"></i><b>12.1</b> packages</a></li>
<li class="chapter" data-level="12.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#function-pipelines"><i class="fa fa-check"></i><b>12.2</b> function pipelines</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>13</b> Raster Data</a><ul>
<li class="chapter" data-level="13.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>13.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>13.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="13.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>13.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="13.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>13.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="13.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>13.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="13.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>13.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>13.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="13.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>13.3</b> Raster resolution</a></li>
<li class="chapter" data-level="13.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>13.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="13.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>13.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="13.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>13.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>13.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="13.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>13.7</b> Raster time series data</a></li>
<li class="chapter" data-level="13.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>13.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>14</b> Plotting in R with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="14.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>14.1</b> A dataset</a></li>
<li class="chapter" data-level="14.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>14.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="14.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>14.3</b> Building a plot</a><ul>
<li class="chapter" data-level="14.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>14.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="14.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>14.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="14.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>14.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>14.4</b> Customize glidline and axis labels</a><ul>
<li class="chapter" data-level="14.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>14.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>14.5</b> Modify the position of the legend</a><ul>
<li class="chapter" data-level="14.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>14.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="14.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>14.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="14.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>14.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="14.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>14.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="14.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>14.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="14.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>14.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="14.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>14.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="14.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>14.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="14.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>14.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="14.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>14.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>14.6</b> Basic plots</a><ul>
<li class="chapter" data-level="14.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>14.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="14.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>14.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>14.7</b> Linegraph</a><ul>
<li class="chapter" data-level="14.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>14.7.1</b> histogram</a></li>
<li class="chapter" data-level="14.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>14.7.2</b> boxplot</a></li>
<li class="chapter" data-level="14.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>14.7.3</b> barplot</a></li>
<li class="chapter" data-level="14.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>14.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>14.8</b> Advanced plots</a><ul>
<li class="chapter" data-level="14.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>14.8.1</b> Facets</a></li>
<li class="chapter" data-level="14.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>14.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="14.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>14.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>14.9</b> Colour</a></li>
<li class="chapter" data-level="14.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>14.10</b> size</a></li>
<li class="chapter" data-level="14.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>14.11</b> scaling</a></li>
<li class="chapter" data-level="14.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>14.12</b> Guides</a></li>
<li class="chapter" data-level="14.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>14.13</b> Add-on packages</a></li>
<li class="chapter" data-level="14.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>14.14</b> ggridges</a></li>
<li class="chapter" data-level="14.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>14.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="14.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>14.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>15</b> A grammar for graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>15.1</b> geoms</a><ul>
<li class="chapter" data-level="15.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>15.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="15.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>15.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>15.2</b> aes()</a><ul>
<li class="chapter" data-level="15.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>15.2.1</b> Color</a></li>
<li class="chapter" data-level="15.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>15.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>15.3</b> Axis and labels</a></li>
<li class="chapter" data-level="15.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>15.4</b> Text annotaion</a></li>
<li class="chapter" data-level="15.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>15.5</b> Scales</a></li>
<li class="chapter" data-level="15.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>15.6</b> Guides</a></li>
<li class="chapter" data-level="15.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>15.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>16</b> Making Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="graphics.html"><a href="graphics.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>16.1</b> Geographical data in a tidy format</a><ul>
<li class="chapter" data-level="16.1.1" data-path="graphics.html"><a href="graphics.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>16.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="16.1.2" data-path="graphics.html"><a href="graphics.html#importing-shapefile"><i class="fa fa-check"></i><b>16.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="16.1.3" data-path="graphics.html"><a href="graphics.html#reading-other-format"><i class="fa fa-check"></i><b>16.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>16.3</b> Static Maps</a><ul>
<li class="chapter" data-level="16.3.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>16.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="graphics.html"><a href="graphics.html#basemap"><i class="fa fa-check"></i><b>16.4</b> Basemap</a></li>
<li class="chapter" data-level="16.5" data-path="graphics.html"><a href="graphics.html#creating-contour-map"><i class="fa fa-check"></i><b>16.5</b> Creating contour map</a></li>
<li class="chapter" data-level="16.6" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>16.6</b> Inset maps</a><ul>
<li class="chapter" data-level="16.6.1" data-path="graphics.html"><a href="graphics.html#choropleth-maps"><i class="fa fa-check"></i><b>16.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>16.7</b> Animated maps</a></li>
<li class="chapter" data-level="16.8" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>16.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="animation.html"><a href="animation.html"><i class="fa fa-check"></i><b>17</b> Animation</a><ul>
<li class="chapter" data-level="17.1" data-path="animation.html"><a href="animation.html#animation-1"><i class="fa fa-check"></i><b>17.1</b> Animation</a></li>
<li class="chapter" data-level="17.2" data-path="animation.html"><a href="animation.html#isosurface"><i class="fa fa-check"></i><b>17.2</b> isosurface</a></li>
<li class="chapter" data-level="17.3" data-path="animation.html"><a href="animation.html#checking-for-proper-interpolation-methods"><i class="fa fa-check"></i><b>17.3</b> checking for proper interpolation methods</a><ul>
<li class="chapter" data-level="17.3.1" data-path="animation.html"><a href="animation.html#fluorescence-section"><i class="fa fa-check"></i><b>17.3.1</b> Fluorescence section</a></li>
<li class="chapter" data-level="17.3.2" data-path="animation.html"><a href="animation.html#temperature-section"><i class="fa fa-check"></i><b>17.3.2</b> Temperature section</a></li>
<li class="chapter" data-level="17.3.3" data-path="animation.html"><a href="animation.html#dissolved-oxygen-section"><i class="fa fa-check"></i><b>17.3.3</b> Dissolved Oxygen section</a></li>
<li class="chapter" data-level="17.3.4" data-path="animation.html"><a href="animation.html#salinity-section"><i class="fa fa-check"></i><b>17.3.4</b> Salinity section</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="forecast-time-series.html"><a href="forecast-time-series.html"><i class="fa fa-check"></i><b>18</b> Forecast time series</a><ul>
<li class="chapter" data-level="18.1" data-path="forecast-time-series.html"><a href="forecast-time-series.html#introduction-2"><i class="fa fa-check"></i><b>18.1</b> introduction</a></li>
<li class="chapter" data-level="18.2" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-2"><i class="fa fa-check"></i><b>18.2</b> Data</a></li>
<li class="chapter" data-level="18.3" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-processing-1"><i class="fa fa-check"></i><b>18.3</b> Data processing</a></li>
<li class="chapter" data-level="18.4" data-path="forecast-time-series.html"><a href="forecast-time-series.html#forecasting"><i class="fa fa-check"></i><b>18.4</b> Forecasting</a></li>
<li class="chapter" data-level="18.5" data-path="forecast-time-series.html"><a href="forecast-time-series.html#visualize-the-forecasted-values"><i class="fa fa-check"></i><b>18.5</b> Visualize the forecasted values</a></li>
<li class="chapter" data-level="18.6" data-path="forecast-time-series.html"><a href="forecast-time-series.html#conclusion"><i class="fa fa-check"></i><b>18.6</b> conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="reading-netcdf.html"><a href="reading-netcdf.html"><i class="fa fa-check"></i><b>19</b> Reading NetCDF</a><ul>
<li class="chapter" data-level="19.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#introduction-3"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#types-of-netcdf-file"><i class="fa fa-check"></i><b>19.2</b> Types of netCDF file</a></li>
<li class="chapter" data-level="19.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#rading-netcdf-with-ncdf4-package"><i class="fa fa-check"></i><b>19.3</b> Rading NetCDF with ncdf4 package</a><ul>
<li class="chapter" data-level="19.3.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-dimensions"><i class="fa fa-check"></i><b>19.3.1</b> Extracting the dimensions</a></li>
<li class="chapter" data-level="19.3.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-time"><i class="fa fa-check"></i><b>19.3.2</b> Extracting time</a></li>
<li class="chapter" data-level="19.3.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-latitude"><i class="fa fa-check"></i><b>19.3.3</b> Extracting Latitude</a></li>
<li class="chapter" data-level="19.3.4" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-longitude"><i class="fa fa-check"></i><b>19.3.4</b> Extracting Longitude</a></li>
<li class="chapter" data-level="19.3.5" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-variable"><i class="fa fa-check"></i><b>19.3.5</b> Extracting the variable</a></li>
<li class="chapter" data-level="19.3.6" data-path="reading-netcdf.html"><a href="reading-netcdf.html#replace-fillvalue-with-na"><i class="fa fa-check"></i><b>19.3.6</b> Replace FillValue with NA</a></li>
<li class="chapter" data-level="19.3.7" data-path="reading-netcdf.html"><a href="reading-netcdf.html#obtain-a-slice"><i class="fa fa-check"></i><b>19.3.7</b> Obtain a slice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="packages-2.html"><a href="packages-2.html"><i class="fa fa-check"></i><b>20</b> packages</a><ul>
<li class="chapter" data-level="20.1" data-path="packages-2.html"><a href="packages-2.html#one-sample-t-test"><i class="fa fa-check"></i><b>20.1</b> One Sample t Test</a></li>
<li class="chapter" data-level="20.2" data-path="packages-2.html"><a href="packages-2.html#paired-t-test"><i class="fa fa-check"></i><b>20.2</b> Paired t test</a></li>
<li class="chapter" data-level="20.3" data-path="packages-2.html"><a href="packages-2.html#levenes-test"><i class="fa fa-check"></i><b>20.3</b> Levene’s Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reading-netcdf" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Reading NetCDF</h1>
<pre class="sourceCode r"><code class="sourceCode r">conflicted<span class="op">::</span><span class="kw">conflict_prefer</span>(<span class="st">&quot;print&quot;</span>, <span class="st">&quot;raster&quot;</span>)</code></pre>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">19.1</span> Introduction</h2>
<p>Network Common Data Form (NetCDF) is a widely used format for storing array–based data as variables. NetCDF are developed and maintained by Unidata was originally developed for storing and distributiing climate data , such as those generatd by climate simulation or reanalysis models. It has also been adopted in other fields, particularly in oceanography, where large mutidimensional arrays of data are generatted from satellite observation systems. The NetCDF format is a platform-independent because can be transeerred among servers and coputers that are running different operating systems, without a need to convert the file that fit a particular sytem. The NetCDF is also self-describing—contains metadata that describe the what is contained in the file, like the dimensions of longitude and latitude of the grid, the names and units of variables in the dataset, and attributes that describe thingks like themissing values codesr, or offsets and scale facators that may have been used to compress the data.</p>
</div>
<div id="types-of-netcdf-file" class="section level2">
<h2><span class="header-section-number">19.2</span> Types of netCDF file</h2>
<p>There are two version of netCDF. The first is netCDF version 3 (netCDF3), which is widely used, but has some size and performance limitations. The other is netCDF version 4 (netCDF4), which supports larger dataset and includes addtional capabilities like to compress the file and reduce the file size.</p>
</div>
<div id="rading-netcdf-with-ncdf4-package" class="section level2">
<h2><span class="header-section-number">19.3</span> Rading NetCDF with ncdf4 package</h2>
<p>The <strong>ncdf4</strong> package allows reading, writing, and creation of netCDF files, either netCDF version 3 or (optionally) netCDF version 4. Let’s first load the packages we need. Note that the <strong>ncddf4</strong> package must already be installed on your machine.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(ncdf4)
<span class="kw">require</span>(magrittr)
<span class="kw">require</span>(tidyverse)</code></pre>
<p>Once you have loaded the package, then use a function <code>nc_open()</code> to read an existing netCDF file</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nc.file = nc_open(&quot;./data/ml_depth__0.2deg_mean_grid_all_global_locean.nc&quot;)</span>
nc.file =<span class="st"> </span><span class="kw">nc_open</span>(<span class="st">&quot;e:/MatlabWorking/Altimetry/old staff/wio_ssh_july_2015.nc&quot;</span>)</code></pre>
<p>Once we have opened the file, we can print it to have a glimpse of some basic information about the file</p>
<pre class="sourceCode r"><code class="sourceCode r">nc.file</code></pre>
<pre><code>File e:/MatlabWorking/Altimetry/old staff/wio_ssh_july_2015.nc (NC_FORMAT_CLASSIC):

     2 variables (excluding dimension variables):
        int crs[]   
            comment: This is a container variable that describes the grid_mapping used by the data in this file. This variable does not contain any data; only information about the geographic coordinate system.
            grid_mapping_name: latitude_longitude
            inverse_flattening: 298.257
            semi_major_axis: 6378136.3
            _CoordinateTransformType: Projection
            _CoordinateAxisTypes: GeoX GeoY
        int adt[lon,lat,time]   
            _CoordinateAxes: lon lat time lat lon 
            _FillValue: -2147483647
            coordinates: lon lat
            grid_mapping: crs
            long_name: Absolute Dynamic Topography
            scale_factor: 1e-04
            standard_name: sea_surface_height_above_geoid
            units: m

     3 dimensions:
        time  Size:31
            axis: T
            long_name: Time
            standard_name: time
            units: days since 1950-01-01 00:00:00
            _CoordinateAxisType: Time
        lat  Size:420
            axis: Y
            bounds: lat_bnds
            long_name: Latitude
            standard_name: latitude
            units: degrees_north
            _CoordinateAxisType: Lat
        lon  Size:401
            axis: X
            bounds: lon_bnds
            long_name: Longitude
            standard_name: longitude
            units: degrees_east
            _CoordinateAxisType: Lon

    13 global attributes:
        title: NRT merged all satellites Global Ocean Gridded Absolute Dynamic Topography L4 product
        institution: CNES, CLS
        references: http://www.aviso.altimetry.fr
        source: Altimetry measurements
        Conventions: CF-1.0
        history: Data extracted from dataset http://opendap.aviso.altimetry.fr/thredds/dodsC/dataset-duacs-nrt-over30d-global-allsat-madt-h
        time_min: 23922
        time_max: 23952
        julian_day_unit: days since 1950-01-01 00:00:00
        latitude_min: -74.875
        latitude_max: 29.875
        longitude_min: 19.875
        longitude_max: 119.875</code></pre>
<p>By simply printing this <code>nc.file</code> file which is the returned object of <code>nc_open()</code> gave us a lot of information that is ovewhelming to grasp. This information describe about the file and is very important to understand the basic information embedded in it as we will require them later for extraction of the varibles. In summary, the metadata tells us about the;</p>
<ol style="list-style-type: decimal">
<li><code>filename</code>, which is a character string holding the name of the file; for our case is <code>File ./data/ml_depth__0.2deg_mean_grid_all_global_locean.nc</code></li>
<li><code>ndims</code>, which is an integer holding the number of dimensions in the file; in our file there are three dimension of <code>time',</code>lat<code>and</code>lon`</li>
<li><code>nvars</code>, which is an integer holding the number of the variables in the file that are NOT coordinate variables (aka dimensional variables); the printed file showed there are seven variables <code>krig_std_dev, mask, med_dev, mld, mld_raw, mld_smth, n_profiles</code></li>
<li><code>natts</code>, which is an integer holding the number of global attributes;</li>
<li><code>unlimdimid</code>, which is an integer holding the dimension id of the unlimited dimension, or -1 if there is none; 6 dim, which is a list of objects of class ncdim4;</li>
<li><code>var</code>, which is a list of objects of class ncvar4;</li>
<li><code>writable</code>, which is TRUE or FALSE, depending on whether the file was opened with write=TRUE or write=FALSE.</li>
</ol>
<div id="extracting-the-dimensions" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Extracting the dimensions</h3>
<p>Based on the metadata, I can customize it to print only the information I need. I used the for loop to customize only the variable information I need shown. Here is the code that will print the dimensions in the files together with additional information</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nc.file<span class="op">$</span>ndims){
  
  a =<span class="st"> </span>nc.file<span class="op">$</span>dim[[j]]
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Here is information on variable number&quot;</span>,j))
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Name: &quot;</span>,a<span class="op">$</span>name))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Units:&quot;</span>,a<span class="op">$</span>units))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Length:&quot;</span>,a<span class="op">$</span>len))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Values:&quot;</span>))
    <span class="kw">print</span>(a<span class="op">$</span>vals)
  
}</code></pre>
<pre><code>[1] &quot; Here is information on variable number 1&quot;
[1] &quot; Name:  time&quot;
[1] &quot; Units: days since 1950-01-01 00:00:00&quot;
[1] &quot; Length: 31&quot;
[1] &quot; Values:&quot;
 [1] 23922 23923 23924 23925 23926 23927 23928 23929 23930 23931
[11] 23932 23933 23934 23935 23936 23937 23938 23939 23940 23941
[21] 23942 23943 23944 23945 23946 23947 23948 23949 23950 23951
[31] 23952
[1] &quot; Here is information on variable number 2&quot;
[1] &quot; Name:  lat&quot;
[1] &quot; Units: degrees_north&quot;
[1] &quot; Length: 420&quot;
[1] &quot; Values:&quot;
  [1] -74.875 -74.625 -74.375 -74.125 -73.875 -73.625 -73.375
  [8] -73.125 -72.875 -72.625 -72.375 -72.125 -71.875 -71.625
 [15] -71.375 -71.125 -70.875 -70.625 -70.375 -70.125 -69.875
 [22] -69.625 -69.375 -69.125 -68.875 -68.625 -68.375 -68.125
 [29] -67.875 -67.625 -67.375 -67.125 -66.875 -66.625 -66.375
 [36] -66.125 -65.875 -65.625 -65.375 -65.125 -64.875 -64.625
 [43] -64.375 -64.125 -63.875 -63.625 -63.375 -63.125 -62.875
 [50] -62.625 -62.375 -62.125 -61.875 -61.625 -61.375 -61.125
 [57] -60.875 -60.625 -60.375 -60.125 -59.875 -59.625 -59.375
 [64] -59.125 -58.875 -58.625 -58.375 -58.125 -57.875 -57.625
 [71] -57.375 -57.125 -56.875 -56.625 -56.375 -56.125 -55.875
 [78] -55.625 -55.375 -55.125 -54.875 -54.625 -54.375 -54.125
 [85] -53.875 -53.625 -53.375 -53.125 -52.875 -52.625 -52.375
 [92] -52.125 -51.875 -51.625 -51.375 -51.125 -50.875 -50.625
 [99] -50.375 -50.125 -49.875 -49.625 -49.375 -49.125 -48.875
[106] -48.625 -48.375 -48.125 -47.875 -47.625 -47.375 -47.125
[113] -46.875 -46.625 -46.375 -46.125 -45.875 -45.625 -45.375
[120] -45.125 -44.875 -44.625 -44.375 -44.125 -43.875 -43.625
[127] -43.375 -43.125 -42.875 -42.625 -42.375 -42.125 -41.875
[134] -41.625 -41.375 -41.125 -40.875 -40.625 -40.375 -40.125
[141] -39.875 -39.625 -39.375 -39.125 -38.875 -38.625 -38.375
[148] -38.125 -37.875 -37.625 -37.375 -37.125 -36.875 -36.625
[155] -36.375 -36.125 -35.875 -35.625 -35.375 -35.125 -34.875
[162] -34.625 -34.375 -34.125 -33.875 -33.625 -33.375 -33.125
[169] -32.875 -32.625 -32.375 -32.125 -31.875 -31.625 -31.375
[176] -31.125 -30.875 -30.625 -30.375 -30.125 -29.875 -29.625
[183] -29.375 -29.125 -28.875 -28.625 -28.375 -28.125 -27.875
[190] -27.625 -27.375 -27.125 -26.875 -26.625 -26.375 -26.125
[197] -25.875 -25.625 -25.375 -25.125 -24.875 -24.625 -24.375
[204] -24.125 -23.875 -23.625 -23.375 -23.125 -22.875 -22.625
[211] -22.375 -22.125 -21.875 -21.625 -21.375 -21.125 -20.875
[218] -20.625 -20.375 -20.125 -19.875 -19.625 -19.375 -19.125
[225] -18.875 -18.625 -18.375 -18.125 -17.875 -17.625 -17.375
[232] -17.125 -16.875 -16.625 -16.375 -16.125 -15.875 -15.625
[239] -15.375 -15.125 -14.875 -14.625 -14.375 -14.125 -13.875
[246] -13.625 -13.375 -13.125 -12.875 -12.625 -12.375 -12.125
[253] -11.875 -11.625 -11.375 -11.125 -10.875 -10.625 -10.375
[260] -10.125  -9.875  -9.625  -9.375  -9.125  -8.875  -8.625
[267]  -8.375  -8.125  -7.875  -7.625  -7.375  -7.125  -6.875
[274]  -6.625  -6.375  -6.125  -5.875  -5.625  -5.375  -5.125
[281]  -4.875  -4.625  -4.375  -4.125  -3.875  -3.625  -3.375
[288]  -3.125  -2.875  -2.625  -2.375  -2.125  -1.875  -1.625
[295]  -1.375  -1.125  -0.875  -0.625  -0.375  -0.125   0.125
[302]   0.375   0.625   0.875   1.125   1.375   1.625   1.875
[309]   2.125   2.375   2.625   2.875   3.125   3.375   3.625
[316]   3.875   4.125   4.375   4.625   4.875   5.125   5.375
[323]   5.625   5.875   6.125   6.375   6.625   6.875   7.125
[330]   7.375   7.625   7.875   8.125   8.375   8.625   8.875
[337]   9.125   9.375   9.625   9.875  10.125  10.375  10.625
[344]  10.875  11.125  11.375  11.625  11.875  12.125  12.375
[351]  12.625  12.875  13.125  13.375  13.625  13.875  14.125
[358]  14.375  14.625  14.875  15.125  15.375  15.625  15.875
[365]  16.125  16.375  16.625  16.875  17.125  17.375  17.625
[372]  17.875  18.125  18.375  18.625  18.875  19.125  19.375
[379]  19.625  19.875  20.125  20.375  20.625  20.875  21.125
[386]  21.375  21.625  21.875  22.125  22.375  22.625  22.875
[393]  23.125  23.375  23.625  23.875  24.125  24.375  24.625
[400]  24.875  25.125  25.375  25.625  25.875  26.125  26.375
[407]  26.625  26.875  27.125  27.375  27.625  27.875  28.125
[414]  28.375  28.625  28.875  29.125  29.375  29.625  29.875
[1] &quot; Here is information on variable number 3&quot;
[1] &quot; Name:  lon&quot;
[1] &quot; Units: degrees_east&quot;
[1] &quot; Length: 401&quot;
[1] &quot; Values:&quot;
  [1]  19.875  20.125  20.375  20.625  20.875  21.125  21.375
  [8]  21.625  21.875  22.125  22.375  22.625  22.875  23.125
 [15]  23.375  23.625  23.875  24.125  24.375  24.625  24.875
 [22]  25.125  25.375  25.625  25.875  26.125  26.375  26.625
 [29]  26.875  27.125  27.375  27.625  27.875  28.125  28.375
 [36]  28.625  28.875  29.125  29.375  29.625  29.875  30.125
 [43]  30.375  30.625  30.875  31.125  31.375  31.625  31.875
 [50]  32.125  32.375  32.625  32.875  33.125  33.375  33.625
 [57]  33.875  34.125  34.375  34.625  34.875  35.125  35.375
 [64]  35.625  35.875  36.125  36.375  36.625  36.875  37.125
 [71]  37.375  37.625  37.875  38.125  38.375  38.625  38.875
 [78]  39.125  39.375  39.625  39.875  40.125  40.375  40.625
 [85]  40.875  41.125  41.375  41.625  41.875  42.125  42.375
 [92]  42.625  42.875  43.125  43.375  43.625  43.875  44.125
 [99]  44.375  44.625  44.875  45.125  45.375  45.625  45.875
[106]  46.125  46.375  46.625  46.875  47.125  47.375  47.625
[113]  47.875  48.125  48.375  48.625  48.875  49.125  49.375
[120]  49.625  49.875  50.125  50.375  50.625  50.875  51.125
[127]  51.375  51.625  51.875  52.125  52.375  52.625  52.875
[134]  53.125  53.375  53.625  53.875  54.125  54.375  54.625
[141]  54.875  55.125  55.375  55.625  55.875  56.125  56.375
[148]  56.625  56.875  57.125  57.375  57.625  57.875  58.125
[155]  58.375  58.625  58.875  59.125  59.375  59.625  59.875
[162]  60.125  60.375  60.625  60.875  61.125  61.375  61.625
[169]  61.875  62.125  62.375  62.625  62.875  63.125  63.375
[176]  63.625  63.875  64.125  64.375  64.625  64.875  65.125
[183]  65.375  65.625  65.875  66.125  66.375  66.625  66.875
[190]  67.125  67.375  67.625  67.875  68.125  68.375  68.625
[197]  68.875  69.125  69.375  69.625  69.875  70.125  70.375
[204]  70.625  70.875  71.125  71.375  71.625  71.875  72.125
[211]  72.375  72.625  72.875  73.125  73.375  73.625  73.875
[218]  74.125  74.375  74.625  74.875  75.125  75.375  75.625
[225]  75.875  76.125  76.375  76.625  76.875  77.125  77.375
[232]  77.625  77.875  78.125  78.375  78.625  78.875  79.125
[239]  79.375  79.625  79.875  80.125  80.375  80.625  80.875
[246]  81.125  81.375  81.625  81.875  82.125  82.375  82.625
[253]  82.875  83.125  83.375  83.625  83.875  84.125  84.375
[260]  84.625  84.875  85.125  85.375  85.625  85.875  86.125
[267]  86.375  86.625  86.875  87.125  87.375  87.625  87.875
[274]  88.125  88.375  88.625  88.875  89.125  89.375  89.625
[281]  89.875  90.125  90.375  90.625  90.875  91.125  91.375
[288]  91.625  91.875  92.125  92.375  92.625  92.875  93.125
[295]  93.375  93.625  93.875  94.125  94.375  94.625  94.875
[302]  95.125  95.375  95.625  95.875  96.125  96.375  96.625
[309]  96.875  97.125  97.375  97.625  97.875  98.125  98.375
[316]  98.625  98.875  99.125  99.375  99.625  99.875 100.125
[323] 100.375 100.625 100.875 101.125 101.375 101.625 101.875
[330] 102.125 102.375 102.625 102.875 103.125 103.375 103.625
[337] 103.875 104.125 104.375 104.625 104.875 105.125 105.375
[344] 105.625 105.875 106.125 106.375 106.625 106.875 107.125
[351] 107.375 107.625 107.875 108.125 108.375 108.625 108.875
[358] 109.125 109.375 109.625 109.875 110.125 110.375 110.625
[365] 110.875 111.125 111.375 111.625 111.875 112.125 112.375
[372] 112.625 112.875 113.125 113.375 113.625 113.875 114.125
[379] 114.375 114.625 114.875 115.125 115.375 115.625 115.875
[386] 116.125 116.375 116.625 116.875 117.125 117.375 117.625
[393] 117.875 118.125 118.375 118.625 118.875 119.125 119.375
[400] 119.625 119.875</code></pre>
<p>The output now give us the basic information of the variable name, the units, the length of the variable and the values. This is very simplified version and make more sense to grasp easily the information contained in the file. we can now extract the dimensions.</p>
</div>
<div id="extracting-time" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Extracting time</h3>
<p>The dimensions are extracted with the <code>ncvar_get()</code> function and parse along the arguments required. But before we extract let’s run the loop to have a glimpse again of the structure of the time dimension</p>
<pre><code>[1] &quot; Here is information on variable number 1&quot;
[1] &quot; Name:  time&quot;
[1] &quot; Units: days since 1950-01-01 00:00:00&quot;
[1] &quot; Length: 31&quot;
[1] &quot; Values:&quot;
 [1] 23922 23923 23924 23925 23926 23927 23928 23929 23930 23931
[11] 23932 23933 23934 23935 23936 23937 23938 23939 23940 23941
[21] 23942 23943 23944 23945 23946 23947 23948 23949 23950 23951
[31] 23952</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">time =<span class="st"> </span><span class="kw">ncvar_get</span>(<span class="dt">nc =</span> nc.file, <span class="dt">varid =</span> <span class="st">&quot;time&quot;</span>)</code></pre>
<p>We notice that time is in numerical number—julian days. Using the original time <code>1950-01-01 00:00:00</code>, we can transform julian date into gregorian calender.Since the time we are given is in julian, We need to convert the original time to julian to ensure its in the same format with time. Then to get the real time, we add up the original time to time and convert them from julian to gregorian. We used <code>JD</code> function from <strong>insol</strong> package for conversion of date between Julian and Gregorian <span class="citation">(Corripio <a href="#ref-insol">2014</a>)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">to =<span class="st"> </span>insol<span class="op">::</span><span class="kw">JD</span>(lubridate<span class="op">::</span><span class="kw">ymd_hms</span>(<span class="st">&quot;1950-01-01 00:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;&quot;</span>))
jd =<span class="st"> </span>time <span class="op">+</span><span class="st"> </span>to
date =<span class="st"> </span>insol<span class="op">::</span><span class="kw">JD</span>(<span class="dt">x =</span> jd, <span class="dt">inverse =</span> <span class="ot">TRUE</span>) </code></pre>
</div>
<div id="extracting-latitude" class="section level3">
<h3><span class="header-section-number">19.3.3</span> Extracting Latitude</h3>
<p>Similary, we can have a glimpse of latidude with the loop code as;</p>
<pre><code>[1] &quot; Here is information on variable number 2&quot;
[1] &quot; Name:  lat&quot;
[1] &quot; Units: degrees_north&quot;
[1] &quot; Length: 420&quot;</code></pre>
<p>We notice the latitude values span from 88°S to 89.5°N.We extract with the <code>ncget_var()</code> function;</p>
<pre class="sourceCode r"><code class="sourceCode r">lat =<span class="st"> </span><span class="kw">ncvar_get</span>(<span class="dt">nc =</span> nc.file, <span class="dt">varid =</span> <span class="st">&quot;lat&quot;</span>)</code></pre>
</div>
<div id="extracting-longitude" class="section level3">
<h3><span class="header-section-number">19.3.4</span> Extracting Longitude</h3>
<pre><code>[1] &quot; Here is information on variable number 3&quot;
[1] &quot; Name:  lon&quot;
[1] &quot; Units: degrees_east&quot;
[1] &quot; Length: 401&quot;</code></pre>
<p>Unlike the convention range of longitude which span from 180°W to 180°, here we see that longitud range from 0 to 360. Let’s extract the longitude values with the <code>ncvar_get()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">lon =<span class="st"> </span><span class="kw">ncvar_get</span>(<span class="dt">nc =</span> nc.file, <span class="dt">varid =</span> <span class="st">&quot;lon&quot;</span>)</code></pre>
</div>
<div id="extracting-the-variable" class="section level3">
<h3><span class="header-section-number">19.3.5</span> Extracting the variable</h3>
<p>As we have seen, obtaining the information from the metadata printout more information that we need, we can customize how we want the information to be printed with a loop. For instance the code of lines in the chunk below show how to printout information about the variables embbed in the file. Here is the code</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nc.file<span class="op">$</span>nvars ) {
  
    v &lt;-<span class="st"> </span>nc.file<span class="op">$</span>var[[i]]
    
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Here is information on variable number&quot;</span>,i))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Name: &quot;</span>,v<span class="op">$</span>name))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Units:&quot;</span>,v<span class="op">$</span>units))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Missing value:&quot;</span>,v<span class="op">$</span>missval))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;# dimensions :&quot;</span>,v<span class="op">$</span>ndims))
    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot; Variable size:&quot;</span>,v<span class="op">$</span>varsize))
    
    }</code></pre>
<pre><code>[1] &quot; Here is information on variable number 1&quot;
[1] &quot; Name:  crs&quot;
[1] &quot; Units: &quot;
[1] &quot; Missing value: NA&quot;
[1] &quot;# dimensions : 0&quot;
[1] &quot; Variable size: &quot;
[1] &quot; Here is information on variable number 2&quot;
[1] &quot; Name:  adt&quot;
[1] &quot; Units: m&quot;
[1] &quot; Missing value: -2147483647&quot;
[1] &quot;# dimensions : 3&quot;
[1] &quot; Variable size: 401&quot; &quot; Variable size: 420&quot;
[3] &quot; Variable size: 31&quot; </code></pre>
<p>We notice also there are two variables. here we are only interested with the variable 2, which is the sea surface height in meters. Let’s extract the variable</p>
<pre class="sourceCode r"><code class="sourceCode r">adt.array =<span class="st"> </span><span class="kw">ncvar_get</span>(<span class="dt">nc =</span> nc.file, <span class="dt">varid =</span> <span class="st">&quot;adt&quot;</span>)</code></pre>
<p>Once we have extracted the time, lat ,lon and mld, we need to verify their dimension. The dimension of atomic vector lon,lat and time must correspond to the dimension of the mld array. We can check the length of the lon, lat, time with the <code>length()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(lon);<span class="kw">length</span>(lat);<span class="kw">length</span>(time)</code></pre>
<pre><code>[1] 401</code></pre>
<pre><code>[1] 420</code></pre>
<pre><code>[1] 31</code></pre>
<p>The output display that there are 180 longitude, 90 latitude and 12 months. To check for dimension of the array we use the <code>dim()</code> function instead of the <code>length()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(adt.array)</code></pre>
<pre><code>[1] 401 420  31</code></pre>
<p>That’s perfect, the length of the dimensions matches the dimension of the mld array</p>
</div>
<div id="replace-fillvalue-with-na" class="section level3">
<h3><span class="header-section-number">19.3.6</span> Replace FillValue with NA</h3>
<p>In a netCDF file, values of a variable that are either missing or simply not available (i.e. ocean grid points in a terrestrial data set) are flagged using specific “fill values” (_FillValue) or missing values (missing_value), the values of which are set as attributes of a variable. In R, such unavailable data are indicated using the “NA” value. We can explore the value of the mld with the <code>hist()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">adt.array <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">hist</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-529-1.png" width="672" />
The histogram display only two bars, which indicated the skewness of the data. Looking back on the metadata, we observed that there the value <code>1e+09</code> was used to mask the land. Therefore, in R, we need to set all pixel with the <code>1e+09</code> values to NA. The following code fragment illustrates how to replace the netCDF variable’s fill values with R NA’s .</p>
<pre class="sourceCode r"><code class="sourceCode r">adt.array[adt.array <span class="op">==</span><span class="st"> </span>v<span class="op">$</span>missval] =<span class="st"> </span><span class="ot">NA</span></code></pre>
<p>We can explore again the value of the mld with the <code>hist()</code> functions and the values now look good</p>
<pre class="sourceCode r"><code class="sourceCode r">adt.array <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">hist</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-531-1.png" width="672" /></p>
</div>
<div id="obtain-a-slice" class="section level3">
<h3><span class="header-section-number">19.3.7</span> Obtain a slice</h3>
<p>NetCDF variables are read and written as one-dimensional vectors (e.g. longitudes), two-dimensional arrays or matrices (raster “slices”), or multi-dimensional arrays (raster “bricks”). In such data structures, the coordinate values for each grid point are implicit, inferred from the marginal values of, for example, longitude, latitude and time. In contrast, in R, the principal data structure for a variable is the <code>data.frame.</code>For instance, the adt.array data file is the multidimensional array consist of longitude, latitude and 12 columns of long-term means for each month, with the full data set thus consisting of 5221020 rows (401 by <code>length(lat)</code>) and 12 columns.</p>
<pre class="sourceCode r"><code class="sourceCode r">adt.array <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">dim</span>()</code></pre>
<pre><code>[1] 401 420  31</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">180</span><span class="op">*</span><span class="dv">90</span></code></pre>
<pre><code>[1] 16200</code></pre>
<p>In the kinds of data sets usually stored as netCDF files, each row in the data frame will contain the data for an individual grid point, with each column representing a particular variable, including explicit values for longitude and latitude (and perhaps time). This particular structure of this data set can be illustrated by selecting a single slice from the <code>adt.array</code> “brick”. Therefore, you need to convert extract matrices from array by indexing. For instance, we can extract the january matrix by typing</p>
<pre class="sourceCode r"><code class="sourceCode r">first =<span class="st"> </span>adt.array[,,<span class="dv">1</span>]</code></pre>
<p>once we have the mld for january, we can map the spatial pattern of the mixed layer depth with the <code>imagep()</code> function from <code>oce</code> package. Note that the values were normalized with the `<code>inverse_hyperbolic(),</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">oce<span class="op">::</span><span class="kw">imagep</span>(<span class="dt">x =</span> lon,<span class="dt">y =</span> lat, 
            <span class="dt">z =</span> first, 
            <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">37</span>,<span class="dv">52</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">17</span>,<span class="dv">2</span>), 
            <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="fl">0.55</span>,<span class="fl">1.3</span>), <span class="dt">zclip =</span> <span class="ot">TRUE</span>,
            <span class="dt">filledContour =</span> <span class="ot">FALSE</span>,
            <span class="dt">col =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>), 
            <span class="co"># at = seq(3.5,6.5,.5), </span>
            <span class="co"># labels = seq(20,500, length.out = 7),  </span>
            <span class="dt">xlab =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">zlab =</span> <span class="st">&quot;Sea Surface Height Anomaly (m)&quot;</span>, <span class="dt">zlabPosition =</span> <span class="st">&quot;side&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## expand the longitude and latitude</span>
lon.lat =<span class="st"> </span><span class="kw">expand.grid</span>(lon,lat) 

<span class="co">## convert the january matrix to a vector</span>
first.vector =<span class="st"> </span>first <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.vector</span>() 

<span class="co">## combine the expanded lon.lat with vectorized matrix of january</span>
first.df =<span class="st"> </span><span class="kw">data.frame</span>(lon.lat, first.vector) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>, <span class="dt">ssha=</span> <span class="dv">3</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">wio =<span class="st"> </span>spData<span class="op">::</span>world <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_crop</span>(<span class="dt">xmin =</span>  <span class="dv">20</span>, <span class="dt">ymin =</span> <span class="dv">-80</span>,<span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymax =</span><span class="dv">30</span>)
ssha.eacc =<span class="st"> </span>first.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">53</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-19</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>)

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span>wio) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> ssha.eacc, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span>ssha),
                          <span class="dt">bins =</span> <span class="dv">28</span>, <span class="dt">na.fill =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span>wio) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">37</span>,<span class="dv">51</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">17</span>,<span class="dv">2</span>), <span class="dt">datum =</span> sf<span class="op">::</span><span class="kw">st_crs</span>(<span class="dv">4326</span>)) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_latitude</span>(<span class="dt">ticks =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Sea surface height of &quot;</span>, date[<span class="dv">1</span>]))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">barheight =</span> <span class="dv">15</span>, 
                               <span class="dt">barwidth =</span> <span class="fl">.85</span>, 
                               <span class="dt">raster =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">title =</span> <span class="st">&quot;Sea surface height (m)&quot;</span>,
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-536-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## expand the longitude and latitude</span>
lon.lat =<span class="st"> </span><span class="kw">expand.grid</span>(lon,lat) 

<span class="co">## preallocate</span>
ssha =<span class="st"> </span><span class="kw">list</span>()

<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(date)){
  <span class="co">## chop the blick</span>
  data =<span class="st"> </span>adt.array[,,j]
  
  <span class="co">## create a data frame</span>
  ssha[[j]] =<span class="st"> </span><span class="kw">data.frame</span>(lon.lat, first.vector) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>, <span class="dt">ssha=</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">date =</span> date[j])
  
}

ssha =<span class="st"> </span>ssha <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">53</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-19</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">day =</span> lubridate<span class="op">::</span><span class="kw">day</span>(date),
                <span class="dt">jd =</span> lubridate<span class="op">::</span><span class="kw">yday</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>(),
                <span class="dt">week =</span> lubridate<span class="op">::</span><span class="kw">week</span>(date))</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-insol">
<p>Corripio, Javier G. 2014. <em>Insol: Solar Radiation</em>. <a href="https://CRAN.R-project.org/package=insol">https://CRAN.R-project.org/package=insol</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="forecast-time-series.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="packages-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
