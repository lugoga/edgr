<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 24 Extract bathymetric values from ETOPO1 | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 24 Extract bathymetric values from ETOPO1 | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 24 Extract bathymetric values from ETOPO1 | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba">


<meta name="date" content="2019-05-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to Spatial Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-programming"><i class="fa fa-check"></i><b>1.1</b> Why Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-featurs-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Featurs of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#arithmetric"><i class="fa fa-check"></i><b>2.1.1</b> Arithmetric</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#functions"><i class="fa fa-check"></i><b>2.2.2</b> Functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started.html"><a href="getting-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.3</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started.html"><a href="getting-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-started.html"><a href="getting-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started.html"><a href="getting-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="getting-started.html"><a href="getting-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="getting-started.html"><a href="getting-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="getting-started.html"><a href="getting-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="getting-started.html"><a href="getting-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started.html"><a href="getting-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started.html"><a href="getting-started.html#exercise"><i class="fa fa-check"></i><b>2.7</b> Exercise</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started.html"><a href="getting-started.html#exercise-1"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>3</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="3.1" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>3.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="3.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>3.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="3.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>3.3</b> Writing t a File</a></li>
<li class="chapter" data-level="3.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>3.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="3.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>3.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="3.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>3.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>4</b> Vector Data</a><ul>
<li class="chapter" data-level="4.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>4.2</b> Vector Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>4.2.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>4.3</b> Reading vector data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>4.3.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="4.3.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>4.3.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>4.4</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="4.5" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>4.5</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="5.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>5.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="5.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-functionality"><i class="fa fa-check"></i><b>5.2</b> dplyr functionality</a></li>
<li class="chapter" data-level="5.3" data-path="dplyr.html"><a href="dplyr.html#filter-keep-rows-matching-criteria"><i class="fa fa-check"></i><b>5.3</b> filter: Keep rows matching criteria</a></li>
<li class="chapter" data-level="5.4" data-path="dplyr.html"><a href="dplyr.html#select-pick-columns-by-name"><i class="fa fa-check"></i><b>5.4</b> select: Pick columns by name</a></li>
<li class="chapter" data-level="5.5" data-path="dplyr.html"><a href="dplyr.html#chaining-or-pipelining"><i class="fa fa-check"></i><b>5.5</b> “Chaining” or “Pipelining”</a></li>
<li class="chapter" data-level="5.6" data-path="dplyr.html"><a href="dplyr.html#pipping-with"><i class="fa fa-check"></i><b>5.6</b> Pipping with</a><ul>
<li class="chapter" data-level="5.6.1" data-path="dplyr.html"><a href="dplyr.html#choosing-columns-select-rename"><i class="fa fa-check"></i><b>5.6.1</b> Choosing columns: <code>select()</code>, <code>rename()</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filter-between-slice-sample_n-top_n-distinct"><i class="fa fa-check"></i><b>5.6.2</b> Choosing rows: filter, between, slice, sample_n, top_n, distinct</a></li>
<li class="chapter" data-level="5.6.3" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>5.6.3</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="5.6.4" data-path="dplyr.html"><a href="dplyr.html#grouping-and-counting-summarise-tally-count-group_size-n_groups-ungroup"><i class="fa fa-check"></i><b>5.6.4</b> Grouping and counting: summarise, tally, count, group_size, n_groups, ungroup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>6</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="6.1" data-path="tidy.html"><a href="tidy.html#gather-function"><i class="fa fa-check"></i><b>6.1</b> gather( ) function:</a></li>
<li class="chapter" data-level="6.2" data-path="tidy.html"><a href="tidy.html#separate-function"><i class="fa fa-check"></i><b>6.2</b> separate( ) function:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>7</b> Raster Data</a><ul>
<li class="chapter" data-level="7.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>7.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="7.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>7.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="7.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>7.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="7.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>7.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="7.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>7.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="7.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>7.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>7.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="7.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>7.3</b> Raster resolution</a></li>
<li class="chapter" data-level="7.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>7.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="7.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>7.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="7.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>7.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>7.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="7.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>7.7</b> Raster time series data</a></li>
<li class="chapter" data-level="7.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>7.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rasterv.html"><a href="rasterv.html"><i class="fa fa-check"></i><b>8</b> Raster Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="rasterv.html"><a href="rasterv.html#visualize-bathmetry-with-ggplot2"><i class="fa fa-check"></i><b>8.1</b> visualize bathmetry with ggplot2</a></li>
<li class="chapter" data-level="8.2" data-path="rasterv.html"><a href="rasterv.html#convert-data-frame-to-bathmetric-object"><i class="fa fa-check"></i><b>8.2</b> Convert data frame to bathmetric object</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>9</b> Making Maps</a><ul>
<li class="chapter" data-level="9.1" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>9.1.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="graphics.html"><a href="graphics.html#creating-a-ggplot"><i class="fa fa-check"></i><b>9.2</b> Creating a ggplot</a><ul>
<li class="chapter" data-level="9.2.1" data-path="graphics.html"><a href="graphics.html#label"><i class="fa fa-check"></i><b>9.2.1</b> Label</a></li>
<li class="chapter" data-level="9.2.2" data-path="graphics.html"><a href="graphics.html#annotations"><i class="fa fa-check"></i><b>9.2.2</b> Annotations</a></li>
<li class="chapter" data-level="9.2.3" data-path="graphics.html"><a href="graphics.html#scales"><i class="fa fa-check"></i><b>9.2.3</b> Scales</a></li>
<li class="chapter" data-level="9.2.4" data-path="graphics.html"><a href="graphics.html#zooming"><i class="fa fa-check"></i><b>9.2.4</b> Zooming</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>9.3</b> Inset maps</a></li>
<li class="chapter" data-level="9.4" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>9.4</b> Static Maps</a><ul>
<li class="chapter" data-level="9.4.1" data-path="graphics.html"><a href="graphics.html#map-elements"><i class="fa fa-check"></i><b>9.4.1</b> Map elements</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>9.5</b> Animated maps</a></li>
<li class="chapter" data-level="9.6" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>9.6</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html"><i class="fa fa-check"></i><b>10</b> Monsoon circulation</a><ul>
<li class="chapter" data-level="10.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#winds"><i class="fa fa-check"></i><b>10.1</b> winds</a><ul>
<li class="chapter" data-level="10.1.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#climatologies"><i class="fa fa-check"></i><b>10.1.1</b> Climatologies</a></li>
<li class="chapter" data-level="10.1.2" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#annual-cycles-and-means"><i class="fa fa-check"></i><b>10.1.2</b> Annual cycles and means</a></li>
<li class="chapter" data-level="10.1.3" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#intraseasonal-variability"><i class="fa fa-check"></i><b>10.1.3</b> Intraseasonal variability</a></li>
<li class="chapter" data-level="10.1.4" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#sea-surface-height"><i class="fa fa-check"></i><b>10.1.4</b> sea surface height</a></li>
<li class="chapter" data-level="10.1.5" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#sea-surface-temperature"><i class="fa fa-check"></i><b>10.1.5</b> sea surface temperature</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#physical"><i class="fa fa-check"></i><b>10.2</b> Physical</a><ul>
<li class="chapter" data-level="10.2.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#temperature"><i class="fa fa-check"></i><b>10.2.1</b> Temperature</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#salinity"><i class="fa fa-check"></i><b>10.3</b> Salinity</a></li>
<li class="chapter" data-level="10.4" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#chemical"><i class="fa fa-check"></i><b>10.4</b> Chemical</a><ul>
<li class="chapter" data-level="10.4.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#dissolved-oxygen"><i class="fa fa-check"></i><b>10.4.1</b> Dissolved oxygen</a></li>
<li class="chapter" data-level="10.4.2" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#nitrate"><i class="fa fa-check"></i><b>10.4.2</b> Nitrate</a></li>
<li class="chapter" data-level="10.4.3" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#phosphate"><i class="fa fa-check"></i><b>10.4.3</b> Phosphate</a></li>
<li class="chapter" data-level="10.4.4" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#silica"><i class="fa fa-check"></i><b>10.4.4</b> Silica</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#wind"><i class="fa fa-check"></i><b>10.5</b> wind</a></li>
<li class="chapter" data-level="10.6" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#bagamoyo-ctd"><i class="fa fa-check"></i><b>10.6</b> Bagamoyo ctd</a></li>
<li class="chapter" data-level="10.7" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#ctd"><i class="fa fa-check"></i><b>10.7</b> CTD</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ocean-productivity.html"><a href="ocean-productivity.html"><i class="fa fa-check"></i><b>11</b> Ocean productivity</a></li>
<li class="chapter" data-level="12" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html"><i class="fa fa-check"></i><b>12</b> Sea Surface Temperature</a><ul>
<li class="chapter" data-level="12.1" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#annual-mean-sea-surface-temperature"><i class="fa fa-check"></i><b>12.1</b> Annual Mean Sea Surface Temperature</a></li>
<li class="chapter" data-level="12.2" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#anomaly-of-sea-surface-temperature"><i class="fa fa-check"></i><b>12.2</b> Anomaly of sea surface temperature</a></li>
<li class="chapter" data-level="12.3" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#precipitation"><i class="fa fa-check"></i><b>12.3</b> Precipitation</a></li>
<li class="chapter" data-level="12.4" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#wind-speed-and-direction"><i class="fa fa-check"></i><b>12.4</b> WInd speed and direction</a></li>
<li class="chapter" data-level="12.5" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#air-temperature"><i class="fa fa-check"></i><b>12.5</b> air temperature</a></li>
<li class="chapter" data-level="12.6" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#zonal-anomaly-of-air-temperature"><i class="fa fa-check"></i><b>12.6</b> Zonal anomaly of air temperature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="precipitation-1.html"><a href="precipitation-1.html"><i class="fa fa-check"></i><b>13</b> precipitation</a><ul>
<li class="chapter" data-level="13.1" data-path="precipitation-1.html"><a href="precipitation-1.html#handling-data"><i class="fa fa-check"></i><b>13.1</b> Handling data</a></li>
<li class="chapter" data-level="13.2" data-path="precipitation-1.html"><a href="precipitation-1.html#required-packages"><i class="fa fa-check"></i><b>13.2</b> Required packages</a></li>
<li class="chapter" data-level="13.3" data-path="precipitation-1.html"><a href="precipitation-1.html#formatting-data"><i class="fa fa-check"></i><b>13.3</b> Formatting data</a></li>
<li class="chapter" data-level="13.4" data-path="precipitation-1.html"><a href="precipitation-1.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>13.4</b> Plotting with ggplot2</a></li>
<li class="chapter" data-level="13.5" data-path="precipitation-1.html"><a href="precipitation-1.html#conclusion"><i class="fa fa-check"></i><b>13.5</b> Conclusion</a></li>
<li class="chapter" data-level="13.6" data-path="precipitation-1.html"><a href="precipitation-1.html#references"><i class="fa fa-check"></i><b>13.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="14" data-path="index.html"><a href="index.html#index"><i class="fa fa-check"></i><b>14</b> Index</a><ul>
<li class="chapter" data-level="14.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>14.1</b> R</a></li>
<li class="chapter" data-level="14.2" data-path="index.html"><a href="index.html#rmarkdown-1"><i class="fa fa-check"></i><b>14.2</b> Rmarkdown</a></li>
<li class="chapter" data-level="14.3" data-path="index.html"><a href="index.html#bookdown"><i class="fa fa-check"></i><b>14.3</b> Bookdown</a></li>
<li class="chapter" data-level="14.4" data-path="index.html"><a href="index.html#pandoc"><i class="fa fa-check"></i><b>14.4</b> Pandoc</a></li>
<li class="chapter" data-level="14.5" data-path="index.html"><a href="index.html#woa-for-nyamisi-manuscript"><i class="fa fa-check"></i><b>14.5</b> WOA for Nyamisi manuscript</a></li>
<li class="chapter" data-level="14.6" data-path="index.html"><a href="index.html#producing-maps-programatically"><i class="fa fa-check"></i><b>14.6</b> Producing Maps programatically</a><ul>
<li class="chapter" data-level="14.6.1" data-path="index.html"><a href="index.html#satellite-data"><i class="fa fa-check"></i><b>14.6.1</b> satellite data</a></li>
<li class="chapter" data-level="14.6.2" data-path="index.html"><a href="index.html#drifter-data"><i class="fa fa-check"></i><b>14.6.2</b> drifter data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="spatial-patterns.html"><a href="spatial-patterns.html"><i class="fa fa-check"></i><b>15</b> Spatial Patterns</a></li>
<li class="chapter" data-level="16" data-path="buoys-data.html"><a href="buoys-data.html"><i class="fa fa-check"></i><b>16</b> buoys data</a></li>
<li class="chapter" data-level="17" data-path="altimetry.html"><a href="altimetry.html"><i class="fa fa-check"></i><b>17</b> Altimetry</a><ul>
<li class="chapter" data-level="17.1" data-path="altimetry.html"><a href="altimetry.html#sea-surface-height-1"><i class="fa fa-check"></i><b>17.1</b> Sea surface height</a></li>
<li class="chapter" data-level="17.2" data-path="altimetry.html"><a href="altimetry.html#visualizing"><i class="fa fa-check"></i><b>17.2</b> Visualizing</a></li>
<li class="chapter" data-level="17.3" data-path="altimetry.html"><a href="altimetry.html#read-netcdf-file-with-in-r"><i class="fa fa-check"></i><b>17.3</b> Read netCDF file with in R</a><ul>
<li class="chapter" data-level="17.3.1" data-path="altimetry.html"><a href="altimetry.html#understand-the-metadata"><i class="fa fa-check"></i><b>17.3.1</b> Understand the metadata</a></li>
<li class="chapter" data-level="17.3.2" data-path="altimetry.html"><a href="altimetry.html#extract-the-variable"><i class="fa fa-check"></i><b>17.3.2</b> Extract the variable</a></li>
<li class="chapter" data-level="17.3.3" data-path="altimetry.html"><a href="altimetry.html#transform-to-data-frame"><i class="fa fa-check"></i><b>17.3.3</b> Transform to data frame</a></li>
<li class="chapter" data-level="17.3.4" data-path="altimetry.html"><a href="altimetry.html#stitching-the-data"><i class="fa fa-check"></i><b>17.3.4</b> Stitching the data</a></li>
<li class="chapter" data-level="17.3.5" data-path="altimetry.html"><a href="altimetry.html#visualizemapping-the-ssh"><i class="fa fa-check"></i><b>17.3.5</b> Visualize—Mapping the SSH</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="altimetry.html"><a href="altimetry.html#reference"><i class="fa fa-check"></i><b>17.4</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="argo-floats.html"><a href="argo-floats.html"><i class="fa fa-check"></i><b>18</b> Argo floats</a><ul>
<li class="chapter" data-level="18.1" data-path="argo-floats.html"><a href="argo-floats.html#iso-surface"><i class="fa fa-check"></i><b>18.1</b> Iso-surface</a></li>
<li class="chapter" data-level="18.2" data-path="argo-floats.html"><a href="argo-floats.html#regional-and-global-distributions"><i class="fa fa-check"></i><b>18.2</b> Regional and global distributions</a></li>
<li class="chapter" data-level="18.3" data-path="argo-floats.html"><a href="argo-floats.html#introduction-2"><i class="fa fa-check"></i><b>18.3</b> Introduction</a><ul>
<li class="chapter" data-level="18.3.1" data-path="argo-floats.html"><a href="argo-floats.html#import-data"><i class="fa fa-check"></i><b>18.3.1</b> Import Data</a></li>
<li class="chapter" data-level="18.3.2" data-path="argo-floats.html"><a href="argo-floats.html#tidy-the-data"><i class="fa fa-check"></i><b>18.3.2</b> Tidy the data</a></li>
<li class="chapter" data-level="18.3.3" data-path="argo-floats.html"><a href="argo-floats.html#data-frames"><i class="fa fa-check"></i><b>18.3.3</b> Data Frames</a></li>
<li class="chapter" data-level="18.3.4" data-path="argo-floats.html"><a href="argo-floats.html#transform"><i class="fa fa-check"></i><b>18.3.4</b> Transform</a></li>
<li class="chapter" data-level="18.3.5" data-path="argo-floats.html"><a href="argo-floats.html#create-simple-feature"><i class="fa fa-check"></i><b>18.3.5</b> Create Simple Feature</a></li>
<li class="chapter" data-level="18.3.6" data-path="argo-floats.html"><a href="argo-floats.html#gridding"><i class="fa fa-check"></i><b>18.3.6</b> Gridding</a></li>
<li class="chapter" data-level="18.3.7" data-path="argo-floats.html"><a href="argo-floats.html#populate-grids-with-drifter-observations-and-median-sst"><i class="fa fa-check"></i><b>18.3.7</b> Populate Grids with Drifter Observations and Median SST</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ctd-1.html"><a href="ctd-1.html"><i class="fa fa-check"></i><b>19</b> CTD</a><ul>
<li class="chapter" data-level="19.1" data-path="ctd-1.html"><a href="ctd-1.html#vertical-cross-sections"><i class="fa fa-check"></i><b>19.1</b> Vertical cross sections</a></li>
<li class="chapter" data-level="19.2" data-path="ctd-1.html"><a href="ctd-1.html#ctd-list"><i class="fa fa-check"></i><b>19.2</b> ctd list</a><ul>
<li class="chapter" data-level="19.2.1" data-path="ctd-1.html"><a href="ctd-1.html#pemba-channel-section"><i class="fa fa-check"></i><b>19.2.1</b> Pemba Channel Section</a></li>
<li class="chapter" data-level="19.2.2" data-path="ctd-1.html"><a href="ctd-1.html#mtwara-section"><i class="fa fa-check"></i><b>19.2.2</b> Mtwara Section</a></li>
<li class="chapter" data-level="19.2.3" data-path="ctd-1.html"><a href="ctd-1.html#iso-surface-1"><i class="fa fa-check"></i><b>19.2.3</b> Iso surface</a></li>
<li class="chapter" data-level="19.2.4" data-path="ctd-1.html"><a href="ctd-1.html#location-information"><i class="fa fa-check"></i><b>19.2.4</b> Location information</a></li>
<li class="chapter" data-level="19.2.5" data-path="ctd-1.html"><a href="ctd-1.html#make-a-data-frame-from-ctd-list"><i class="fa fa-check"></i><b>19.2.5</b> make a data frame from CTD list</a></li>
<li class="chapter" data-level="19.2.6" data-path="ctd-1.html"><a href="ctd-1.html#isosurface-in-mafia-channel"><i class="fa fa-check"></i><b>19.2.6</b> Isosurface in Mafia Channel</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="ctd-1.html"><a href="ctd-1.html#mozambique-channel"><i class="fa fa-check"></i><b>19.3</b> Mozambique channel</a><ul>
<li class="chapter" data-level="19.3.1" data-path="ctd-1.html"><a href="ctd-1.html#references-2"><i class="fa fa-check"></i><b>19.3.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="surface-circulation.html"><a href="surface-circulation.html"><i class="fa fa-check"></i><b>20</b> Surface circulation</a><ul>
<li class="chapter" data-level="20.1" data-path="surface-circulation.html"><a href="surface-circulation.html#ocean-circulation"><i class="fa fa-check"></i><b>20.1</b> Ocean circulation</a></li>
<li class="chapter" data-level="20.2" data-path="surface-circulation.html"><a href="surface-circulation.html#regional-surface-ocean-dynamics"><i class="fa fa-check"></i><b>20.2</b> REGIONAL SURFACE OCEAN DYNAMICS</a><ul>
<li class="chapter" data-level="20.2.1" data-path="surface-circulation.html"><a href="surface-circulation.html#the-eastafrican-coastal-current"><i class="fa fa-check"></i><b>20.2.1</b> The EastAfrican Coastal Current</a></li>
<li class="chapter" data-level="20.2.2" data-path="surface-circulation.html"><a href="surface-circulation.html#the-somali-current-sc"><i class="fa fa-check"></i><b>20.2.2</b> The Somali Current (SC)</a></li>
<li class="chapter" data-level="20.2.3" data-path="surface-circulation.html"><a href="surface-circulation.html#the-mozambique-current-mc"><i class="fa fa-check"></i><b>20.2.3</b> The Mozambique Current (MC)</a></li>
<li class="chapter" data-level="20.2.4" data-path="surface-circulation.html"><a href="surface-circulation.html#the-south-equatorial-current-sec"><i class="fa fa-check"></i><b>20.2.4</b> The South Equatorial Current (SEC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html"><i class="fa fa-check"></i><b>21</b> World Ocean Atlas Datasets</a><ul>
<li class="chapter" data-level="21.1" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html#temperature-1"><i class="fa fa-check"></i><b>21.1</b> Temperature</a></li>
<li class="chapter" data-level="21.2" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html#salinity-1"><i class="fa fa-check"></i><b>21.2</b> Salinity</a></li>
<li class="chapter" data-level="21.3" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html#dissolved-oxygen-1"><i class="fa fa-check"></i><b>21.3</b> Dissolved oxygen</a></li>
<li class="chapter" data-level="21.4" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html#phosphate-1"><i class="fa fa-check"></i><b>21.4</b> Phosphate</a></li>
<li class="chapter" data-level="21.5" data-path="world-ocean-atlas-datasets.html"><a href="world-ocean-atlas-datasets.html#silica-1"><i class="fa fa-check"></i><b>21.5</b> Silica</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html"><i class="fa fa-check"></i><b>22</b> Processing ADCP Data with R</a><ul>
<li class="chapter" data-level="22.0.1" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#introduction-3"><i class="fa fa-check"></i><b>22.0.1</b> Introduction</a></li>
<li class="chapter" data-level="22.0.2" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#ingestion-of-the-data"><i class="fa fa-check"></i><b>22.0.2</b> Ingestion of the data</a></li>
<li class="chapter" data-level="22.0.3" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#ensemble-adp-objects"><i class="fa fa-check"></i><b>22.0.3</b> Ensemble adp objects</a></li>
<li class="chapter" data-level="22.0.4" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#depth-cell-mapping"><i class="fa fa-check"></i><b>22.0.4</b> Depth cell mapping</a></li>
<li class="chapter" data-level="22.0.5" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#extract-the-variables"><i class="fa fa-check"></i><b>22.0.5</b> Extract the variables</a></li>
<li class="chapter" data-level="22.0.6" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#subset-adcp"><i class="fa fa-check"></i><b>22.0.6</b> Subset ADCP</a></li>
<li class="chapter" data-level="22.0.7" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#spurious-measurements"><i class="fa fa-check"></i><b>22.0.7</b> Spurious measurements</a></li>
<li class="chapter" data-level="22.0.8" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#compute-absolute-velocity"><i class="fa fa-check"></i><b>22.0.8</b> Compute Absolute velocity</a></li>
<li class="chapter" data-level="22.0.9" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#conclusion-1"><i class="fa fa-check"></i><b>22.0.9</b> Conclusion</a></li>
<li class="chapter" data-level="22.0.10" data-path="processing-adcp-data-with-r.html"><a href="processing-adcp-data-with-r.html#cited-literature"><i class="fa fa-check"></i><b>22.0.10</b> Cited Literature</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><i class="fa fa-check"></i><b>23</b> Primary Production, chlorophyll-concentration and Sea surface temperature in</a><ul>
<li class="chapter" data-level="23.1" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html#introduction-4"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html#chlorophyll-a"><i class="fa fa-check"></i><b>23.2</b> chlorophyll-a</a><ul>
<li class="chapter" data-level="23.2.1" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html#looping-the-files"><i class="fa fa-check"></i><b>23.2.1</b> Looping the files</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html#primary-productivity"><i class="fa fa-check"></i><b>23.3</b> Primary productivity</a></li>
<li class="chapter" data-level="23.4" data-path="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html"><a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html#temperature-2"><i class="fa fa-check"></i><b>23.4</b> Temperature</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="extract-bathymetric-values-from-etopo1.html"><a href="extract-bathymetric-values-from-etopo1.html"><i class="fa fa-check"></i><b>24</b> Extract bathymetric values from ETOPO1</a><ul>
<li class="chapter" data-level="24.0.1" data-path="extract-bathymetric-values-from-etopo1.html"><a href="extract-bathymetric-values-from-etopo1.html#extracting-values"><i class="fa fa-check"></i><b>24.0.1</b> Extracting values</a></li>
<li class="chapter" data-level="24.0.2" data-path="extract-bathymetric-values-from-etopo1.html"><a href="extract-bathymetric-values-from-etopo1.html#reference-1"><i class="fa fa-check"></i><b>24.0.2</b> Reference</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extract-bathymetric-values-from-etopo1" class="section level1">
<h1><span class="header-section-number">Chapter 24</span> Extract bathymetric values from ETOPO1</h1>
<p>In chapter, we explore the power of <strong>ggplot</strong> package in mapping oceanographic data. In this post we will continue that theme and dive to process topographic data and map the bathymetry. We will grab <a href="https://www.ngdc.noaa.gov/mgg/global/global.html">ETOPO1</a> dataset— a 1 arc-minute global relief model that integrates land topography and ocean bathymetry. We will process the data and then use different ways to visualize the bathymetric information. There is no much statistics or modelling in this chapter, but the stretch your brain on processing the <code>ascii (.asc)</code> file and transform it data frame that <strong>ggplot2</strong> and <strong>metR</strong> packages work friendly <span class="citation">(Kelley and Richards <a href="#ref-oce">2018</a>)</span>. We need functions from some packages, hence to use their functions we need to load these packages into our workspace.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)
<span class="kw">require</span>(oce)
<span class="kw">require</span>(ocedata)</code></pre>
<p>The ETOPO1 dataset was downloaded as an <em>ascii</em> file and used the function <code>raster::raster()</code> to read the file from the local directory and import the data from the working directory into the workspace <span class="citation">(R Core Team <a href="#ref-r">2019</a>)</span>. The imported files was assigned name as <em>etopo</em></p>
<pre class="sourceCode r"><code class="sourceCode r">etopo =<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="st">&quot;./Tanzania_etopo1/tanz1_-3432.asc&quot;</span>)</code></pre>
<pre><code>[1] &quot;RasterLayer&quot;
attr(,&quot;package&quot;)
[1] &quot;raster&quot;</code></pre>
<p>The <code>raster()</code> function produce the <code>RasterLayer</code> object. Although this <code>RasterLayer</code> object fits for plotting using base R graphic, its not in the right format for working with <strong>ggplot2</strong> and siter packages like <strong>metR</strong>, which both can read the data that structured in the tabular format like data frame or tibble. Fortunately, <strong>raster</strong> package has a <code>as.data.frame()</code> function that convert raster layer into data frame directly. We tranform this class into data frame and changed the variables names. The data frame now has three variables—longitude, latitude and topographic values—treated as elevation though does store the elevation and bathymetry.</p>
<pre class="sourceCode r"><code class="sourceCode r">etopo.df =<span class="st"> </span>etopo <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">xy =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">elevation =</span> <span class="dv">3</span>)</code></pre>
<p>Once the data converted to data frame with xyz variables, we can use the information to map the patterns of bottom topography of the area of interest with <strong>ggplot2</strong> and <strong>metR</strong> packages. However, our interest is map the bathmetry as contour, therefore we drop all values of the elevation that are greater than zero (i.e elevation) and retain only the values equal or less than zero (bathmetry). Picking the bathmetry values was done using the <code>filter()</code> function from <strong>dplyr</strong> package <span class="citation">(Wickham et al. <a href="#ref-dplyr">2019</a>)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">bathmetry =<span class="st"> </span>etopo.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(elevation <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">35</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">45</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-18</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">bath =</span> elevation)</code></pre>
<p>Once we have the batmetry in <strong>ggplot2</strong> readable format, we need one more dataset—the basemap with country’s boundary. We need these dataset as basemaps—that provide background details for the maps we are going to make. We can read the file and import directly into the workspace using the <code>read_sf()</code> function from <strong>sf</strong> package as the chunk below shows;</p>
<pre class="sourceCode r"><code class="sourceCode r">africa =<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;./africa/Spatial/AdmInfr/afcntry.shp&quot;</span>)</code></pre>
<p>We have all the datase—the basemaps and the data frammed bathymetry data in the format that <strong>ggplot2</strong> and its sisters package understand. The figure <a href="extract-bathymetric-values-from-etopo1.html#fig:fig3001">24.1</a> was created using lines of codes highlighted in the chunk below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## pemba data</span>
pemba.bath =<span class="st"> </span>bathmetry<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(bath <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-32000</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">38</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">42</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-7</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-1</span>)

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_tanaka</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">size =</span> <span class="fl">3.2</span>, 
                          <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> aoi, <span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.5</span>,<span class="fl">41.3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="op">-</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="co"># geom_point(data = transect, aes(x = lon, y = lat))+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">39</span>,<span class="dv">41</span>,.<span class="dv">6</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">5.8</span>,<span class="op">-</span><span class="fl">4.2</span>,.<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<div class="figure"><span id="fig:fig3001"></span>
<img src="spatil_r_files/figure-html/fig3001-1.png" alt="Figure 1" width="672" />
<p class="caption">
Figure 24.1: Figure 1
</p>
</div>
<div id="extracting-values" class="section level3">
<h3><span class="header-section-number">24.0.1</span> Extracting values</h3>
<p>Suppose, we are interested with the depth value from the stations we took profiles of temperature and salinity along the transect (Figure <a href="extract-bathymetric-values-from-etopo1.html#fig:fig3002">24.2</a>). We can create an imaginary CTD cast along the transect with a <code>tibble()</code> function—an extended version of <code>data.frame()</code>—both make a tabular structure of variables organized in rows and columns. The chunk transect in figure was created with the code in the chunk block below</p>
<pre class="sourceCode r"><code class="sourceCode r">transect =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">lon =</span> <span class="kw">pretty</span>(<span class="kw">c</span>(<span class="dv">39</span>,<span class="dv">41</span>), <span class="dt">n =</span> <span class="dv">40</span>),
                      <span class="dt">lat =</span> <span class="kw">pretty</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">7</span>), <span class="dt">n =</span> <span class="dv">40</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rev</span>())</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## pemba data</span>
pemba.bath =<span class="st"> </span>bathmetry<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(bath <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-32000</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">38</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">42</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-7</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-1</span>)

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_tanaka</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">size =</span> <span class="fl">3.2</span>, 
                          <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> aoi, <span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.5</span>,<span class="fl">41.3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="op">-</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> transect, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">39</span>,<span class="dv">41</span>,.<span class="dv">6</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">5.8</span>,<span class="op">-</span><span class="fl">4.2</span>,.<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<div class="figure"><span id="fig:fig3002"></span>
<img src="spatil_r_files/figure-html/fig3002-1.png" alt="Figure 1" width="672" />
<p class="caption">
Figure 24.2: Figure 1
</p>
</div>
<p>Once we have points along the track, we can get the depth of each points from the bathmetry value. This simply means extract values of a raster cell for each longitude and latitude and output as vector. This can be achieved with <code>extract()</code>function of the raster package. Because we use the raster package, we have to convert the xyz bathmetric dataset into raster layer as the chunk below show. In a nutshell, the code does two main task—convert the bathmetry that is in xyz into the raster layer with <code>rasterFromXYZ()</code> function and then <code>exract()</code> the bathmetry value at each geographical coordinates with the <code>extract()</code> function. The table <a href="extract-bathymetric-values-from-etopo1.html#tab:tab3001">24.1</a> highlight the water depth extracted at each longitude and latitude coordinates.</p>
<pre class="sourceCode r"><code class="sourceCode r">bath =<span class="st"> </span>pemba.bath <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>raster<span class="op">::</span><span class="kw">rasterFromXYZ</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>raster<span class="op">::</span><span class="kw">extract</span>(transect)

transect =<span class="st"> </span><span class="kw">data.frame</span>(transect, bath)</code></pre>
<table>
<caption>
<span id="tab:tab3001">Table 24.1: </span>Water depth at each geographical coordinates extracted from a raster layer
</caption>
<thead>
<tr>
<th style="text-align:right;">
Longitude
</th>
<th style="text-align:right;">
Latitude
</th>
<th style="text-align:right;">
Water depth (m)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
39.65
</td>
<td style="text-align:right;">
-4.3
</td>
<td style="text-align:right;">
-326
</td>
</tr>
<tr>
<td style="text-align:right;">
39.70
</td>
<td style="text-align:right;">
-4.4
</td>
<td style="text-align:right;">
-594
</td>
</tr>
<tr>
<td style="text-align:right;">
39.75
</td>
<td style="text-align:right;">
-4.5
</td>
<td style="text-align:right;">
-532
</td>
</tr>
<tr>
<td style="text-align:right;">
39.80
</td>
<td style="text-align:right;">
-4.6
</td>
<td style="text-align:right;">
-437
</td>
</tr>
<tr>
<td style="text-align:right;">
39.85
</td>
<td style="text-align:right;">
-4.7
</td>
<td style="text-align:right;">
-345
</td>
</tr>
<tr>
<td style="text-align:right;">
39.90
</td>
<td style="text-align:right;">
-4.8
</td>
<td style="text-align:right;">
-135
</td>
</tr>
<tr>
<td style="text-align:right;">
39.95
</td>
<td style="text-align:right;">
-4.9
</td>
<td style="text-align:right;">
-538
</td>
</tr>
<tr>
<td style="text-align:right;">
40.00
</td>
<td style="text-align:right;">
-5.0
</td>
<td style="text-align:right;">
-843
</td>
</tr>
<tr>
<td style="text-align:right;">
40.05
</td>
<td style="text-align:right;">
-5.1
</td>
<td style="text-align:right;">
-1157
</td>
</tr>
<tr>
<td style="text-align:right;">
40.10
</td>
<td style="text-align:right;">
-5.2
</td>
<td style="text-align:right;">
-1331
</td>
</tr>
<tr>
<td style="text-align:right;">
40.15
</td>
<td style="text-align:right;">
-5.3
</td>
<td style="text-align:right;">
-1386
</td>
</tr>
<tr>
<td style="text-align:right;">
40.20
</td>
<td style="text-align:right;">
-5.4
</td>
<td style="text-align:right;">
-1478
</td>
</tr>
<tr>
<td style="text-align:right;">
40.25
</td>
<td style="text-align:right;">
-5.5
</td>
<td style="text-align:right;">
-1637
</td>
</tr>
<tr>
<td style="text-align:right;">
40.30
</td>
<td style="text-align:right;">
-5.6
</td>
<td style="text-align:right;">
-1868
</td>
</tr>
<tr>
<td style="text-align:right;">
40.35
</td>
<td style="text-align:right;">
-5.7
</td>
<td style="text-align:right;">
-1852
</td>
</tr>
<tr>
<td style="text-align:right;">
40.40
</td>
<td style="text-align:right;">
-5.8
</td>
<td style="text-align:right;">
-1856
</td>
</tr>
<tr>
<td style="text-align:right;">
40.45
</td>
<td style="text-align:right;">
-5.9
</td>
<td style="text-align:right;">
-1826
</td>
</tr>
<tr>
<td style="text-align:right;">
40.50
</td>
<td style="text-align:right;">
-6.0
</td>
<td style="text-align:right;">
-1832
</td>
</tr>
<tr>
<td style="text-align:right;">
40.55
</td>
<td style="text-align:right;">
-6.1
</td>
<td style="text-align:right;">
-1856
</td>
</tr>
<tr>
<td style="text-align:right;">
40.60
</td>
<td style="text-align:right;">
-6.2
</td>
<td style="text-align:right;">
-1869
</td>
</tr>
<tr>
<td style="text-align:right;">
40.65
</td>
<td style="text-align:right;">
-6.3
</td>
<td style="text-align:right;">
-1890
</td>
</tr>
<tr>
<td style="text-align:right;">
40.70
</td>
<td style="text-align:right;">
-6.4
</td>
<td style="text-align:right;">
-1963
</td>
</tr>
<tr>
<td style="text-align:right;">
40.75
</td>
<td style="text-align:right;">
-6.5
</td>
<td style="text-align:right;">
-2072
</td>
</tr>
<tr>
<td style="text-align:right;">
40.80
</td>
<td style="text-align:right;">
-6.6
</td>
<td style="text-align:right;">
-2139
</td>
</tr>
<tr>
<td style="text-align:right;">
40.85
</td>
<td style="text-align:right;">
-6.7
</td>
<td style="text-align:right;">
-2151
</td>
</tr>
<tr>
<td style="text-align:right;">
40.90
</td>
<td style="text-align:right;">
-6.8
</td>
<td style="text-align:right;">
-2302
</td>
</tr>
<tr>
<td style="text-align:right;">
40.95
</td>
<td style="text-align:right;">
-6.9
</td>
<td style="text-align:right;">
-2360
</td>
</tr>
<tr>
<td style="text-align:right;">
41.00
</td>
<td style="text-align:right;">
-7.0
</td>
<td style="text-align:right;">
-2412
</td>
</tr>
</tbody>
</table>
<p>The profile was plotted on top of the bathmetry map as shown in figure <a href="#fig:fig3003"><strong>??</strong></a></p>
<pre class="sourceCode r"><code class="sourceCode r">map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_tanaka</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span>pemba.bath, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> bath), <span class="dt">size =</span> <span class="fl">3.2</span>, 
                          <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> aoi, <span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.5</span>,<span class="fl">41.3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="op">-</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> transect, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">39</span>,<span class="dv">41</span>,.<span class="dv">6</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">5.8</span>,<span class="op">-</span><span class="fl">4.2</span>,.<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)

profile =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> transect, <span class="kw">aes</span>(<span class="dt">x =</span> lat, <span class="dt">y =</span> bath), <span class="dt">size =</span> <span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="co"># geom_point(data = transect, aes(x = lat, y = bath), size = 2)+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">7.8</span>,<span class="op">-</span><span class="dv">3</span>,<span class="fl">1.2</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">7.8</span>,<span class="op">-</span><span class="dv">3</span>,<span class="fl">1.2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3000</span>,<span class="dv">0</span>,<span class="dv">750</span>), <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>,<span class="dv">750</span>)<span class="op">%&gt;%</span><span class="kw">rev</span>())<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>), 
        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">7.2</span>,<span class="op">-</span><span class="fl">4.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2500</span>,<span class="dv">5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;Water Depth (m)&quot;</span>)

cowplot<span class="op">::</span><span class="kw">ggdraw</span>()<span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> map, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> profile, <span class="dt">x =</span> <span class="fl">.59</span>,<span class="dt">y =</span> <span class="fl">.53</span>, <span class="dt">width =</span> <span class="fl">.3</span>,<span class="dt">height =</span> <span class="fl">.4</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/fig3003-1.png" width="672" /></p>
</div>
<div id="reference-1" class="section level3">
<h3><span class="header-section-number">24.0.2</span> Reference</h3>

<div id="refs" class="references">
<div>
<p>Kelley, Dan, and Clark Richards. 2018. <em>Oce: Analysis of Oceanographic Data</em>. <a href="https://CRAN.R-project.org/package=oce">https://CRAN.R-project.org/package=oce</a>.</p>
</div>
<div>
<p>R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div>
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2019. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-oce">
<p>Kelley, Dan, and Clark Richards. 2018. <em>Oce: Analysis of Oceanographic Data</em>. <a href="https://CRAN.R-project.org/package=oce">https://CRAN.R-project.org/package=oce</a>.</p>
</div>
<div id="ref-r">
<p>R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-dplyr">
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2019. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="primary-production-chlorophyll-concentration-and-sea-surface-temperature-in.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
