<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 11 Indian Ocean | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 11 Indian Ocean | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Indian Ocean | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba">


<meta name="date" content="2019-05-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="monsoon-circulation.html">
<link rel="next" href="ocean-productivity.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i>Sources</a></li>
<li class="chapter" data-level="" data-path="note-to-the-reader.html"><a href="note-to-the-reader.html"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to Spatial Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-programming"><i class="fa fa-check"></i><b>1.1</b> Why Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r-1"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-featurs-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Featurs of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#arithmetric"><i class="fa fa-check"></i><b>2.1.1</b> Arithmetric</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#functions"><i class="fa fa-check"></i><b>2.2.2</b> Functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started.html"><a href="getting-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.3</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started.html"><a href="getting-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-started.html"><a href="getting-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started.html"><a href="getting-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="getting-started.html"><a href="getting-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="getting-started.html"><a href="getting-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="getting-started.html"><a href="getting-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="getting-started.html"><a href="getting-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started.html"><a href="getting-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started.html"><a href="getting-started.html#exercise"><i class="fa fa-check"></i><b>2.7</b> Exercise</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started.html"><a href="getting-started.html#exercise-1"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>3</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="3.1" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>3.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="3.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>3.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="3.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>3.3</b> Writing t a File</a></li>
<li class="chapter" data-level="3.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>3.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="3.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>3.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="3.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>3.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>4</b> Vector Data</a><ul>
<li class="chapter" data-level="4.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>4.2</b> Vector Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>4.2.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>4.3</b> Reading vector data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>4.3.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="4.3.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>4.3.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>4.4</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="4.5" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>4.5</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="5.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>5.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="5.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-functionality"><i class="fa fa-check"></i><b>5.2</b> dplyr functionality</a></li>
<li class="chapter" data-level="5.3" data-path="dplyr.html"><a href="dplyr.html#filter-keep-rows-matching-criteria"><i class="fa fa-check"></i><b>5.3</b> filter: Keep rows matching criteria</a></li>
<li class="chapter" data-level="5.4" data-path="dplyr.html"><a href="dplyr.html#select-pick-columns-by-name"><i class="fa fa-check"></i><b>5.4</b> select: Pick columns by name</a></li>
<li class="chapter" data-level="5.5" data-path="dplyr.html"><a href="dplyr.html#chaining-or-pipelining"><i class="fa fa-check"></i><b>5.5</b> “Chaining” or “Pipelining”</a></li>
<li class="chapter" data-level="5.6" data-path="dplyr.html"><a href="dplyr.html#pipping-with"><i class="fa fa-check"></i><b>5.6</b> Pipping with</a><ul>
<li class="chapter" data-level="5.6.1" data-path="dplyr.html"><a href="dplyr.html#choosing-columns-select-rename"><i class="fa fa-check"></i><b>5.6.1</b> Choosing columns: <code>select()</code>, <code>rename()</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filter-between-slice-sample_n-top_n-distinct"><i class="fa fa-check"></i><b>5.6.2</b> Choosing rows: filter, between, slice, sample_n, top_n, distinct</a></li>
<li class="chapter" data-level="5.6.3" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>5.6.3</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="5.6.4" data-path="dplyr.html"><a href="dplyr.html#grouping-and-counting-summarise-tally-count-group_size-n_groups-ungroup"><i class="fa fa-check"></i><b>5.6.4</b> Grouping and counting: summarise, tally, count, group_size, n_groups, ungroup</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>6</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="6.1" data-path="tidy.html"><a href="tidy.html#gather-function"><i class="fa fa-check"></i><b>6.1</b> gather( ) function:</a></li>
<li class="chapter" data-level="6.2" data-path="tidy.html"><a href="tidy.html#separate-function"><i class="fa fa-check"></i><b>6.2</b> separate( ) function:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>7</b> Raster Data</a><ul>
<li class="chapter" data-level="7.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>7.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="7.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>7.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="7.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>7.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="7.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>7.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="7.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>7.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="7.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>7.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>7.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="7.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>7.3</b> Raster resolution</a></li>
<li class="chapter" data-level="7.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>7.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="7.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>7.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="7.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>7.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>7.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="7.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>7.7</b> Raster time series data</a></li>
<li class="chapter" data-level="7.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>7.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rasterv.html"><a href="rasterv.html"><i class="fa fa-check"></i><b>8</b> Raster Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="rasterv.html"><a href="rasterv.html#visualize-bathmetry-with-ggplot2"><i class="fa fa-check"></i><b>8.1</b> visualize bathmetry with ggplot2</a></li>
<li class="chapter" data-level="8.2" data-path="rasterv.html"><a href="rasterv.html#convert-data-frame-to-bathmetric-object"><i class="fa fa-check"></i><b>8.2</b> Convert data frame to bathmetric object</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>9</b> Making Maps</a><ul>
<li class="chapter" data-level="9.1" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>9.1.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="graphics.html"><a href="graphics.html#creating-a-ggplot"><i class="fa fa-check"></i><b>9.2</b> Creating a ggplot</a><ul>
<li class="chapter" data-level="9.2.1" data-path="graphics.html"><a href="graphics.html#label"><i class="fa fa-check"></i><b>9.2.1</b> Label</a></li>
<li class="chapter" data-level="9.2.2" data-path="graphics.html"><a href="graphics.html#annotations"><i class="fa fa-check"></i><b>9.2.2</b> Annotations</a></li>
<li class="chapter" data-level="9.2.3" data-path="graphics.html"><a href="graphics.html#scales"><i class="fa fa-check"></i><b>9.2.3</b> Scales</a></li>
<li class="chapter" data-level="9.2.4" data-path="graphics.html"><a href="graphics.html#zooming"><i class="fa fa-check"></i><b>9.2.4</b> Zooming</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>9.3</b> Inset maps</a></li>
<li class="chapter" data-level="9.4" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>9.4</b> Static Maps</a><ul>
<li class="chapter" data-level="9.4.1" data-path="graphics.html"><a href="graphics.html#map-elements"><i class="fa fa-check"></i><b>9.4.1</b> Map elements</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>9.5</b> Animated maps</a></li>
<li class="chapter" data-level="9.6" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>9.6</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html"><i class="fa fa-check"></i><b>10</b> Monsoon circulation</a><ul>
<li class="chapter" data-level="10.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#winds"><i class="fa fa-check"></i><b>10.1</b> winds</a><ul>
<li class="chapter" data-level="10.1.1" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#climatologies"><i class="fa fa-check"></i><b>10.1.1</b> Climatologies</a></li>
<li class="chapter" data-level="10.1.2" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#annual-cycles-and-means"><i class="fa fa-check"></i><b>10.1.2</b> Annual cycles and means</a></li>
<li class="chapter" data-level="10.1.3" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#intraseasonal-variability"><i class="fa fa-check"></i><b>10.1.3</b> Intraseasonal variability</a></li>
<li class="chapter" data-level="10.1.4" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#sea-surface-height"><i class="fa fa-check"></i><b>10.1.4</b> sea surface height</a></li>
<li class="chapter" data-level="10.1.5" data-path="monsoon-circulation.html"><a href="monsoon-circulation.html#sea-surface-temperature"><i class="fa fa-check"></i><b>10.1.5</b> sea surface temperature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="indian-ocean.html"><a href="indian-ocean.html"><i class="fa fa-check"></i><b>11</b> Indian Ocean</a><ul>
<li class="chapter" data-level="11.1" data-path="indian-ocean.html"><a href="indian-ocean.html#ocean-circulation"><i class="fa fa-check"></i><b>11.1</b> Ocean circulation</a></li>
<li class="chapter" data-level="11.2" data-path="indian-ocean.html"><a href="indian-ocean.html#wind"><i class="fa fa-check"></i><b>11.2</b> wind</a></li>
<li class="chapter" data-level="11.3" data-path="indian-ocean.html"><a href="indian-ocean.html#calculate-the-zonal-departure-of-surface-wind"><i class="fa fa-check"></i><b>11.3</b> calculate the zonal departure of surface wind</a></li>
<li class="chapter" data-level="11.4" data-path="indian-ocean.html"><a href="indian-ocean.html#regional-surface-ocean-dynamics"><i class="fa fa-check"></i><b>11.4</b> REGIONAL SURFACE OCEAN DYNAMICS</a><ul>
<li class="chapter" data-level="11.4.1" data-path="indian-ocean.html"><a href="indian-ocean.html#the-eastafrican-coastal-current"><i class="fa fa-check"></i><b>11.4.1</b> The EastAfrican Coastal Current</a></li>
<li class="chapter" data-level="11.4.2" data-path="indian-ocean.html"><a href="indian-ocean.html#the-somali-current-sc"><i class="fa fa-check"></i><b>11.4.2</b> The Somali Current (SC)</a></li>
<li class="chapter" data-level="11.4.3" data-path="indian-ocean.html"><a href="indian-ocean.html#the-mozambique-current-mc"><i class="fa fa-check"></i><b>11.4.3</b> The Mozambique Current (MC)</a></li>
<li class="chapter" data-level="11.4.4" data-path="indian-ocean.html"><a href="indian-ocean.html#the-southern-gyre-sg"><i class="fa fa-check"></i><b>11.4.4</b> The Southern Gyre (SG)</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="indian-ocean.html"><a href="indian-ocean.html#physical"><i class="fa fa-check"></i><b>11.5</b> Physical</a><ul>
<li class="chapter" data-level="11.5.1" data-path="indian-ocean.html"><a href="indian-ocean.html#temperature"><i class="fa fa-check"></i><b>11.5.1</b> Temperature</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="indian-ocean.html"><a href="indian-ocean.html#salinity"><i class="fa fa-check"></i><b>11.6</b> Salinity</a></li>
<li class="chapter" data-level="11.7" data-path="indian-ocean.html"><a href="indian-ocean.html#chemical"><i class="fa fa-check"></i><b>11.7</b> Chemical</a><ul>
<li class="chapter" data-level="11.7.1" data-path="indian-ocean.html"><a href="indian-ocean.html#dissolved-oxygen"><i class="fa fa-check"></i><b>11.7.1</b> Dissolved oxygen</a></li>
<li class="chapter" data-level="11.7.2" data-path="indian-ocean.html"><a href="indian-ocean.html#nitrate"><i class="fa fa-check"></i><b>11.7.2</b> Nitrate</a></li>
<li class="chapter" data-level="11.7.3" data-path="indian-ocean.html"><a href="indian-ocean.html#phosphate"><i class="fa fa-check"></i><b>11.7.3</b> Phosphate</a></li>
<li class="chapter" data-level="11.7.4" data-path="indian-ocean.html"><a href="indian-ocean.html#silica"><i class="fa fa-check"></i><b>11.7.4</b> Silica</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="indian-ocean.html"><a href="indian-ocean.html#wind-1"><i class="fa fa-check"></i><b>11.8</b> wind</a></li>
<li class="chapter" data-level="11.9" data-path="indian-ocean.html"><a href="indian-ocean.html#bagamoyo-ctd"><i class="fa fa-check"></i><b>11.9</b> Bagamoyo ctd</a></li>
<li class="chapter" data-level="11.10" data-path="indian-ocean.html"><a href="indian-ocean.html#ctd"><i class="fa fa-check"></i><b>11.10</b> CTD</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ocean-productivity.html"><a href="ocean-productivity.html"><i class="fa fa-check"></i><b>12</b> Ocean productivity</a></li>
<li class="chapter" data-level="13" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html"><i class="fa fa-check"></i><b>13</b> Sea Surface Temperature</a><ul>
<li class="chapter" data-level="13.1" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#annual-mean-sea-surface-temperature"><i class="fa fa-check"></i><b>13.1</b> Annual Mean Sea Surface Temperature</a></li>
<li class="chapter" data-level="13.2" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#anomaly-of-sea-surface-temperature"><i class="fa fa-check"></i><b>13.2</b> Anomaly of sea surface temperature</a></li>
<li class="chapter" data-level="13.3" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#precipitation"><i class="fa fa-check"></i><b>13.3</b> Precipitation</a></li>
<li class="chapter" data-level="13.4" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#wind-speed-and-direction"><i class="fa fa-check"></i><b>13.4</b> WInd speed and direction</a></li>
<li class="chapter" data-level="13.5" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#air-temperature"><i class="fa fa-check"></i><b>13.5</b> air temperature</a></li>
<li class="chapter" data-level="13.6" data-path="sea-surface-temperature-1.html"><a href="sea-surface-temperature-1.html#zonal-anomaly-of-air-temperature"><i class="fa fa-check"></i><b>13.6</b> Zonal anomaly of air temperature</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="precipitation-1.html"><a href="precipitation-1.html"><i class="fa fa-check"></i><b>14</b> precipitation</a><ul>
<li class="chapter" data-level="14.1" data-path="precipitation-1.html"><a href="precipitation-1.html#handling-data"><i class="fa fa-check"></i><b>14.1</b> Handling data</a></li>
<li class="chapter" data-level="14.2" data-path="precipitation-1.html"><a href="precipitation-1.html#required-packages"><i class="fa fa-check"></i><b>14.2</b> Required packages</a></li>
<li class="chapter" data-level="14.3" data-path="precipitation-1.html"><a href="precipitation-1.html#formatting-data"><i class="fa fa-check"></i><b>14.3</b> Formatting data</a></li>
<li class="chapter" data-level="14.4" data-path="precipitation-1.html"><a href="precipitation-1.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>14.4</b> Plotting with ggplot2</a></li>
<li class="chapter" data-level="14.5" data-path="precipitation-1.html"><a href="precipitation-1.html#conclusion"><i class="fa fa-check"></i><b>14.5</b> Conclusion</a></li>
<li class="chapter" data-level="14.6" data-path="precipitation-1.html"><a href="precipitation-1.html#references"><i class="fa fa-check"></i><b>14.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="15" data-path="index.html"><a href="index.html#index"><i class="fa fa-check"></i><b>15</b> Index</a><ul>
<li class="chapter" data-level="15.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>15.1</b> R</a></li>
<li class="chapter" data-level="15.2" data-path="index.html"><a href="index.html#rmarkdown-1"><i class="fa fa-check"></i><b>15.2</b> Rmarkdown</a></li>
<li class="chapter" data-level="15.3" data-path="index.html"><a href="index.html#bookdown"><i class="fa fa-check"></i><b>15.3</b> Bookdown</a></li>
<li class="chapter" data-level="15.4" data-path="index.html"><a href="index.html#pandoc"><i class="fa fa-check"></i><b>15.4</b> Pandoc</a></li>
<li class="chapter" data-level="15.5" data-path="index.html"><a href="index.html#woa-for-nyamisi-manuscript"><i class="fa fa-check"></i><b>15.5</b> WOA for Nyamisi manuscript</a></li>
<li class="chapter" data-level="15.6" data-path="index.html"><a href="index.html#producing-maps-programatically"><i class="fa fa-check"></i><b>15.6</b> Producing Maps programatically</a><ul>
<li class="chapter" data-level="15.6.1" data-path="index.html"><a href="index.html#satellite-data"><i class="fa fa-check"></i><b>15.6.1</b> satellite data</a></li>
<li class="chapter" data-level="15.6.2" data-path="index.html"><a href="index.html#drifter-data"><i class="fa fa-check"></i><b>15.6.2</b> drifter data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="spatial-patterns.html"><a href="spatial-patterns.html"><i class="fa fa-check"></i><b>16</b> Spatial Patterns</a></li>
<li class="chapter" data-level="17" data-path="buoys-data.html"><a href="buoys-data.html"><i class="fa fa-check"></i><b>17</b> buoys data</a></li>
<li class="chapter" data-level="18" data-path="altimetry.html"><a href="altimetry.html"><i class="fa fa-check"></i><b>18</b> Altimetry</a><ul>
<li class="chapter" data-level="18.1" data-path="altimetry.html"><a href="altimetry.html#sea-surface-height-1"><i class="fa fa-check"></i><b>18.1</b> Sea surface height</a></li>
<li class="chapter" data-level="18.2" data-path="altimetry.html"><a href="altimetry.html#visualizing"><i class="fa fa-check"></i><b>18.2</b> Visualizing</a></li>
<li class="chapter" data-level="18.3" data-path="altimetry.html"><a href="altimetry.html#read-netcdf-file-with-in-r"><i class="fa fa-check"></i><b>18.3</b> Read netCDF file with in R</a><ul>
<li class="chapter" data-level="18.3.1" data-path="altimetry.html"><a href="altimetry.html#understand-the-metadata"><i class="fa fa-check"></i><b>18.3.1</b> Understand the metadata</a></li>
<li class="chapter" data-level="18.3.2" data-path="altimetry.html"><a href="altimetry.html#extract-the-variable"><i class="fa fa-check"></i><b>18.3.2</b> Extract the variable</a></li>
<li class="chapter" data-level="18.3.3" data-path="altimetry.html"><a href="altimetry.html#transform-to-data-frame"><i class="fa fa-check"></i><b>18.3.3</b> Transform to data frame</a></li>
<li class="chapter" data-level="18.3.4" data-path="altimetry.html"><a href="altimetry.html#stitching-the-data"><i class="fa fa-check"></i><b>18.3.4</b> Stitching the data</a></li>
<li class="chapter" data-level="18.3.5" data-path="altimetry.html"><a href="altimetry.html#visualizemapping-the-ssh"><i class="fa fa-check"></i><b>18.3.5</b> Visualize—Mapping the SSH</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="altimetry.html"><a href="altimetry.html#reference"><i class="fa fa-check"></i><b>18.4</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="argo-floats.html"><a href="argo-floats.html"><i class="fa fa-check"></i><b>19</b> Argo floats</a><ul>
<li class="chapter" data-level="19.1" data-path="argo-floats.html"><a href="argo-floats.html#iso-surface"><i class="fa fa-check"></i><b>19.1</b> Iso-surface</a></li>
<li class="chapter" data-level="19.2" data-path="argo-floats.html"><a href="argo-floats.html#regional-and-global-distributions"><i class="fa fa-check"></i><b>19.2</b> Regional and global distributions</a></li>
<li class="chapter" data-level="19.3" data-path="argo-floats.html"><a href="argo-floats.html#introduction-2"><i class="fa fa-check"></i><b>19.3</b> Introduction</a><ul>
<li class="chapter" data-level="19.3.1" data-path="argo-floats.html"><a href="argo-floats.html#import-data"><i class="fa fa-check"></i><b>19.3.1</b> Import Data</a></li>
<li class="chapter" data-level="19.3.2" data-path="argo-floats.html"><a href="argo-floats.html#tidy-the-data"><i class="fa fa-check"></i><b>19.3.2</b> Tidy the data</a></li>
<li class="chapter" data-level="19.3.3" data-path="argo-floats.html"><a href="argo-floats.html#data-frames"><i class="fa fa-check"></i><b>19.3.3</b> Data Frames</a></li>
<li class="chapter" data-level="19.3.4" data-path="argo-floats.html"><a href="argo-floats.html#transform"><i class="fa fa-check"></i><b>19.3.4</b> Transform</a></li>
<li class="chapter" data-level="19.3.5" data-path="argo-floats.html"><a href="argo-floats.html#create-simple-feature"><i class="fa fa-check"></i><b>19.3.5</b> Create Simple Feature</a></li>
<li class="chapter" data-level="19.3.6" data-path="argo-floats.html"><a href="argo-floats.html#gridding"><i class="fa fa-check"></i><b>19.3.6</b> Gridding</a></li>
<li class="chapter" data-level="19.3.7" data-path="argo-floats.html"><a href="argo-floats.html#populate-grids-with-drifter-observations-and-median-sst"><i class="fa fa-check"></i><b>19.3.7</b> Populate Grids with Drifter Observations and Median SST</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ctd-1.html"><a href="ctd-1.html"><i class="fa fa-check"></i><b>20</b> CTD</a><ul>
<li class="chapter" data-level="20.1" data-path="ctd-1.html"><a href="ctd-1.html#vertical-cross-sections"><i class="fa fa-check"></i><b>20.1</b> Vertical cross sections</a></li>
<li class="chapter" data-level="20.2" data-path="ctd-1.html"><a href="ctd-1.html#ctd-list"><i class="fa fa-check"></i><b>20.2</b> ctd list</a><ul>
<li class="chapter" data-level="20.2.1" data-path="ctd-1.html"><a href="ctd-1.html#pemba-channel-section"><i class="fa fa-check"></i><b>20.2.1</b> Pemba Channel Section</a></li>
<li class="chapter" data-level="20.2.2" data-path="ctd-1.html"><a href="ctd-1.html#mtwara-section"><i class="fa fa-check"></i><b>20.2.2</b> Mtwara Section</a></li>
<li class="chapter" data-level="20.2.3" data-path="ctd-1.html"><a href="ctd-1.html#iso-surface-1"><i class="fa fa-check"></i><b>20.2.3</b> Iso surface</a></li>
<li class="chapter" data-level="20.2.4" data-path="ctd-1.html"><a href="ctd-1.html#location-information"><i class="fa fa-check"></i><b>20.2.4</b> Location information</a></li>
<li class="chapter" data-level="20.2.5" data-path="ctd-1.html"><a href="ctd-1.html#make-a-data-frame-from-ctd-list"><i class="fa fa-check"></i><b>20.2.5</b> make a data frame from CTD list</a></li>
<li class="chapter" data-level="20.2.6" data-path="ctd-1.html"><a href="ctd-1.html#isosurface-in-mafia-channel"><i class="fa fa-check"></i><b>20.2.6</b> Isosurface in Mafia Channel</a></li>
<li class="chapter" data-level="20.2.7" data-path="ctd-1.html"><a href="ctd-1.html#references-2"><i class="fa fa-check"></i><b>20.2.7</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="surface-circulation.html"><a href="surface-circulation.html"><i class="fa fa-check"></i><b>21</b> Surface circulation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="indian-ocean" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Indian Ocean</h1>
<p>The Indian Ocean is the thrid larges ocean of the world. It occupies about 14.4 percent of the planetary surface, with an approximated area of 73,556,000 km<sup>2</sup>, with an average depth of 3,890 m and volume of 292,131,000 km<sup>3</sup>. Its deepest point of 8,000 m below the surface is in the Diamantina Trench. The basin extends in latitude from the Tropic of Cancer to the Antarctic, and reaches a longitudinal width of about 10,000 km, between the southern tip of Africa and Australia<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<p>The surface salinity in the Indian Ocean ranges between 32 to 37 psu. The regions with low salinity include areas that receives monsoon rains,high latitudes and along coasts with inflow of freshwater from rivers. The Arabian sea and a belt between southern Africa and south–western Australia are regions of high salinity in the Indian Ocean. The surface water temperatures in the Indian Ocean vary between 22 <sup>o</sup>C and 28<sup>o</sup>C, northward of the Tropic of Capricorn, but drop rather quickly southward <span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<p>The water column of the Indian ocean can be divided into three main groups. The upper water at the surface found between the surface to 500 meter deep. This water is formed by subduction at the tropics, Indonesian, Bengal and Arabian Sea water. Below this is the central water found between 500 and 1500 m deep.This water is formed by deep convection east and west of the southern tip of the American continent and spread into all ocean with the CIrcumpolar Current and by the Indonesian, Red Sea and Persian Gulf intermidiate water in the north. The third layer is the water found from 1500 m to the bottom, formed by a mixture of North Atlantic Deep Water and Antarctic Bottom Water in the Weddel Sea and Ross Sea<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">conflicted<span class="op">::</span><span class="kw">conflict_prefer</span>(<span class="dt">name =</span> <span class="st">&quot;select&quot;</span>, <span class="dt">winner =</span> <span class="st">&quot;dplyr&quot;</span>, <span class="dt">losers =</span> <span class="st">&quot;raster&quot;</span>)</code></pre>
<pre><code>## [conflicted] Removing existing preference</code></pre>
<pre><code>## [conflicted] Will prefer dplyr::select over raster::select</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># conflicted::conflict_prefer(name = &quot;filter&quot;, winner = &quot;dplyr&quot;, losers = &quot;raster&quot;)</span></code></pre>
<div id="ocean-circulation" class="section level2">
<h2><span class="header-section-number">11.1</span> Ocean circulation</h2>
<p>The ocean circulation is composed of a <em>wind-driven</em> component and a <em>thermohaline</em> component [ref]. The wind driven circulation dominates the surface current, but it is largerly restricted to the topmost few hundred meters [ref]. The circulation deeper in the ocean is largely depends on the slower thermohaline circulation.</p>
<p>The general thermohaline circulation of the Indian Ocean, as part of the global Conveyor Belt system, is composed by a prevalent northeastward flow in the lower layers and by a prevalent southwestward flow in the upper layers. At the surface, the wind–driven circulation pattern consisit of variable currents, dominated by the monsoon winds reversals. By generating ocean waves, surface winds transfer horizontal momentum from the atmosphere into the ocean. The waves stir the uppermost layer of the ocean, mixing the momentum downward.</p>
<p>The focus is on the monsoon circulation north of about 10°S—a region of strong monsoonal wind forcing variability <span class="citation">(Friedrich and Julian <a href="#ref-schott">2001</a>)</span>. During SE, the flow of the upper ocean is directed eastward, from the african area, around the indian sub–continent and towards the Indonesian region. During NE, the direction reverses, with westward flow from the Indonesian region towards the African Area. The transition of monsoon season occurs over a time period of several weeks and is caused by the changes in the wind stress associated with the Indian monsoon: winds blow from the southwest result in eastward currents, while winds blowing from the northeast results in westward currents.</p>
<p>The monsoon seasons indicate varying current regime found in the tropical regions of the northern Indian Ocean. During the southeast (SE) monsoon season (April–September), the northern component of the South Equatorial Current—the East African Coastal Current (EACC) feeds a northward flow Somali Current. This continues northward and eastward into the Southwest Monsoon Current. During the northeast (NE) monsoon season (October–March), the North Equatorial Current and the Northeast Mooon Current, flowing westward and southwestward, feed a southward Somali Currrent off east Africa. This joins with the northern flow East African Coastal Current into the Equatorial Countercurrent flowing eastward, away from the African continent<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<div id="the-east-african-coastal-current" class="section level4">
<h4><span class="header-section-number">11.1.0.1</span> The <strong>East African Coastal Current</strong></h4>
<p>The EACC, located between 10°S and 2°NThe current flow northeastward throughout the year. As this current flows toward the northeast, Ekman transport (to the right of the flow in northern hemisphere) is offshore, transporting warmer waters along the coast. This surface temperature pattern (cooler waters west of warmer waters) also reinforces the northward current through geostrophic flow<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
</div>
<div id="the-somali-current" class="section level4">
<h4><span class="header-section-number">11.1.0.2</span> The <strong>Somali Current</strong></h4>
<p>The Somali current , running along the Horn of Africa between the equator and about 9°S, is a boundary current somewhat analogous to the Gulf Stream in the Atlantic Ocean. However, this current is heavily influenced by seasonal changes in the atmospheric forcing, and shifts direction with the monsoon season winds<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<p>During the SE monsoon season, the Somali Current is fed by the EACC and flows to the northeast along the Somali coast, eventually sperating from the coastline and turing east as it enters the Arabian Sea. The north flowing of SC form a large re-circulating gyres at latitude 10°S and longitude 55°E during the SE season. As the SE season moves coastal waters northeastward, it induces coastal upwelling—the only major upwelling system that occurs on a western boundary of any ocean. The upwelled water within the current is carried offshore by Ekman transport and merges with water that was brought to the surface by open-ocean upwelling, creating one of the most productive ecosystem in the world’s oceans<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<p>In NE monsoon season, the SC flows to the southwest along the Somali coast towards the equator, ultimately contributing with the EACC to feed the Equatorial Countercurrent flowing eastward. The reversal of SC during the NE monsoon damps coastal upwelling, however, this tendency result into cooling and creates deeper mixing, bringing nutrient rich water to the surface<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
</div>
<div id="the-south-equatorial-current" class="section level4">
<h4><span class="header-section-number">11.1.0.3</span> The <strong>South Equatorial Current</strong></h4>
<p>The South Equatorial Current (SEC) flows westward with trade winds north of 22°S and at about 11°S it bifurcates into a north–flowing stream that feeds the northward flowing EACC and south–flowing stream that feeds the Mozambique current. Previous studies indicated that most of the water of the SEC goes into the EACC<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<p>The Mozambique Current flow southward within the Mozambique channel located between Mozambique and Madagascar Island. Unlike the EACC, which is western boundary current, the Mozambique current is characterized by the presence of large anti–cyclonic eddies that propgate in the channel. The Mozambique channel eddies are large cyclonic or anti–cyclonic that propgate southwards in the Mozambique channel<span class="citation">(<span class="citeproc-not-found" data-reference-id="barlae"><strong>???</strong></span>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)
<span class="kw">require</span>(oce)
<span class="kw">require</span>(lubridate)
<span class="kw">require</span>(sf)</code></pre>
</div>
</div>
<div id="wind" class="section level2">
<h2><span class="header-section-number">11.2</span> wind</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;e:/Data Manipulation/xtractomatic/quikscat_wio_2006_df.RData&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">wind.wio =<span class="st"> </span>u.all<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">lon =</span>longitude, <span class="dt">lat =</span> latitude) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_cols</span>(v.all <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(v)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>), 
         <span class="dt">day =</span> <span class="kw">yday</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>(),
         <span class="dt">month =</span> <span class="kw">month</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>())</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">wind.wio.season =<span class="st"> </span>wind.wio <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">season =</span> month,
                                      <span class="dt">season =</span> <span class="kw">replace</span>(season, season <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>), <span class="st">&quot;SE&quot;</span>),
                                      <span class="dt">season =</span> <span class="kw">replace</span>(season, season <span class="op">%in%</span><span class="st">  </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="st">&quot;NE&quot;</span>))

wind.wio.season =<span class="st"> </span>wind.wio.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(lon,lat, season) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">u =</span> <span class="kw">mean</span>(u, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">v =</span> <span class="kw">mean</span>(v, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">se.wind =<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="co"># geom_raster(data = wind.wio.season %&gt;% filter(season==&quot;SE&quot;), aes(x = lon, y = lat, fill = vel))+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> wind.wio.season <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(season<span class="op">==</span><span class="st">&quot;SE&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> vel), <span class="dt">na.fill =</span> T)<span class="op">+</span>
<span class="st">     </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">29</span>,<span class="dv">61</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">32</span>,<span class="fl">10.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">limits =</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="dt">colours =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">na.value =</span> <span class="st">&quot;darkgrey&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="ot">NA</span>), <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>())<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span><span class="ot">NULL</span>, <span class="dt">y =</span><span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;ticks&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, 
                                    <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>))

ne.wind =<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="co"># geom_raster(data = wind.wio.season %&gt;% filter(season==&quot;NE&quot;), aes(x = lon, y = lat, fill = vel))+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> wind.wio.season <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(season<span class="op">==</span><span class="st">&quot;NE&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> vel), <span class="dt">na.fill =</span> T)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">29</span>,<span class="dv">61</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">32</span>,<span class="fl">10.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">limits =</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="dt">colours =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">na.value =</span> <span class="st">&quot;darkgrey&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="ot">NA</span>), <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span><span class="ot">NULL</span>, <span class="dt">y =</span><span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;ticks&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, 
                                    <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>))

egg<span class="op">::</span><span class="kw">ggarrange</span>(ne.wind, se.wind, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<pre><code>## Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<pre><code>## Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">wind.wio.annual =<span class="st"> </span>wind.wio <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(lon,lat) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">vel =</span> <span class="kw">mean</span>(<span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
</div>
<div id="calculate-the-zonal-departure-of-surface-wind" class="section level2">
<h2><span class="header-section-number">11.3</span> calculate the zonal departure of surface wind</h2>
<pre class="sourceCode r"><code class="sourceCode r">Lat.space =<span class="st"> </span>wind.wio.annual<span class="op">%&gt;%</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lat) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()
wind.wio.anomaly =<span class="st"> </span><span class="kw">list</span>()

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Lat.space)){
  
  wind.wio.anomaly[[i]] =<span class="st"> </span>wind.wio.annual <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(lat <span class="op">==</span><span class="st"> </span>Lat.space[i]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">anomaly =</span> vel<span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(vel, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
}

wind.wio.anomaly =<span class="st"> </span>wind.wio.anomaly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> wind.wio.anomaly, 
       <span class="kw">aes</span>(anomaly))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 44162 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">wind.gg =<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> wind.wio.anomaly, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> anomaly))<span class="op">+</span>
<span class="st">  </span><span class="co"># metR::geom_contour_fill(data = wind.wio.anomaly %&gt;% filter(anomaly &gt;= -3 &amp; anomaly &lt;= 3),</span>
<span class="st">  </span><span class="co">#                         aes(x = lon, y = lat, z = anomaly), na.fill = T)+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">29</span>,<span class="dv">61</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">32</span>,<span class="fl">10.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">limits =</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">colours =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">na.value =</span> <span class="st">&quot;darkgrey&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="ot">NA</span>), <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span><span class="ot">NULL</span>, <span class="dt">y =</span><span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;ticks&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, 
                                    <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>))

wind.metr =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="co"># geom_raster(data = wind.wio.anomaly, aes(x = lon, y = lat, fill = anomaly))+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> wind.wio.anomaly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(anomaly <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-3</span> <span class="op">&amp;</span><span class="st"> </span>anomaly <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> anomaly), <span class="dt">na.fill =</span> T)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">29</span>,<span class="dv">61</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">32</span>,<span class="fl">10.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">limits =</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">colours =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">na.value =</span> <span class="st">&quot;darkgrey&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="ot">NA</span>), <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span><span class="ot">NULL</span>, <span class="dt">y =</span><span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;ticks&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, 
                                    <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>))

egg<span class="op">::</span><span class="kw">ggarrange</span>(wind.gg, wind.metr, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre>
<pre><code>## Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<pre><code>## Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="regional-surface-ocean-dynamics" class="section level2">
<h2><span class="header-section-number">11.4</span> REGIONAL SURFACE OCEAN DYNAMICS</h2>
<p>The true complexity of the dynamics of surface currents can be illustrated through more careful look at the regional level</p>
<p>The western indian ocean waters flows via three routes from south equatorial current: through the East African Coastal current, through the Somali Current and via the Mozambique Channel (Figure 1).</p>
<p>The combined analysis of GDP drifter data has revealed the spatial structure of the surface current in the regional is seasonal (Figure 12.5), with the strongest near-surface currents observed in southeast monsoon season (AMJJAS) and the relatively weak current occurring in northeast monsoon season (ONDJFM).</p>
<pre class="sourceCode r"><code class="sourceCode r">indian =<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;E:/Data Manipulation/drifter/tropind_drifters.txt&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   X1 = col_double(),
##   X2 = col_double(),
##   X3 = col_double(),
##   X4 = col_double(),
##   X5 = col_double(),
##   X6 = col_double(),
##   X7 = col_double(),
##   X8 = col_double(),
##   X9 = col_double(),
##   X10 = col_double(),
##   X11 = col_double(),
##   X12 = col_logical()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">indian =<span class="st"> </span>indian <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">id =</span> X1, <span class="dt">lon =</span> X2, <span class="dt">lat =</span> X3, <span class="dt">year=</span> X8, <span class="dt">month =</span>   X9, 
                                   <span class="dt">day =</span>  X10, <span class="dt">hour =</span> X11, <span class="dt">drogue =</span> X4, <span class="dt">u =</span>X5, <span class="dt">v =</span> X6,   <span class="dt">sst =</span> X7) 

indian =<span class="st"> </span>indian<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">season =</span> month,
         <span class="dt">season =</span> <span class="kw">replace</span>(season, season <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="st">&quot;NE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">replace</span>(season, season <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), <span class="st">&quot;SE&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> lubridate<span class="op">::</span><span class="kw">make_datetime</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> day,<span class="dt">hour =</span> hour))</code></pre>
<div id="the-eastafrican-coastal-current" class="section level3">
<h3><span class="header-section-number">11.4.1</span> The EastAfrican Coastal Current</h3>
<p>The EACC is broad and generally flowing northward throught the year between latitude 11°S and 2°S. The EACC links the SEC and SC.</p>
<p>Knowledge of the current seaonal variability of the EACC has suffered significantly from the lack of the long–term observations. The altimetry could also unable to resolve because the EACC flow over the coastal areas, where estimating currents from altimetry is less reliable (<span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>)</p>
<p>As the EACC flows northward, it continues to flow along the coastal areas and joint the Somali Current</p>
<pre class="sourceCode r"><code class="sourceCode r">eacc =<span class="st"> </span>indian <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-32</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;=</span><span class="st"> </span><span class="fl">10.5</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">35</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">61</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">c</span>(date, season,id, lon, lat, u, v, sst))

eacc.season =<span class="st"> </span>eacc <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(season, lon, lat) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">u =</span> <span class="kw">mean</span>(u, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">v =</span> <span class="kw">mean</span>(v, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>),
            <span class="dt">sst =</span> <span class="kw">mean</span>(sst, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eacc.sf =<span class="st"> </span>eacc.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_set_crs</span>(<span class="dv">4326</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## the glimpse of the EACC and the Somali Current</span>

grid.sf.field &lt;-<span class="st"> </span>eacc.sf <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># st_crop(xmin = 38, ymin = -12, xmax = 45, ymax = 2) %&gt;%</span>
<span class="st">  </span><span class="co"># st_make_grid(n = c(15,18)) %&gt;%</span>
<span class="st">  </span><span class="kw">st_crop</span>(<span class="dt">xmin =</span> <span class="dv">38</span>, <span class="dt">ymin =</span> <span class="dv">-24</span>, <span class="dt">xmax =</span> <span class="dv">55</span>, <span class="dt">ymax =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">st_make_grid</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">34</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">st_sf</span>()</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Warning: attribute variables are assumed to be spatially constant
## throughout all geometries</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eacc.bins.ne &lt;-<span class="st"> </span>eacc.sf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(season <span class="op">==</span><span class="st"> &quot;NE&quot;</span>)

eacc.binned.ne.vector &lt;-<span class="st"> </span>grid.sf.field <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>(),
    <span class="dt">contained =</span> <span class="kw">lapply</span>(<span class="kw">st_contains</span>(geometry, eacc.bins.ne), identity),
    <span class="dt">observations =</span> <span class="kw">sapply</span>(contained, length),
    <span class="dt">observations =</span> <span class="kw">replace</span>(observations, observations <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>),
    <span class="dt">u =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.ne[x, ]<span class="op">$</span>u, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
    <span class="dt">v =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.ne[x, ]<span class="op">$</span>v, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
    <span class="dt">sst =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.ne[x, ]<span class="op">$</span>sst, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
    <span class="dt">velocity =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>), <span class="dt">season =</span> <span class="st">&quot;NE&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>contained)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_contains assumes that they are planar</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eacc.bins.se &lt;-<span class="st"> </span>eacc.sf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(season <span class="op">==</span><span class="st"> &quot;SE&quot;</span>)

eacc.binned.se.vector &lt;-<span class="st"> </span>grid.sf.field <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>( <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>(),
          <span class="dt">contained =</span> <span class="kw">lapply</span>(<span class="kw">st_contains</span>(geometry, eacc.bins.se), identity),
          <span class="dt">observations =</span> <span class="kw">sapply</span>(contained, length),
          <span class="dt">observations =</span> <span class="kw">replace</span>(observations, observations <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>),
          <span class="dt">u =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.se[x, ]<span class="op">$</span>u, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
          <span class="dt">v =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.se[x, ]<span class="op">$</span>v, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
          <span class="dt">sst =</span> <span class="kw">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="kw">mean</span>(eacc.bins.se[x, ]<span class="op">$</span>sst, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)}),
          <span class="dt">velocity =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>),
          <span class="dt">season =</span> <span class="st">&quot;SE&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>contained)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_contains assumes that they are planar</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;e:/Data Manipulation/semba_functions.R&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">coordinates =<span class="st"> </span>eacc.binned.ne.vector <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_centroid</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_coordinates</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for
## longitude/latitude data</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eacc.binned.ne.tb =<span class="st"> </span>eacc.binned.ne.vector
<span class="kw">st_geometry</span>(eacc.binned.ne.tb) =<span class="st"> </span><span class="ot">NULL</span>

eacc.binned.ne.tb =<span class="st"> </span>coordinates <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(eacc.binned.ne.tb) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id)

u =<span class="st"> </span><span class="kw">interpolating_semba</span>(<span class="dt">x =</span> eacc.binned.ne.tb<span class="op">$</span>lon, <span class="dt">y =</span> eacc.binned.ne.tb<span class="op">$</span>lat, <span class="dt">z =</span> eacc.binned.ne.tb<span class="op">$</span>u)
u.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> u<span class="op">$</span>xg, <span class="dt">y =</span> u<span class="op">$</span>yg, <span class="dt">data =</span> u<span class="op">$</span>zg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">u =</span> value)

v =<span class="st"> </span><span class="kw">interpolating_semba</span>(<span class="dt">x =</span> eacc.binned.ne.tb<span class="op">$</span>lon, <span class="dt">y =</span> eacc.binned.ne.tb<span class="op">$</span>lat, <span class="dt">z =</span> eacc.binned.ne.tb<span class="op">$</span>v)
v.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> v<span class="op">$</span>xg, <span class="dt">y =</span> v<span class="op">$</span>yg, <span class="dt">data =</span> v<span class="op">$</span>zg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">v =</span> value)

eacc.tb.ne =<span class="st"> </span>u.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(v.tb <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(v)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">coordinates =<span class="st"> </span>eacc.binned.se.vector <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_centroid</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_coordinates</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for
## longitude/latitude data</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eacc.binned.se.tb =<span class="st"> </span>eacc.binned.se.vector
<span class="kw">st_geometry</span>(eacc.binned.se.tb) =<span class="st"> </span><span class="ot">NULL</span>

eacc.binned.se.tb =<span class="st"> </span>coordinates <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(eacc.binned.se.tb) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id)

u =<span class="st"> </span><span class="kw">interpolating_semba</span>(<span class="dt">x =</span> eacc.binned.se.tb<span class="op">$</span>lon, <span class="dt">y =</span> eacc.binned.se.tb<span class="op">$</span>lat, <span class="dt">z =</span> eacc.binned.se.tb<span class="op">$</span>u)
u.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> u<span class="op">$</span>xg, <span class="dt">y =</span> u<span class="op">$</span>yg, <span class="dt">data =</span> u<span class="op">$</span>zg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">u =</span> value)

v =<span class="st"> </span><span class="kw">interpolating_semba</span>(<span class="dt">x =</span> eacc.binned.se.tb<span class="op">$</span>lon, <span class="dt">y =</span> eacc.binned.se.tb<span class="op">$</span>lat, <span class="dt">z =</span> eacc.binned.se.tb<span class="op">$</span>v)
v.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> v<span class="op">$</span>xg, <span class="dt">y =</span> v<span class="op">$</span>yg, <span class="dt">data =</span> v<span class="op">$</span>zg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">v =</span> value)

eacc.tb.se =<span class="st"> </span>u.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(v.tb <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(v)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ne.eacc =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> eacc.tb.ne, 
                          <span class="kw">aes</span>(lon,lat, <span class="dt">z =</span> vel), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_vector</span>(<span class="dt">data =</span> eacc.tb.se, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">dx =</span> u, <span class="dt">dy =</span> v),
                    <span class="dt">arrow.angle =</span> <span class="dv">30</span>, <span class="dt">arrow.length =</span> <span class="fl">.5</span>, <span class="dt">arrow.type =</span> <span class="st">&quot;open&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">38</span>,<span class="dv">42</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">3</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_mag</span>(<span class="dt">max =</span> <span class="fl">1.5</span>)</code></pre>
<pre><code>## Scale for &#39;fill&#39; is already present. Adding another scale for &#39;fill&#39;,
## which will replace the existing scale.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">se.eacc =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> eacc.tb.se, 
                          <span class="kw">aes</span>(lon,lat, <span class="dt">z =</span> vel), 
                          <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_vector</span>(<span class="dt">data =</span> eacc.tb.se, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">dx =</span> u, <span class="dt">dy =</span> v),
                    <span class="dt">arrow.angle =</span> <span class="dv">30</span>, <span class="dt">arrow.length =</span> <span class="fl">.5</span>, <span class="dt">arrow.type =</span> <span class="st">&quot;open&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">38</span>,<span class="dv">42</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">3</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_mag</span>(<span class="dt">max =</span> <span class="fl">1.5</span>)

egg<span class="op">::</span><span class="kw">ggarrange</span>(ne.eacc, se.eacc, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre>
<div class="figure"><span id="fig:current-eacc"></span>
<img src="spatil_r_files/figure-html/current-eacc-1.png" alt="Climatological Near-surface current velocity field of East African Coastal Current for a) Year long, b) Northeast and c) southeast monsoon seasons" width="672" />
<p class="caption">
Figure 11.1: Climatological Near-surface current velocity field of East African Coastal Current for a) Year long, b) Northeast and c) southeast monsoon seasons
</p>
</div>
</div>
<div id="the-somali-current-sc" class="section level3">
<h3><span class="header-section-number">11.4.2</span> The Somali Current (SC)</h3>
<p>The origins of the Somali Current are in the East African Coastal Current, the northern limb of the South Equatorial Current (SEC) (Figure …). According to the <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span> and references therein, the SEC bifurface at around 11°S forming two main branches. The northern branch feeds the East African Coastal Current while the southern branch feeds the Mozambique Current</p>
<pre class="sourceCode r"><code class="sourceCode r">sc =<span class="st"> </span><span class="kw">gridding_semba</span>(<span class="dt">xmin =</span> <span class="dv">40</span>, <span class="dt">xmax =</span> <span class="dv">48</span>, <span class="dt">ymin =</span> <span class="dv">-4</span>, 
                    <span class="dt">ymax =</span> <span class="dv">5</span>, <span class="dt">xg =</span> <span class="dv">20</span>, <span class="dt">yg =</span> <span class="dv">20</span>, 
                    <span class="dt">uz =</span> eacc.sf<span class="op">$</span>u, <span class="dt">vz =</span> eacc.sf<span class="op">$</span>v,
                    <span class="dt">eacc.bins.ne =</span> eacc.sf)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Warning: attribute variables are assumed to be spatially constant
## throughout all geometries</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_contains assumes that they are planar</code></pre>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for
## longitude/latitude data</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">scu =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> sc<span class="op">$</span>lon, <span class="dt">y =</span> sc<span class="op">$</span>lat, <span class="dt">z =</span> sc<span class="op">$</span>uz, <span class="dt">xg =</span> <span class="kw">pretty</span>(sc<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(sc<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
scu.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> scu<span class="op">$</span>xg, <span class="dt">y =</span> scu<span class="op">$</span>yg, <span class="dt">data =</span> scu<span class="op">$</span>zg)

scv =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> sc<span class="op">$</span>lon, <span class="dt">y =</span> sc<span class="op">$</span>lat, <span class="dt">z =</span> sc<span class="op">$</span>vz, <span class="dt">xg =</span> <span class="kw">pretty</span>(sc<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(sc<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
scv.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> scv<span class="op">$</span>xg, <span class="dt">y =</span> scv<span class="op">$</span>yg, <span class="dt">data =</span> scv<span class="op">$</span>zg)

sc.tb =<span class="st"> </span>scu.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">u =</span> value) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_cols</span>(scv.tb <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">v =</span> value)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> sc.tb, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y, <span class="dt">z =</span> vel), 
                          <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_vector</span>(<span class="dt">data =</span> sc.tb, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">dx =</span> u, <span class="dt">dy =</span> v),
                    <span class="dt">arrow.angle =</span> <span class="dv">30</span>, <span class="dt">arrow.length =</span> <span class="fl">.5</span>, <span class="dt">arrow.type =</span> <span class="st">&quot;open&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">40</span>,<span class="fl">47.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">5</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_mag</span>(<span class="dt">max =</span> <span class="fl">1.5</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
<div id="the-mozambique-current-mc" class="section level3">
<h3><span class="header-section-number">11.4.3</span> The Mozambique Current (MC)</h3>
<pre class="sourceCode r"><code class="sourceCode r">mc =<span class="st"> </span><span class="kw">gridding_semba</span>(<span class="dt">xmin =</span> <span class="fl">35.5</span>, <span class="dt">xmax =</span> <span class="dv">45</span>, <span class="dt">ymin =</span> <span class="dv">-18</span>, 
                    <span class="dt">ymax =</span> <span class="dv">-10</span>, <span class="dt">xg =</span> <span class="dv">20</span>, <span class="dt">yg =</span> <span class="dv">20</span>, 
                    <span class="dt">uz =</span> eacc.sf<span class="op">$</span>u, <span class="dt">vz =</span> eacc.sf<span class="op">$</span>v,
                    <span class="dt">eacc.bins.ne =</span> eacc.sf)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Warning: attribute variables are assumed to be spatially constant
## throughout all geometries</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_contains assumes that they are planar</code></pre>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for
## longitude/latitude data</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mcu =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> mc<span class="op">$</span>lon, <span class="dt">y =</span> mc<span class="op">$</span>lat, <span class="dt">z =</span> mc<span class="op">$</span>uz, <span class="dt">xg =</span> <span class="kw">pretty</span>(mc<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(mc<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
mcu.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> mcu<span class="op">$</span>xg, <span class="dt">y =</span> mcu<span class="op">$</span>yg, <span class="dt">data =</span> mcu<span class="op">$</span>zg)

mcv =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> mc<span class="op">$</span>lon, <span class="dt">y =</span> mc<span class="op">$</span>lat, <span class="dt">z =</span> mc<span class="op">$</span>vz, <span class="dt">xg =</span> <span class="kw">pretty</span>(mc<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(mc<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
mcv.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> mcv<span class="op">$</span>xg, <span class="dt">y =</span> mcv<span class="op">$</span>yg, <span class="dt">data =</span> mcv<span class="op">$</span>zg)

mc.tb =<span class="st"> </span>mcu.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">u =</span> value) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_cols</span>(mcv.tb <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">v =</span> value)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> mc.tb, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y, <span class="dt">z =</span> vel), 
                          <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_vector</span>(<span class="dt">data =</span> mc.tb, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">dx =</span> u, <span class="dt">dy =</span> v),
                    <span class="dt">arrow.angle =</span> <span class="dv">30</span>, <span class="dt">arrow.length =</span> <span class="fl">.5</span>, <span class="dt">arrow.type =</span> <span class="st">&quot;open&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">38</span>,<span class="dv">45</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">18</span>,<span class="op">-</span><span class="dv">10</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_mag</span>(<span class="dt">max =</span> <span class="fl">1.5</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-191-1.png" width="672" />
### The South Equatorial Current (SEC)</p>
<pre class="sourceCode r"><code class="sourceCode r">sec =<span class="st"> </span><span class="kw">gridding_semba</span>(<span class="dt">xmin =</span> <span class="dv">38</span>, <span class="dt">xmax =</span> <span class="dv">47</span>, <span class="dt">ymin =</span> <span class="dv">-13</span>, 
                    <span class="dt">ymax =</span> <span class="dv">-8</span>, <span class="dt">xg =</span> <span class="dv">15</span>, <span class="dt">yg =</span> <span class="dv">15</span>, 
                    <span class="dt">uz =</span> eacc.sf<span class="op">$</span>u, <span class="dt">vz =</span> eacc.sf<span class="op">$</span>v,
                    <span class="dt">eacc.bins.ne =</span> eacc.sf)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Warning: attribute variables are assumed to be spatially constant
## throughout all geometries</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_contains assumes that they are planar</code></pre>
<pre><code>## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for
## longitude/latitude data</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">secu =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> sec<span class="op">$</span>lon, <span class="dt">y =</span> sec<span class="op">$</span>lat, <span class="dt">z =</span> sec<span class="op">$</span>uz, <span class="dt">xg =</span> <span class="kw">pretty</span>(sec<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(sec<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
secu.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> secu<span class="op">$</span>xg, <span class="dt">y =</span> secu<span class="op">$</span>yg, <span class="dt">data =</span> secu<span class="op">$</span>zg)

secv =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> sec<span class="op">$</span>lon, <span class="dt">y =</span> sec<span class="op">$</span>lat, <span class="dt">z =</span> sec<span class="op">$</span>vz, <span class="dt">xg =</span> <span class="kw">pretty</span>(sec<span class="op">$</span>lon, <span class="dt">n =</span> <span class="dv">30</span>), <span class="dt">yg =</span> <span class="kw">pretty</span>(sec<span class="op">$</span>lat, <span class="dt">n =</span> <span class="dv">20</span>))
secv.tb =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> secv<span class="op">$</span>xg, <span class="dt">y =</span> secv<span class="op">$</span>yg, <span class="dt">data =</span> secv<span class="op">$</span>zg)

sec.tb =<span class="st"> </span>secu.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">u =</span> value) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_cols</span>(secv.tb <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">v =</span> value)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vel =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>))

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> sec.tb, 
                          <span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y, <span class="dt">z =</span> vel), 
                          <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_vector</span>(<span class="dt">data =</span> sec.tb, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">dx =</span> u, <span class="dt">dy =</span> v),
                    <span class="dt">arrow.angle =</span> <span class="dv">30</span>, <span class="dt">arrow.length =</span> <span class="fl">.5</span>, <span class="dt">arrow.type =</span> <span class="st">&quot;open&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">39</span>,<span class="dv">46</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">12</span>,<span class="op">-</span><span class="dv">9</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_mag</span>(<span class="dt">max =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">11.5</span>,<span class="op">-</span><span class="fl">9.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.5</span>,<span class="dv">46</span>,<span class="dv">2</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
<div id="the-southern-gyre-sg" class="section level3">
<h3><span class="header-section-number">11.4.4</span> The Southern Gyre (SG)</h3>

<p>#Physical and chemical properties of the ocean</p>
<pre class="sourceCode r"><code class="sourceCode r">conflicted<span class="op">::</span><span class="kw">conflict_prefer</span>(<span class="dt">name =</span> <span class="st">&quot;select&quot;</span>, <span class="dt">winner =</span> <span class="st">&quot;dplyr&quot;</span>, <span class="dt">losers =</span> <span class="st">&quot;raster&quot;</span>)</code></pre>
<pre><code>## [conflicted] Removing existing preference</code></pre>
<pre><code>## [conflicted] Will prefer dplyr::select over raster::select</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># conflicted::conflict_prefer(name = &quot;filter&quot;, winner = &quot;dplyr&quot;, losers = &quot;raster&quot;)</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)
<span class="kw">require</span>(sf)
<span class="kw">require</span>(oce)
<span class="kw">require</span>(lubridate)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">woa =<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;e:/MatlabWorking/WOA/WOA09_meridional_sections_every_10_degrees/WOA09_lon_50.5.jos&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )</code></pre>
<p>cross section of temperature at longitude 50.5 within the indian ocean. data from WOA</p>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">ggplot</span>(<span class="dt">data =</span> woa<span class="op">%&gt;%</span><span class="kw">filter</span>(PRES <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span> <span class="op">&amp;</span><span class="st"> </span>Lat <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>), 
         <span class="kw">aes</span>(<span class="dt">x =</span> Lat, <span class="dt">y =</span> PRES)) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="kw">aes</span>(<span class="dt">z =</span> TEMP), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">120</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="kw">aes</span>(<span class="dt">z =</span> TEMP), <span class="dt">binwidth =</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="kw">aes</span>(<span class="dt">z =</span> TEMP), <span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">parse =</span> T, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="dv">150</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">5</span>,<span class="dv">15</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">5</span>,<span class="dv">15</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;Depth (m)&quot;</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">woa.files =<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;e:/MatlabWorking/WOA/WOA09_zonal_sections_every_5_degrees/&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">woa.list =<span class="st"> </span><span class="kw">list</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(woa.files)){
  
  woa.list[[i]] =<span class="st"> </span><span class="kw">read_table2</span>(woa.files[i])
  
}</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )
## Parsed with column specification:
## cols(
##   Section = col_character(),
##   STATION = col_double(),
##   Lat = col_double(),
##   Long = col_double(),
##   PRES = col_double(),
##   TEMP = col_double(),
##   SALT = col_double(),
##   O2 = col_double(),
##   SIO3 = col_double(),
##   NO3 = col_double(),
##   PO4 = col_double()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">woa.tb =<span class="st"> </span>woa.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">Lon =</span> Long)

<span class="kw">colnames</span>(woa.tb) =<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">colnames</span>(woa.tb))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
</div>
</div>
<div id="physical" class="section level2">
<h2><span class="header-section-number">11.5</span> Physical</h2>
<pre class="sourceCode r"><code class="sourceCode r">world =<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;e:/GIS/Tanzania spatial data Bank/World/World Countries and continents/Continents.shp&quot;</span>)</code></pre>
<div id="temperature" class="section level3">
<h3><span class="header-section-number">11.5.1</span> Temperature</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> temp), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">Temperature</span>(<span class="op">~</span>degree<span class="op">*</span>C)),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
</div>
</div>
<div id="salinity" class="section level2">
<h2><span class="header-section-number">11.6</span> Salinity</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> salt), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
       <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="st">&quot;Salinity&quot;</span>,
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
<div id="chemical" class="section level2">
<h2><span class="header-section-number">11.7</span> Chemical</h2>
<div id="dissolved-oxygen" class="section level3">
<h3><span class="header-section-number">11.7.1</span> Dissolved oxygen</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> o2), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Dissolved<span class="op">~</span><span class="kw">Oxygen</span>(mlL<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
</div>
<div id="nitrate" class="section level3">
<h3><span class="header-section-number">11.7.2</span> Nitrate</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> no3), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Nitrate<span class="op">~</span><span class="kw">concentration</span>(<span class="op">~</span>mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
<div id="phosphate" class="section level3">
<h3><span class="header-section-number">11.7.3</span> Phosphate</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> po4), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Phosphate<span class="op">~</span><span class="kw">concentration</span>(<span class="op">~</span>mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
</div>
<div id="silica" class="section level3">
<h3><span class="header-section-number">11.7.4</span> Silica</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pres <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> sio3), <span class="dt">na.fill =</span> T, <span class="dt">bins =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey30&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>,<span class="dv">30</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>), <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">135</span>,<span class="dv">135</span>,<span class="dv">45</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Silca<span class="op">~</span><span class="kw">concentration</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(<span class="dv">14</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<p>cross-section of temperature at longitude 55.5°E in the Indian Ocean. The diagram show several water masses formed at diffrent latitudes. The data was obtained from WOA09</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## cross section of temperature at longitude 45.5 in the indian ocean</span>

woa.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lon <span class="op">==</span><span class="st"> </span><span class="fl">55.5</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-55</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span> <span class="op">&amp;</span><span class="st"> </span>pres <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lat, <span class="dt">y =</span> pres, <span class="dt">z =</span> temp), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lat, <span class="dt">y =</span> pres, <span class="dt">z =</span> temp), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lat, <span class="dt">y =</span> pres, <span class="dt">z =</span> temp), <span class="dt">skip =</span> <span class="dv">1</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>, <span class="dt">check_overlap =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9B</span>(<span class="dv">120</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">200</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>,
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">70</span>,<span class="dv">30</span>,<span class="dv">10</span>),<span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">70</span>,<span class="dv">30</span>,<span class="dv">10</span>)))<span class="op">+</span>
<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
       <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="ot">NA</span>),
       <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,
       <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
       <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
       <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))<span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;Pressure [dba]&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">48</span>, <span class="dv">14</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">900</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
</div>
</div>
<div id="wind-1" class="section level2">
<h2><span class="header-section-number">11.8</span> wind</h2>
</div>
<div id="bagamoyo-ctd" class="section level2">
<h2><span class="header-section-number">11.9</span> Bagamoyo ctd</h2>
<pre class="sourceCode r"><code class="sourceCode r">locations =<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="st">&quot;e:/Data Manipulation/ctd_bagamoyo/Coordinates.xlsx&quot;</span>)

<span class="co"># remove empty rows and change to decimal minutes</span>
locations =<span class="st"> </span>locations <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Long)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(Lat, <span class="kw">c</span>(<span class="st">&quot;latd&quot;</span>, <span class="st">&quot;latmi&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(latd, <span class="st">&quot;lat&quot;</span>, <span class="dt">sep =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(Long, <span class="kw">c</span>(<span class="st">&quot;lond&quot;</span>, <span class="st">&quot;lonmi&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(lond, <span class="st">&quot;lon&quot;</span>, <span class="dt">sep =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Latitude =</span> <span class="dv">-1</span><span class="op">*</span>(lat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()<span class="op">+</span>latmi <span class="op">%&gt;%</span><span class="kw">as.numeric</span>()<span class="op">/</span><span class="dv">60</span>),
         <span class="dt">Longitude =</span> lon <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()<span class="op">+</span>lonmi <span class="op">%&gt;%</span><span class="kw">as.numeric</span>()<span class="op">/</span><span class="dv">60</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">station =</span> <span class="dv">1</span>, <span class="dt">lon =</span> Longitude, <span class="dt">lat =</span> Latitude)

locations.sf =<span class="st"> </span>locations <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_set_crs</span>(<span class="dv">4326</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> locations.sf, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_sf</span>( <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.95</span>, <span class="dv">40</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">6.5</span>, <span class="fl">-6.35</span>))<span class="op">+</span>
<span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> locations, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> station))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
<div id="ctd" class="section level2">
<h2><span class="header-section-number">11.10</span> CTD</h2>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">require</span>(oce)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">files =<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;e:/Data Manipulation/ctd_bongo2017/Converted Data/&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;.cnv&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ctd.list =<span class="st"> </span><span class="kw">list</span>()

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">129</span>){
  ctd =<span class="st"> </span><span class="kw">read.ctd</span>(files[i]) <span class="op">%&gt;%</span><span class="kw">ctdTrim</span>(<span class="dt">method =</span> <span class="st">&quot;downcast&quot;</span>) <span class="op">%&gt;%</span><span class="kw">ctdDecimate</span>(<span class="dt">p =</span> <span class="dv">5</span>)

  ctd.list[[i]] =<span class="st"> </span>ctd<span class="op">@</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">lat =</span> ctd<span class="op">@</span>metadata<span class="op">$</span>latitude,
           <span class="dt">lon =</span> ctd<span class="op">@</span>metadata<span class="op">$</span>longitude,
           <span class="dt">time =</span> ctd<span class="op">@</span>metadata<span class="op">$</span>startTime,
           <span class="dt">station =</span> ctd<span class="op">@</span>metadata<span class="op">$</span>station, <span class="dt">id =</span> i) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, time, lat, lon,station, pressure, depth, temperature, salinity, 
         oxygen, conductivity, fluorescence, <span class="dt">turbidity =</span> turbidity2)
  
  
}

ctd.tb =<span class="st"> </span>ctd.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">world =<span class="st"> </span>spData<span class="op">::</span>world
moz =<span class="st"> </span>world <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_crop</span>(<span class="dt">xmin =</span> <span class="dv">34</span>, <span class="dt">xmax =</span> <span class="dv">43</span> , <span class="dt">ymin =</span> <span class="dv">-22</span> , <span class="dt">ymax =</span> <span class="dv">-15</span>)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersection assumes that they are planar</code></pre>
<pre><code>## Warning: attribute variables are assumed to be spatially constant
## throughout all geometries</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ctd.cast =<span class="st"> </span>ctd.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure<span class="op">==</span><span class="dv">5</span><span class="op">&amp;</span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-16</span>)

<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="kw">geom_point</span>(<span class="dt">data =</span> ctd.cast,<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_equal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> moz)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">34.8</span>,<span class="dv">41</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">21.5</span>,<span class="op">-</span><span class="fl">16.0</span>))<span class="op">+</span>
<span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> ctd.cast <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_frac</span>(.<span class="dv">25</span>),<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> id))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">35</span>,<span class="dv">41</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">21</span>,<span class="op">-</span><span class="dv">16</span>,<span class="dv">1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<pre><code>## Coordinate system already present. Adding new coordinate system, which will replace the existing one.</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;e:/Data Manipulation/semba_functions.R&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">surface =<span class="st"> </span>ctd.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-16</span> <span class="op">&amp;</span><span class="st"> </span>pressure <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)

variables =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;temperature&quot;</span>, <span class="st">&quot;salinity&quot;</span>, <span class="st">&quot;oxygen&quot;</span>, <span class="st">&quot;conductivity&quot;</span>, <span class="st">&quot;fluorescence&quot;</span>, <span class="st">&quot;turbidity&quot;</span>)
Lon =<span class="st"> </span>surface<span class="op">$</span>lon
Lat =<span class="st"> </span>surface<span class="op">$</span>lat
df =<span class="st"> </span>surface <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">8</span><span class="op">:</span><span class="dv">13</span>)


surface.list =<span class="st"> </span><span class="kw">list</span>()

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(df)){
  
surface.interp =<span class="st"> </span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> Lon, <span class="dt">y =</span> Lat, <span class="dt">z =</span> df[[i]])

surface.list[[i]] =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> surface.interp<span class="op">$</span>xg, <span class="dt">y =</span> surface.interp<span class="op">$</span>yg, <span class="dt">data =</span> surface.interp<span class="op">$</span>zg)  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">variable =</span> variables[[i]])
}

surface.tb =<span class="st"> </span>surface.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"> temperature =<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;temperature&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">bins =</span> <span class="dv">120</span>, <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;temperature&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value))<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;temperature&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value),
             <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> moz)<span class="op">+</span>
<span class="st">   </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">35.4</span>,<span class="fl">40.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">21.1</span>,<span class="op">-</span><span class="fl">16.1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">35.8</span>,<span class="fl">39.8</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">20.5</span>,<span class="op">-</span><span class="fl">16.5</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)


 fluorescence =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;fluorescence&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">bins =</span> <span class="dv">120</span>, <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;fluorescence&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value))<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;fluorescence&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value),
             <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> moz)<span class="op">+</span>
<span class="st">   </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">35.4</span>,<span class="fl">40.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">21.1</span>,<span class="op">-</span><span class="fl">16.1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">35.8</span>,<span class="fl">39.8</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">20.5</span>,<span class="op">-</span><span class="fl">16.5</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)
   
 
oxygen =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;oxygen&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">bins =</span> <span class="dv">120</span>, <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;oxygen&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value))<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;oxygen&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value),
             <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> moz)<span class="op">+</span>
<span class="st">   </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">35.4</span>,<span class="fl">40.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">21.1</span>,<span class="op">-</span><span class="fl">16.1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">35.8</span>,<span class="fl">39.8</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">20.5</span>,<span class="op">-</span><span class="fl">16.5</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)
 
 
  salinity =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;salinity&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">bins =</span> <span class="dv">120</span>, <span class="dt">na.fill =</span> <span class="ot">TRUE</span>)<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;salinity&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value))<span class="op">+</span>
<span class="st">   </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> surface.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;salinity&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value),
             <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> moz)<span class="op">+</span>
<span class="st">   </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">35.4</span>,<span class="fl">40.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">21.1</span>,<span class="op">-</span><span class="fl">16.1</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">   </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">oce.colorsJet</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">35.8</span>,<span class="fl">39.8</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">20.5</span>,<span class="op">-</span><span class="fl">16.5</span>))<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)
  
  egg<span class="op">::</span><span class="kw">ggarrange</span>(temperature, oxygen, salinity, fluorescence, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">ctd.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(id <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> pressure))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="kw">aes</span>(<span class="dt">z =</span> fluorescence), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">120</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># metR::geom_contour2(aes(z = turbidity), na.fill = TRUE) +</span>
<span class="st">  </span><span class="co"># metR::geom_text_contour(aes(z = turbidity), na.fill = TRUE, check_overlap = TRUE, size = 3.5, parse = TRUE) +</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">35.88</span>, <span class="fl">36.06</span>, <span class="dt">length.out =</span> <span class="dv">4</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">35.88</span>, <span class="fl">36.06</span>, <span class="dt">length.out =</span> <span class="dv">4</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">400</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Pressure [m]&quot;</span>)</code></pre>
<pre><code>## Warning: imputing missing values</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-schott">
<p>Friedrich, Schott, and McCreary Julian. 2001. “The Monsoon Circulation of the Indian Ocean.” Journal Article. <em>Progress in Oceanography 51 (2001) 1–123</em> 51: 1–123.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="monsoon-circulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ocean-productivity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
