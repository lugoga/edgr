<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Plotting in R with ggplot2 | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Plotting in R with ggplot2 | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Plotting in R with ggplot2 | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2019-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="raster.html">
<link rel="next" href="a-grammar-for-graphics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.6/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/Dygraph.Plugins.Unzoom-1.0/unzoom.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i>Sources</a></li>
<li class="chapter" data-level="" data-path="note-to-the-reader.html"><a href="note-to-the-reader.html"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-learn-computer-programming"><i class="fa fa-check"></i><b>1.1</b> Why learn computer Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r-1"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-features-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Features of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
<li class="chapter" data-level="1.3.9" data-path="intro.html"><a href="intro.html#getting-help-in-r"><i class="fa fa-check"></i><b>1.3.9</b> Getting Help in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-started.html"><a href="get-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="get-started.html"><a href="get-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-started.html"><a href="get-started.html#r-operators"><i class="fa fa-check"></i><b>2.1.1</b> R operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-started.html"><a href="get-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-started.html"><a href="get-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-started.html"><a href="get-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-started.html"><a href="get-started.html#naming-conventions"><i class="fa fa-check"></i><b>2.2.2</b> Naming conventions</a></li>
<li class="chapter" data-level="2.2.3" data-path="get-started.html"><a href="get-started.html#functions"><i class="fa fa-check"></i><b>2.2.3</b> Functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="get-started.html"><a href="get-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-started.html"><a href="get-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="get-started.html"><a href="get-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-started.html"><a href="get-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-started.html"><a href="get-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="get-started.html"><a href="get-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="get-started.html"><a href="get-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="get-started.html"><a href="get-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="get-started.html"><a href="get-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="get-started.html"><a href="get-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="get-started.html"><a href="get-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="get-started.html"><a href="get-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="get-started.html"><a href="get-started.html#tibbles"><i class="fa fa-check"></i><b>2.7</b> tibbles</a><ul>
<li class="chapter" data-level="2.7.1" data-path="get-started.html"><a href="get-started.html#column-names"><i class="fa fa-check"></i><b>2.7.1</b> Column Names</a></li>
<li class="chapter" data-level="2.7.2" data-path="get-started.html"><a href="get-started.html#add-rows-and-columns"><i class="fa fa-check"></i><b>2.7.2</b> Add rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="get-started.html"><a href="get-started.html#exercise"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
<li class="chapter" data-level="2.9" data-path="get-started.html"><a href="get-started.html#exercise-1"><i class="fa fa-check"></i><b>2.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html"><i class="fa fa-check"></i><b>3</b> Get familiar with R Markdown</a><ul>
<li class="chapter" data-level="3.1" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#r-markdown"><i class="fa fa-check"></i><b>3.1</b> R Markdown</a></li>
<li class="chapter" data-level="3.2" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#text-formating"><i class="fa fa-check"></i><b>3.2</b> Text Formating</a></li>
<li class="chapter" data-level="3.3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#hyperlinks"><i class="fa fa-check"></i><b>3.3</b> Hyperlinks</a></li>
<li class="chapter" data-level="3.4" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#images"><i class="fa fa-check"></i><b>3.4</b> Images</a></li>
<li class="chapter" data-level="3.5" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#tables"><i class="fa fa-check"></i><b>3.5</b> Tables</a></li>
<li class="chapter" data-level="3.6" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#cross-referencing"><i class="fa fa-check"></i><b>3.6</b> Cross-referencing</a></li>
<li class="chapter" data-level="3.7" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#bibliographies"><i class="fa fa-check"></i><b>3.7</b> Bibliographies</a></li>
<li class="chapter" data-level="3.8" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#create-.rmd-file"><i class="fa fa-check"></i><b>3.8</b> Create .Rmd FIle</a></li>
<li class="chapter" data-level="3.9" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#rendering-markdown"><i class="fa fa-check"></i><b>3.9</b> Rendering Markdown</a></li>
<li class="chapter" data-level="3.10" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#structure-of-an-rmarkdown-file"><i class="fa fa-check"></i><b>3.10</b> Structure of an Rmarkdown FIle</a></li>
<li class="chapter" data-level="3.11" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inserting-code-chunk"><i class="fa fa-check"></i><b>3.11</b> Inserting code chunk</a></li>
<li class="chapter" data-level="3.12" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-name"><i class="fa fa-check"></i><b>3.12</b> Chunk name</a></li>
<li class="chapter" data-level="3.13" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-options"><i class="fa fa-check"></i><b>3.13</b> Chunk options</a></li>
<li class="chapter" data-level="3.14" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inline-code"><i class="fa fa-check"></i><b>3.14</b> Inline code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>4</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="4.0.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types-1"><i class="fa fa-check"></i><b>4.0.1</b> Data Types</a></li>
<li class="chapter" data-level="4.0.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors-1"><i class="fa fa-check"></i><b>4.0.2</b> Vectors</a></li>
<li class="chapter" data-level="4.0.3" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element-1"><i class="fa fa-check"></i><b>4.0.3</b> Indexing the element</a></li>
<li class="chapter" data-level="4.0.4" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="4.0.5" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.5</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="4.0.6" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>4.0.6</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="4.0.7" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>4.0.7</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="4.0.8" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>4.0.8</b> Rounding off numbers</a></li>
<li class="chapter" data-level="4.1" data-path="dataTypes.html"><a href="dataTypes.html#data-frame-1"><i class="fa fa-check"></i><b>4.1</b> Data Frame</a><ul>
<li class="chapter" data-level="4.1.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>4.1.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>4.2</b> Matrix</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>4.2.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>4.2.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>4.3</b> Arrays</a></li>
<li class="chapter" data-level="4.4" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>4.4</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>5</b> Vector Data</a><ul>
<li class="chapter" data-level="5.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="vector.html"><a href="vector.html#numeric-vector"><i class="fa fa-check"></i><b>5.2</b> Numeric Vector</a></li>
<li class="chapter" data-level="5.3" data-path="vector.html"><a href="vector.html#integer-vector"><i class="fa fa-check"></i><b>5.3</b> Integer vector</a></li>
<li class="chapter" data-level="5.4" data-path="vector.html"><a href="vector.html#character-vector"><i class="fa fa-check"></i><b>5.4</b> Character vector</a></li>
<li class="chapter" data-level="5.5" data-path="vector.html"><a href="vector.html#logical-vector"><i class="fa fa-check"></i><b>5.5</b> Logical Vector</a></li>
<li class="chapter" data-level="5.6" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>5.6</b> Vector Data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>5.6.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>5.7</b> Reading vector data</a><ul>
<li class="chapter" data-level="5.7.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>5.7.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="5.7.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>5.7.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>5.8</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="5.9" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>5.9</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Introduction to tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>6.1</b> readr</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>6.2</b> dplyr</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#tidyr"><i class="fa fa-check"></i><b>6.3</b> tidyr</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#ggplot2"><i class="fa fa-check"></i><b>6.4</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>7</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="7.1" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>7.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="7.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>7.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="7.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>7.3</b> Writing t a File</a></li>
<li class="chapter" data-level="7.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>7.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="7.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>7.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="7.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>7.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>8</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="8.1" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>8.1</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="8.2" data-path="tidy.html"><a href="tidy.html#spread-from-long-to-wide-format"><i class="fa fa-check"></i><b>8.2</b> spread() —from long to wide format</a></li>
<li class="chapter" data-level="8.3" data-path="tidy.html"><a href="tidy.html#separate"><i class="fa fa-check"></i><b>8.3</b> separate()</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>9</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="9.1" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>9.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="9.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>9.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="9.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>9.3</b> Data</a></li>
<li class="chapter" data-level="9.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>9.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="9.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>9.5</b> select</a><ul>
<li class="chapter" data-level="9.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>9.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="9.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>9.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>9.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html"><i class="fa fa-check"></i><b>10</b> Working with Dates and Time</a><ul>
<li class="chapter" data-level="10.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#getting-the-date-and-time-with-localtime"><i class="fa fa-check"></i><b>10.1</b> Getting the Date and Time with localtime</a></li>
<li class="chapter" data-level="10.2" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-strings-to-dates"><i class="fa fa-check"></i><b>10.2</b> Converting strings to Dates</a><ul>
<li class="chapter" data-level="10.2.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#convert-strings-to-dates"><i class="fa fa-check"></i><b>10.2.1</b> convert strings to dates</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-date-with-lubridate-package"><i class="fa fa-check"></i><b>10.3</b> Converting date with <strong>lubridate</strong> package</a></li>
<li class="chapter" data-level="10.4" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#create-dates-by-merging-data"><i class="fa fa-check"></i><b>10.4</b> Create Dates by Merging Data</a></li>
<li class="chapter" data-level="10.5" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#isodate-converts-to-a-posixct-object"><i class="fa fa-check"></i><b>10.5</b> ISOdate converts to a POSIXct object</a></li>
<li class="chapter" data-level="10.6" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#extract-and-manipulate-parts-of-dates"><i class="fa fa-check"></i><b>10.6</b> Extract and Manipulate Parts of Dates</a></li>
<li class="chapter" data-level="10.7" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#creating-date-sequences"><i class="fa fa-check"></i><b>10.7</b> Creating Date Sequences</a></li>
<li class="chapter" data-level="10.8" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#calculations-with-dates"><i class="fa fa-check"></i><b>10.8</b> Calculations with Dates</a></li>
<li class="chapter" data-level="10.9" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-difference-of-15-days"><i class="fa fa-check"></i><b>10.9</b> Time difference of 15 days</a></li>
<li class="chapter" data-level="10.10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#example-with-time-zones"><i class="fa fa-check"></i><b>10.10</b> example with time zones</a></li>
<li class="chapter" data-level="10.11" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-interval"><i class="fa fa-check"></i><b>10.11</b> Time Interval</a></li>
<li class="chapter" data-level="10.12" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#ctd-list"><i class="fa fa-check"></i><b>10.12</b> ctd list</a></li>
<li class="chapter" data-level="10.13" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#arithmetic-with-date-times"><i class="fa fa-check"></i><b>10.13</b> Arithmetic with date times</a></li>
<li class="chapter" data-level="10.14" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#dealing-with-time-zones"><i class="fa fa-check"></i><b>10.14</b> Dealing with Time Zones</a></li>
<li class="chapter" data-level="10.15" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#case-study-working-with-date-and-time-of-argo-float-observations"><i class="fa fa-check"></i><b>10.15</b> Case study: Working with Date and Time of Argo float observations</a></li>
<li class="chapter" data-level="10.16" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-1"><i class="fa fa-check"></i><b>10.16</b> Data</a></li>
<li class="chapter" data-level="10.17" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-processing"><i class="fa fa-check"></i><b>10.17</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>11</b> Control flow</a><ul>
<li class="chapter" data-level="11.1" data-path="control-flow.html"><a href="control-flow.html#for-loop"><i class="fa fa-check"></i><b>11.1</b> for loop</a><ul>
<li class="chapter" data-level="11.1.1" data-path="control-flow.html"><a href="control-flow.html#for-loop-on-array"><i class="fa fa-check"></i><b>11.1.1</b> For loop on array</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="control-flow.html"><a href="control-flow.html#if-and-else-statement"><i class="fa fa-check"></i><b>11.2</b> if and else statement</a></li>
<li class="chapter" data-level="11.3" data-path="control-flow.html"><a href="control-flow.html#functions-1"><i class="fa fa-check"></i><b>11.3</b> Functions</a><ul>
<li class="chapter" data-level="11.3.1" data-path="control-flow.html"><a href="control-flow.html#core-functions"><i class="fa fa-check"></i><b>11.3.1</b> core functions</a></li>
<li class="chapter" data-level="11.3.2" data-path="control-flow.html"><a href="control-flow.html#user-defined-functions"><i class="fa fa-check"></i><b>11.3.2</b> user defined functions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="control-flow.html"><a href="control-flow.html#packages"><i class="fa fa-check"></i><b>11.4</b> packages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functions-and-packages.html"><a href="functions-and-packages.html"><i class="fa fa-check"></i><b>12</b> Functions and packages</a><ul>
<li class="chapter" data-level="12.0.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#core-functions-1"><i class="fa fa-check"></i><b>12.0.1</b> core functions</a></li>
<li class="chapter" data-level="12.0.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#user-defined-functions-1"><i class="fa fa-check"></i><b>12.0.2</b> user defined functions</a></li>
<li class="chapter" data-level="12.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#packages-1"><i class="fa fa-check"></i><b>12.1</b> packages</a></li>
<li class="chapter" data-level="12.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#function-pipelines"><i class="fa fa-check"></i><b>12.2</b> function pipelines</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>13</b> Raster Data</a><ul>
<li class="chapter" data-level="13.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>13.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>13.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="13.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>13.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="13.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>13.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="13.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>13.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="13.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>13.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>13.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="13.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>13.3</b> Raster resolution</a></li>
<li class="chapter" data-level="13.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>13.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="13.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>13.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="13.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>13.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>13.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="13.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>13.7</b> Raster time series data</a></li>
<li class="chapter" data-level="13.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>13.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>14</b> Plotting in R with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="14.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>14.1</b> A dataset</a></li>
<li class="chapter" data-level="14.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>14.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="14.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>14.3</b> Building a plot</a><ul>
<li class="chapter" data-level="14.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>14.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="14.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>14.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="14.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>14.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>14.4</b> Customize glidline and axis labels</a><ul>
<li class="chapter" data-level="14.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>14.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>14.5</b> Modify the position of the legend</a><ul>
<li class="chapter" data-level="14.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>14.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="14.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>14.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="14.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>14.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="14.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>14.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="14.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>14.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="14.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>14.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="14.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>14.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="14.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>14.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="14.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>14.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="14.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>14.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>14.6</b> Basic plots</a><ul>
<li class="chapter" data-level="14.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>14.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="14.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>14.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>14.7</b> Linegraph</a><ul>
<li class="chapter" data-level="14.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>14.7.1</b> histogram</a></li>
<li class="chapter" data-level="14.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>14.7.2</b> boxplot</a></li>
<li class="chapter" data-level="14.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>14.7.3</b> barplot</a></li>
<li class="chapter" data-level="14.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>14.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>14.8</b> Advanced plots</a><ul>
<li class="chapter" data-level="14.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>14.8.1</b> Facets</a></li>
<li class="chapter" data-level="14.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>14.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="14.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>14.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>14.9</b> Colour</a></li>
<li class="chapter" data-level="14.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>14.10</b> size</a></li>
<li class="chapter" data-level="14.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>14.11</b> scaling</a></li>
<li class="chapter" data-level="14.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>14.12</b> Guides</a></li>
<li class="chapter" data-level="14.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>14.13</b> Add-on packages</a></li>
<li class="chapter" data-level="14.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>14.14</b> ggridges</a></li>
<li class="chapter" data-level="14.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>14.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="14.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>14.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>15</b> A grammar for graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>15.1</b> geoms</a><ul>
<li class="chapter" data-level="15.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>15.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="15.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>15.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>15.2</b> aes()</a><ul>
<li class="chapter" data-level="15.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>15.2.1</b> Color</a></li>
<li class="chapter" data-level="15.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>15.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>15.3</b> Axis and labels</a></li>
<li class="chapter" data-level="15.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>15.4</b> Text annotaion</a></li>
<li class="chapter" data-level="15.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>15.5</b> Scales</a></li>
<li class="chapter" data-level="15.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>15.6</b> Guides</a></li>
<li class="chapter" data-level="15.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>15.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>16</b> Making Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="graphics.html"><a href="graphics.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>16.1</b> Geographical data in a tidy format</a><ul>
<li class="chapter" data-level="16.1.1" data-path="graphics.html"><a href="graphics.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>16.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="16.1.2" data-path="graphics.html"><a href="graphics.html#importing-shapefile"><i class="fa fa-check"></i><b>16.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="16.1.3" data-path="graphics.html"><a href="graphics.html#reading-other-format"><i class="fa fa-check"></i><b>16.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>16.3</b> Static Maps</a><ul>
<li class="chapter" data-level="16.3.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>16.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="graphics.html"><a href="graphics.html#basemap"><i class="fa fa-check"></i><b>16.4</b> Basemap</a></li>
<li class="chapter" data-level="16.5" data-path="graphics.html"><a href="graphics.html#creating-contour-map"><i class="fa fa-check"></i><b>16.5</b> Creating contour map</a></li>
<li class="chapter" data-level="16.6" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>16.6</b> Inset maps</a><ul>
<li class="chapter" data-level="16.6.1" data-path="graphics.html"><a href="graphics.html#choropleth-maps"><i class="fa fa-check"></i><b>16.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>16.7</b> Animated maps</a></li>
<li class="chapter" data-level="16.8" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>16.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="animation.html"><a href="animation.html"><i class="fa fa-check"></i><b>17</b> Animation</a><ul>
<li class="chapter" data-level="17.1" data-path="animation.html"><a href="animation.html#animation-1"><i class="fa fa-check"></i><b>17.1</b> Animation</a></li>
<li class="chapter" data-level="17.2" data-path="animation.html"><a href="animation.html#isosurface"><i class="fa fa-check"></i><b>17.2</b> isosurface</a></li>
<li class="chapter" data-level="17.3" data-path="animation.html"><a href="animation.html#checking-for-proper-interpolation-methods"><i class="fa fa-check"></i><b>17.3</b> checking for proper interpolation methods</a><ul>
<li class="chapter" data-level="17.3.1" data-path="animation.html"><a href="animation.html#fluorescence-section"><i class="fa fa-check"></i><b>17.3.1</b> Fluorescence section</a></li>
<li class="chapter" data-level="17.3.2" data-path="animation.html"><a href="animation.html#temperature-section"><i class="fa fa-check"></i><b>17.3.2</b> Temperature section</a></li>
<li class="chapter" data-level="17.3.3" data-path="animation.html"><a href="animation.html#dissolved-oxygen-section"><i class="fa fa-check"></i><b>17.3.3</b> Dissolved Oxygen section</a></li>
<li class="chapter" data-level="17.3.4" data-path="animation.html"><a href="animation.html#salinity-section"><i class="fa fa-check"></i><b>17.3.4</b> Salinity section</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="forecast-time-series.html"><a href="forecast-time-series.html"><i class="fa fa-check"></i><b>18</b> Forecast time series</a><ul>
<li class="chapter" data-level="18.1" data-path="forecast-time-series.html"><a href="forecast-time-series.html#introduction-2"><i class="fa fa-check"></i><b>18.1</b> introduction</a></li>
<li class="chapter" data-level="18.2" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-2"><i class="fa fa-check"></i><b>18.2</b> Data</a></li>
<li class="chapter" data-level="18.3" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-processing-1"><i class="fa fa-check"></i><b>18.3</b> Data processing</a></li>
<li class="chapter" data-level="18.4" data-path="forecast-time-series.html"><a href="forecast-time-series.html#forecasting"><i class="fa fa-check"></i><b>18.4</b> Forecasting</a></li>
<li class="chapter" data-level="18.5" data-path="forecast-time-series.html"><a href="forecast-time-series.html#visualize-the-forecasted-values"><i class="fa fa-check"></i><b>18.5</b> Visualize the forecasted values</a></li>
<li class="chapter" data-level="18.6" data-path="forecast-time-series.html"><a href="forecast-time-series.html#conclusion"><i class="fa fa-check"></i><b>18.6</b> conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="reading-netcdf.html"><a href="reading-netcdf.html"><i class="fa fa-check"></i><b>19</b> Reading NetCDF</a><ul>
<li class="chapter" data-level="19.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#introduction-3"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#types-of-netcdf-file"><i class="fa fa-check"></i><b>19.2</b> Types of netCDF file</a></li>
<li class="chapter" data-level="19.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#rading-netcdf-with-ncdf4-package"><i class="fa fa-check"></i><b>19.3</b> Rading NetCDF with ncdf4 package</a><ul>
<li class="chapter" data-level="19.3.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-dimensions"><i class="fa fa-check"></i><b>19.3.1</b> Extracting the dimensions</a></li>
<li class="chapter" data-level="19.3.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-time"><i class="fa fa-check"></i><b>19.3.2</b> Extracting time</a></li>
<li class="chapter" data-level="19.3.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-latitude"><i class="fa fa-check"></i><b>19.3.3</b> Extracting Latitude</a></li>
<li class="chapter" data-level="19.3.4" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-longitude"><i class="fa fa-check"></i><b>19.3.4</b> Extracting Longitude</a></li>
<li class="chapter" data-level="19.3.5" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-variable"><i class="fa fa-check"></i><b>19.3.5</b> Extracting the variable</a></li>
<li class="chapter" data-level="19.3.6" data-path="reading-netcdf.html"><a href="reading-netcdf.html#replace-fillvalue-with-na"><i class="fa fa-check"></i><b>19.3.6</b> Replace FillValue with NA</a></li>
<li class="chapter" data-level="19.3.7" data-path="reading-netcdf.html"><a href="reading-netcdf.html#obtain-a-slice"><i class="fa fa-check"></i><b>19.3.7</b> Obtain a slice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="packages-2.html"><a href="packages-2.html"><i class="fa fa-check"></i><b>20</b> packages</a><ul>
<li class="chapter" data-level="20.1" data-path="packages-2.html"><a href="packages-2.html#one-sample-t-test"><i class="fa fa-check"></i><b>20.1</b> One Sample t Test</a></li>
<li class="chapter" data-level="20.2" data-path="packages-2.html"><a href="packages-2.html#paired-t-test"><i class="fa fa-check"></i><b>20.2</b> Paired t test</a></li>
<li class="chapter" data-level="20.3" data-path="packages-2.html"><a href="packages-2.html#levenes-test"><i class="fa fa-check"></i><b>20.3</b> Levene’s Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-in-r-with-ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Plotting in R with <code>ggplot2</code></h1>
<p>The ability to create visualizations—graphical representations of data is an important step to convery your results—information and findings to others. In this chapter, we illustrate how you can use visualize your data and create elegant graphics. One of things that makes R such a great tools is it’s data visualization capabilities. R has many systems for visualization and creating plots, some of which are—base R graphics, <strong>lattice</strong> and <strong>ggplot2</strong>, but we focus on the use of <strong>ggplot2</strong>. The <strong>ggplot2</strong> package is a phenomenal tool for creating graphics in R. It provide a unifying framework—a <em>grammar of graphics</em> for describing and building graphs.</p>
<p>Just as the <em>grammar of language</em> helps you construct meaningful sentences out of words, the <em>Grammar of Graphics</em> helps you construct graphicss out of different visual elements. This grammar provides a way to talk about parts of a visual plot: all the circles, lines, arrows, and text that are combined into a diagram for visualizing data. Originally developed by Leland Wilkinson, the Grammar of Graphics was adapted by Hadley Wickham <span class="citation">(<a href="#ref-ggplot">2016</a>)</span> to describe the components of a plot</p>
<p>The <strong>ggplot2</strong> package provides a powerful and flexible approach to data visualization, and its is suitable both for rapdi exploration of different visualization approaches and for producing carefully crafted publication–quality figures. However, getting ggplot2 to make figures that look exactly the way you want them to, can sometimes be challenging and beginners and expert alike can get consufed by themes, scales, coords, guides or facets. <strong>ggplot2</strong> further organizes these components into layers, where each layer displays a single type of (highly configurable) geometric object.</p>
<p>Even the most experienced R users need to refer to <strong>ggplot2</strong> Cheat Sheet while creating elegant graphics, we will demonstrate step–by–step how to get the most out of <strong>ggplot2</strong> package, including how to choose and customize scales, how to theme plots, and when to use add-in packages that extend the <strong>ggplot2</strong> capabilities. Some of the extension of <strong>gggplot2</strong> that we will introuduce to your include <strong>ggspatial</strong>, <strong>metR</strong>, <strong>ggrepel</strong>, <strong>cowplot</strong>, etc. Rather than loading these extension packages with <code>require()</code> function, we’ll call their functions using the <code>::</code> notation. This will help make it clear which funcions are built into <strong>ggplot2</strong>, and which comes from extensions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)
<span class="kw">require</span>(magrittr)</code></pre>
<p>load addition functions</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;e:/Data Manipulation/semba_functions.R&quot;</span>)</code></pre>
<div id="a-dataset" class="section level2">
<h2><span class="header-section-number">14.1</span> A dataset</h2>
<p>We’re using a CTD profile data along the coastal water of Tanzania collected in August 2004 with Algoa. I have processed and cleaned the profile data from a CTD instrument, and created a very basic and simple dataset for us to start with. I have tidy the data into a data frame and it contains 10 variables collected at 22 stations (Table <a href="plotting-in-r-with-ggplot2.html#tab:tabE01">14.1</a>). These variables include the <code>time</code>, <code>longitude</code> and <code>latitude</code> coordinates and the <code>name</code> at each station. It also contains the measured profile of <code>temperature</code>, <code>salinity</code>, <code>oxygen</code>, and <code>fluorescence</code>, <code>spar</code>, <code>par</code> and <code>density</code> as function of <code>pressure.</code></p>
<table>
<caption>
<span id="tab:tabE01">Table 14.1: </span>A sample of CTD profile dataset. For visibility of all the 22 stations, only variables measured at 5 meter standard depth are shown
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cast Time
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cast Location
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Measured Variabes
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Station
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Hour
</th>
<th style="text-align:right;">
Lon
</th>
<th style="text-align:right;">
Lat
</th>
<th style="text-align:right;">
Pressure
</th>
<th style="text-align:right;">
Temperature
</th>
<th style="text-align:right;">
Salinity
</th>
<th style="text-align:right;">
Oxygen
</th>
<th style="text-align:right;">
Fluorescence
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; ">
st1
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
15
</td>
<td style="text-align:right;width: 2cm; ">
40.61
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.17
</td>
<td style="text-align:right;width: 2.5cm; ">
33.92
</td>
<td style="text-align:right;width: 2.5cm; ">
3.93
</td>
<td style="text-align:right;width: 2.5cm; ">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st2
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
17
</td>
<td style="text-align:right;width: 2cm; ">
40.77
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.16
</td>
<td style="text-align:right;width: 2.5cm; ">
34.85
</td>
<td style="text-align:right;width: 2.5cm; ">
4.47
</td>
<td style="text-align:right;width: 2.5cm; ">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st3
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
20
</td>
<td style="text-align:right;width: 2cm; ">
40.95
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st4
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
22
</td>
<td style="text-align:right;width: 2cm; ">
41.12
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st5
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
0
</td>
<td style="text-align:right;width: 2cm; ">
41.28
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st6
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
11
</td>
<td style="text-align:right;width: 2cm; ">
40.34
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.21
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.48
</td>
<td style="text-align:right;width: 2.5cm; ">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st7
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
13
</td>
<td style="text-align:right;width: 2cm; ">
40.18
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.25
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.52
</td>
<td style="text-align:right;width: 2.5cm; ">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st8
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
15
</td>
<td style="text-align:right;width: 2cm; ">
40.00
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.02
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.59
</td>
<td style="text-align:right;width: 2.5cm; ">
1.14
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st9
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
17
</td>
<td style="text-align:right;width: 2cm; ">
39.82
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.11
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.64
</td>
<td style="text-align:right;width: 2.5cm; ">
1.53
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st10
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
19
</td>
<td style="text-align:right;width: 2cm; ">
39.67
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st11
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-22
</td>
<td style="text-align:right;width: 2cm; ">
16
</td>
<td style="text-align:right;width: 2cm; ">
39.60
</td>
<td style="text-align:right;width: 2cm; ">
-9.03
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.44
</td>
<td style="text-align:right;width: 2.5cm; ">
34.91
</td>
<td style="text-align:right;width: 2.5cm; ">
4.98
</td>
<td style="text-align:right;width: 2.5cm; ">
1.71
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st12
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
3
</td>
<td style="text-align:right;width: 2cm; ">
40.26
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.12
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.50
</td>
<td style="text-align:right;width: 2.5cm; ">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st13
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
6
</td>
<td style="text-align:right;width: 2cm; ">
40.10
</td>
<td style="text-align:right;width: 2cm; ">
-7.05
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.18
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.49
</td>
<td style="text-align:right;width: 2.5cm; ">
0.45
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st14
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
7
</td>
<td style="text-align:right;width: 2cm; ">
39.93
</td>
<td style="text-align:right;width: 2cm; ">
-7.05
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.28
</td>
<td style="text-align:right;width: 2.5cm; ">
34.88
</td>
<td style="text-align:right;width: 2.5cm; ">
4.60
</td>
<td style="text-align:right;width: 2.5cm; ">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st15
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
9
</td>
<td style="text-align:right;width: 2cm; ">
39.76
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.26
</td>
<td style="text-align:right;width: 2.5cm; ">
34.89
</td>
<td style="text-align:right;width: 2.5cm; ">
4.66
</td>
<td style="text-align:right;width: 2.5cm; ">
1.06
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st16
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
11
</td>
<td style="text-align:right;width: 2cm; ">
39.59
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.92
</td>
<td style="text-align:right;width: 2.5cm; ">
34.88
</td>
<td style="text-align:right;width: 2.5cm; ">
4.31
</td>
<td style="text-align:right;width: 2.5cm; ">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st17
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
19
</td>
<td style="text-align:right;width: 2cm; ">
40.07
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.64
</td>
<td style="text-align:right;width: 2.5cm; ">
35.19
</td>
<td style="text-align:right;width: 2.5cm; ">
4.40
</td>
<td style="text-align:right;width: 2.5cm; ">
0.82
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st18
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
22
</td>
<td style="text-align:right;width: 2cm; ">
39.90
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.28
</td>
<td style="text-align:right;width: 2.5cm; ">
34.90
</td>
<td style="text-align:right;width: 2.5cm; ">
4.52
</td>
<td style="text-align:right;width: 2.5cm; ">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st19
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
1
</td>
<td style="text-align:right;width: 2cm; ">
39.56
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.27
</td>
<td style="text-align:right;width: 2.5cm; ">
34.90
</td>
<td style="text-align:right;width: 2.5cm; ">
4.53
</td>
<td style="text-align:right;width: 2.5cm; ">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st20
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
3
</td>
<td style="text-align:right;width: 2cm; ">
39.40
</td>
<td style="text-align:right;width: 2cm; ">
-5.47
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.23
</td>
<td style="text-align:right;width: 2.5cm; ">
34.89
</td>
<td style="text-align:right;width: 2.5cm; ">
4.81
</td>
<td style="text-align:right;width: 2.5cm; ">
1.11
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st21
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
4
</td>
<td style="text-align:right;width: 2cm; ">
39.24
</td>
<td style="text-align:right;width: 2cm; ">
-5.48
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.82
</td>
<td style="text-align:right;width: 2.5cm; ">
34.93
</td>
<td style="text-align:right;width: 2.5cm; ">
4.34
</td>
<td style="text-align:right;width: 2.5cm; ">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st22
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
5
</td>
<td style="text-align:right;width: 2cm; ">
39.10
</td>
<td style="text-align:right;width: 2cm; ">
-5.48
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
26.05
</td>
<td style="text-align:right;width: 2.5cm; ">
34.95
</td>
<td style="text-align:right;width: 2.5cm; ">
4.32
</td>
<td style="text-align:right;width: 2.5cm; ">
0.42
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## make a variable with labelled latitude</span>
ctd =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 1&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">bind_rows</span>(ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-8</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 2&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)),
            ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-10</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-8</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 3&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)),
            ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 4&quot;</span>,  <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Lat.label =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(Lat.label<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="kw">as.factor</span>()) </code></pre>
</div>
<div id="components-of-ggplot-objects-components" class="section level2">
<h2><span class="header-section-number">14.2</span> Components of ggplot objects {components}</h2>
<p>I have created a simple plot of this data that show scatterplot of temperature versus fluorescence at the four different transects (Fig @fig:fig1299). The plot show the concentration of fluorescence against temperature for the twenty one stations along the coastal water of Tanzania.</p>
<div class="figure"><span id="fig:fig1299"></span>
<img src="spatil_r_files/figure-html/fig1299-1.png" alt="Association of fluorescence concentration per temperature collected in August 2004" width="672" />
<p class="caption">
Figure 14.1: Association of fluorescence concentration per temperature collected in August 2004
</p>
</div>
<p>Let’s explore in details the key elements used to make figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">14.1</a>:</p>
<ul>
<li><strong>data</strong>: The data like the one illustrated in table <a href="plotting-in-r-with-ggplot2.html#tab:tabE01">14.1</a>. It must be a data frame for ggplot2 read and understand.</li>
<li><strong>aesthetics</strong>: is used to map the <code>x</code> and <code>y</code> axis for 2–dimensional plot and add the <code>z</code> value for 3–dimensionla plots. It is also used to define visual properties like color, size, shapes or height etc, and. For instance in the figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">14.1</a>, the position along the <code>y</code>-axis is mapped to the concentration of fluorescence and the <code>x</code> - axis is mapped to temperature values. For the points, the color is mapped to the geogrphical location along the transects. Other aesthetics—like size, shape, and transparency have been left at their default settings.</li>
<li><strong>geometry</strong>; a layer which define the type of plot you want to make, whether is <code>histogram</code>, <code>boxplot</code>, <code>barplot</code>, <code>scatterplot</code>, <code>lineplot</code> etc.</li>
<li><strong>coordinate system</strong>: used to set a limit for the plot. The cartesian coordinate is the most familiar and common system that is widely used to zoom the plot and does not change the underlying data.</li>
<li><strong>scales</strong>: scales allows to customize the plot. For instance in figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">14.1</a> both x and y-axis used continuous data and hence the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> were used to modiy the values of the axis. For color, I simply stick on <code>scale_colour_discrete()</code> and customize the legend name.</li>
<li><strong>labels</strong>: The plot is well labelled and easy to understand. It has title, subtitle, axes and caption for the courtesy of the data.</li>
<li><strong>theme</strong>: the plot stick on the default <code>theme_gray</code> theme, which has a gray background color and white gridlines, a sans serif font family, and a base font size of 11. We can customize all the propoerties in the theme to suit our standard.</li>
</ul>
</div>
<div id="building-a-plot" class="section level2">
<h2><span class="header-section-number">14.3</span> Building a plot</h2>
<p>Since you now have a clue of the different layers added to create a plot, its time to work around to create a plot with the <strong>ggplot2</strong> package. We use the same profile dataset that used to make figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">14.1</a>. First, you neeed to import the data into your R session.</p>
<div id="plotting-layers" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Plotting layers</h3>
<p>To create a data visualization using <strong>ggplot2</strong> package, we will add <code>layers</code> for each of the plot elements described in section <a href="#components"><strong>??</strong></a>. I will take you through step by step of the key ines needed to make such a plot. First make sure the <strong>ggplot2</strong> or <strong>tidyverse</strong> packages are loaded in your R’s session. You can load the package with this code;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)</code></pre>
<p>The <strong>ggplot2</strong> create a <code>ggplot</code> object, and you initialize the object with the <code>ggplot()</code> function</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-322-1.png" width="672" />
The plot above is black with grey background. This is because we have not specified the data and aesthetic arguments inside the <code>ggplot()</code> function. Let’s specify the data, which in our case is the ctd dataset and also specify the x-axis with temperature and y-axis with fluorescence.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
<p>Now the plot has gridlines and axis with values and labels—x-axis show the value of temperature and the y-axis show the value of fluorescence concentrations. However, there is no graphics. This is because we have not added any geom yet. Therefore, since we have already specified the data and the aesthetic values, now we can add the geom where we map the aesthetics to columns in the dataset. Let’s add the <code>geom_point()</code> and specify the size to 3</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size  =</span> <span class="dv">3</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-324-1.png" width="672" /></p>
</div>
<div id="customize-legend" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Customize legend</h3>
<p>The plot now show points distributed in the panel plot. But our interest is to color the point at each transect. Next, we add an argument <code>col</code> in the aesthetic that map points that fall along a certain transect with similar color. Since we have a variable called transect in the dataset, we specify this as the code below</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-325-1.png" width="672" />
The plot above show the points are color–coded to refrect the transect in the legend. Note that the colors scheme used in this plot is the default one. Sometimes you will want to customize the aesthetic for all the points in the plot. To change a color scale, you can use the <code>scale_color_viridis_d()</code>. The <code>_d</code> here represent the discrete variable. If you were using the continuous data, you would use <code>scale_color_viridis_c()</code> scheme instead.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-326-1.png" width="672" /></p>
<p>To change the title of the legend you must specify the name argument in your <code>scale_*</code> function. For instance, we specified <code>scale_colour_viridis_d(name = "Transects")</code> to change the legend title for this plot</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects</span><span class="ch">\n</span><span class="st"> of CTD Casts&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<p>If you want to remove the legend title, we can add a theme layer and specify <code>theme(legend.title = element_blank())</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-328-1.png" width="672" />
We can also change the legend title by specifying theme(legend.title = element_blank())</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects</span><span class="ch">\n</span><span class="st">of CTD Casts&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="st">&quot;chocolate&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-329-1.png" width="672" /></p>
</div>
<div id="working-with-titles-and-labels" class="section level3">
<h3><span class="header-section-number">14.3.3</span> Working with titles and labels</h3>
<p>Often times you need to customize the axis labels. By default, the scale label for each scale is the name of the variable in the dataset. We can change the labels with <code>labs()</code> function. The other elements we would like to add are the plot title and subtitle. If you want to label SI unit in the ggplot, use the <code>expression()</code> function. Note that I used the <code>expression()</code> function to express mathematical symbols in the x and y–axis of the plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
</div>
</div>
<div id="customize-glidline-and-axis-labels" class="section level2">
<h2><span class="header-section-number">14.4</span> Customize glidline and axis labels</h2>
<p>The other layer that we would like to add to customize our plot are the <code>scale_x_continous()</code>, which change the gridline of the x-axis and the <code>scale_y_continuous()</code>, which change the gridlines of the y-axis.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-331-1.png" width="672" /></p>
<div id="remove-the-gray-box-of-points-on-legend" class="section level3">
<h3><span class="header-section-number">14.4.1</span> Remove the gray box of points on legend</h3>
<p>The default ggplot always put a gray background of the scatterplot. You can remove it by adding a theme layer and specify the argument <code>legend.key = element_blank()</code> to get rid of them</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
</div>
</div>
<div id="modify-the-position-of-the-legend" class="section level2">
<h2><span class="header-section-number">14.5</span> Modify the position of the legend</h2>
<p>By default, ggplot2 place the legend on the right position. You can decided to place either left, right, top or bottom. For example, if we want to place the legend at the bottom, we simply specifying the argument <code>legend.position = "bottom"</code> in the theme layer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-333-1.png" width="672" /></p>
<p>We can also position the legend insite the plot and specify the x and y coordinates. The coordinates range from 0 to 1, from left to right or bottom to top of the plot. For instance, we can place the legend at the top right corner of the plot by specifying <code>legend.position = c(.9,.75)</code> in the theme layer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
<div id="change-the-legend-background-and-stroke-color" class="section level3">
<h3><span class="header-section-number">14.5.1</span> Change the legend background and stroke color</h3>
<p>By default, ggplot legend has a white fill for background and without color for stroke. We can customize the look of the legend in the theme layer. For example, we want our legend to have an ivory fill and black stroke of 0.25 size. This can be achieved by adding and argument<code>legend.background = element_rect(fill = "ivory", colour = "black", size = .25)</code> in the theme layer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-335-1.png" width="672" /></p>
</div>
<div id="modify-background-colors" class="section level3">
<h3><span class="header-section-number">14.5.2</span> Modify background colors</h3>
<p>You can remove the background fill and stroke color with the <code>panel.background = element_blank()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
<p>You can customize the the background fill and stroke colors to your what fit you best with the <code>panel.background = element_rect()</code> and specify the stroke with <code>color</code> and background with the <code>fill</code> arguments.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-337-1.png" width="672" /></p>
</div>
<div id="change-the-gridlines" class="section level3">
<h3><span class="header-section-number">14.5.3</span> change the gridlines</h3>
<p>You can also customize the color and shape of the gridlines. You can remove the gridline with <code>panel.grid = element_blank()</code> argument in the theme layer. But if you want to customize the gridlines, then you use the <code>panel.grid = element_line()</code> and specify the <code>color</code> and <code>linetype</code> etc.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),
        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),
        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
</div>
<div id="change-the-font-size-for-axis-labels-and-titles" class="section level3">
<h3><span class="header-section-number">14.5.4</span> Change the font size for axis, labels and titles</h3>
<p>The fonts for axis ticks, axis-title text have a default font size of 11, if we want to increase the font size to 12 then then we can do that inside the <code>theme()</code>. We can also change the font size for titles, subtitles and legend text and title as the chunk below highlight.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), 
        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), 
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), 
        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-339-1.png" width="672" /></p>
</div>
<div id="limit-axis-to-a-range" class="section level3">
<h3><span class="header-section-number">14.5.5</span> Limit axis to a range</h3>
<p>We use the <code>coord_cartesian()</code> function to adjust the visible area of the plot. You should specify the range of the <code>ylim=c()</code> and <code>xlim = c()</code> and <code>expand = FALSE</code> to show only the area of the plot you want to visualize.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), 
        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), 
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), 
        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
</div>
<div id="adding-labels" class="section level3">
<h3><span class="header-section-number">14.5.6</span> Adding labels</h3>
<p>ggplot2 provide <code>geom_tex()</code> and <code>geom_label</code> function for adding label on the plot. <code>geom_text()</code> adds text directly to the plot. <code>geom_label()</code> draws a rectangle behind the text, making it easier to read.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station), <span class="dt">nudge_x =</span> <span class="fl">0.05</span>, <span class="dt">nudge_y =</span> <span class="fl">.04</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-341-1.png" width="672" /></p>
<p>I find it difficult to position label with <code>geom_text()</code>, especially when you have a lot of points to label. I often use the <strong>ggrepel</strong> package, which provides text and label geoms for <strong>ggplot2</strong> that help to avoid overlapping text labels. These function makes labels repel away from each other and away from the data points.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
<div id="add-text-annotation" class="section level3">
<h3><span class="header-section-number">14.5.7</span> Add text annotation</h3>
<p>There are times you may need to add a text on top of the plot. In <em>ggplot2</em> you can place a label using the real values on the plot instead of the hard-core coorinates to specify the location based on scaled coordinates where 0 is low and 1 is high. This is useful for adding small annotations (such as text labels) or if you have your data in vectors, and for some reason don’t want to put them in a data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), 
       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, 
       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), 
        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), 
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), 
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), 
        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">25.95</span> , <span class="dt">y =</span> <span class="fl">1.82</span>, <span class="dt">label =</span> <span class="st">&quot;My label&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-343-1.png" width="672" /></p>
</div>
<div id="make-the-x-and-y-axis-the-same" class="section level3">
<h3><span class="header-section-number">14.5.8</span> Make the x and y axis the same</h3>
<p>The <code>coord_cartesian()</code> is the coordinate system that you will use most of the time because most of the plot are created from two or more variables that have different scales. However, there are situations where you create plots that use the same scale of x-and y-coordinates. For example, ploting temperature profiles from two stations, then an appropriate coordinae system in that case is the <code>coord_equal()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## tidy the temperature from long to wide format </span>
ctd.temprature.wide =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(station, temperature, pressure) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> <span class="st">&quot;station&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;temperature&quot;</span>)

<span class="co">## make aplot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.temprature.wide, 
       <span class="kw">aes</span>(<span class="dt">x =</span> st3, <span class="dt">y =</span> st8)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_equal</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
</div>
<div id="faceting-creating-multipanel-plots" class="section level3">
<h3><span class="header-section-number">14.5.9</span> Faceting —Creating multi–panel plots</h3>
<p>Facets are ways of arranging plots into multiple different pieces (subplots). This allows you to view a separate plot for each unique value in a categorical variable. The <strong>ggplot2</strong> package has a nice function for creating multi-panel plots. The <code>facet_wrap</code> creates essentially a ribbon of plots based on a single variable. For example the plot below, I first filtered only profile below 201 meters and classify them into bins of below 50 meters, 50 to 100 and above 100 meters. This computed depth class was used to make multiple plot of boxplot of fluorescence at the four transects. in the <code>facet_wrap()</code> layer, I specified the <code>~depth.class</code> to use this variable for faceting and <code>nrow = 1</code>, for the canvas to have one row with multiple columns depending on the groups, four our case we get three columns from the depth classes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## filter the pressure and break them into class of 50,100,200</span>
ctd.class.depth =<span class="st"> </span>ctd <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">201</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">depth.class =</span> <span class="kw">cut</span>(pressure, 
                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), 
                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Below 50&quot;</span>, <span class="st">&quot;50-100&quot;</span>, <span class="st">&quot;Above 100&quot;</span>))) 
  
  
  <span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.class.depth, 
         <span class="kw">aes</span>(<span class="dt">x =</span> transect,<span class="dt">y =</span> fluorescence, <span class="dt">fill =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;transect 1&quot;</span>, <span class="st">&quot;transect 2&quot;</span>, <span class="st">&quot;transect 3&quot;</span>, <span class="st">&quot;transect 4&quot;</span>), 
                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Kimbiji&quot;</span>, <span class="st">&quot;Lindi&quot;</span>, <span class="st">&quot;Mtwara&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})))<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>depth.class, <span class="dt">nrow =</span> <span class="dv">1</span>) </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-345-1.png" width="672" /></p>
</div>
<div id="allow-scales-to-roam-free-scales" class="section level3">
<h3><span class="header-section-number">14.5.10</span> Allow scales to roam free (scales)</h3>
<p>The default for multi-panel plots in <strong>ggplot2</strong> is to use equivalent scales in each panel. But sometimes you want to allow a panel’s own data to determine the scale. This may mislead to the audience since it give creaes plots with different scales. You can specify the <code>scales="free"</code> in the <code>facet_wrap()</code> layer written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## filter the pressure and break them into class of 50,100,200</span>
ctd.class.depth =<span class="st"> </span>ctd <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">201</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">depth.class =</span> <span class="kw">cut</span>(pressure, 
                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), 
                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Below 50&quot;</span>, <span class="st">&quot;50-100&quot;</span>, <span class="st">&quot;Above 100&quot;</span>))) 
  
  
  <span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.class.depth, 
         <span class="kw">aes</span>(<span class="dt">x =</span> transect,<span class="dt">y =</span> fluorescence, <span class="dt">fill =</span> transect)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;transect 1&quot;</span>, <span class="st">&quot;transect 2&quot;</span>, <span class="st">&quot;transect 3&quot;</span>, <span class="st">&quot;transect 4&quot;</span>), 
                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Kimbiji&quot;</span>, <span class="st">&quot;Lindi&quot;</span>, <span class="st">&quot;Mtwara&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})))<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>depth.class, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-346-1.png" width="672" /></p>
</div>
</div>
<div id="basic-plots" class="section level2">
<h2><span class="header-section-number">14.6</span> Basic plots</h2>
<p>The <strong>ggplot2</strong> package provides a set of functions that mirror the <em>Grammar of Graphics</em>, enabling you to efficaciously specify what you want a plot to look like. To have a glimpse of <strong>ggplot2</strong>, we start with five basic types of plots that are familiar to most people. These include:</p>
<ol style="list-style-type: decimal">
<li>scatterplot</li>
<li>linegraphs</li>
<li>boxplots</li>
<li>histograms</li>
<li>barplots</li>
</ol>
<blockquote>
<p>Note that the four graphs works with quantitative data and barplots are appropriate for categorical data. Thus, understanding the type of data you want to plot is a fundamental principle before you throw the variable into <strong>ggplot2</strong> to make plot for you.</p>
</blockquote>
<div id="scatterplot" class="section level3">
<h3><span class="header-section-number">14.6.1</span> scatterplot</h3>
<p>Scatterplots are also called bivariate, allows you to visualize the association between two numerical variables. They are among the widely used plot because they can provide an immediate way to see the pattern of association between two numerical variables.</p>
<div class="figure"><span id="fig:unnamed-chunk-347"></span>
<img src="spatil_r_files/figure-html/unnamed-chunk-347-1.png" alt="scatterplot from base R" width="672" />
<p class="caption">
Figure 14.2: scatterplot from base R
</p>
</div>
<p>Most of us are familiar with scatterplot shown in figure  and made several of them using base R, but probably you have not made one based on the fundamental theorem of <em>grammar of graphics</em>. We will visualize the relationship between temperature and fluorescence. Because the ctd is profile data frame with variable as function of pressure, we want to check for the association of all the 22 station but at fixed depth of 10 meters. What this means is that we will take the ctd data and filter all variable at all station measured at water depth of 10 meters from the surface and save this in a new data frame called ctd10d. This can be written as:</p>
<pre class="sourceCode r"><code class="sourceCode r">ctd10d =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)</code></pre>
<p>Let’s now dive into the code of using the *grammar of graphics<strong> to create the scatterplot. We use the <code>ggplot()</code> function from </strong>ggplot2** package. The code to create figure <a href="#fig:"><strong>??</strong></a> is written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p>Let’s explore the block above piece-by-piece</p>
<ul>
<li>The plotting in <strong>ggplot2</strong> begin with <code>ggplot()</code> function, where the two components of <em>grammar of graphics</em> are required. in the <code>data</code> component we specify the data frame of variables measured at 10 meter water below the surface by setting <code>data = ctd10d</code>. Then the second argument <code>aes</code>thetic that map the plot with coordinate was set by <code>aes(x = temperature, y = fluorescence))</code>. In a nutshell, the <code>aes()</code> define the variable–axis specifications. For the code above we set the variables <code>temperature</code> into the <code>x</code> coordinate and the variable <code>fluorescence</code> into the <code>y-axis</code>.</li>
<li>We then add a layer to the <code>ggplot()</code> function calll using the <code>+</code> sign. The added layer specify the third part of the *grammar—the <code>geom</code>etric component. Becasue we want to plot scatterplot, the appropriate <code>geom</code> for this case is the <code>geom_point()</code>.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-350"></span>
<img src="spatil_r_files/figure-html/unnamed-chunk-350-1.png" alt="Scatterplot showing the association between temperature and fluorescence at 10  meter water from the surface" width="672" />
<p class="caption">
Figure 14.3: Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface
</p>
</div>
<p>Once the code is run, it produce two outputs: a warning message and figure <a href="#fig:"><strong>??</strong></a>. The warning message notify us that out of the 22 stations, there are three stations with missing data at 10 meter water. We can check station with missing values with code written below;</p>
<pre class="sourceCode r"><code class="sourceCode r">ctd10d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(temperature)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(station, pressure, temperature, fluorescence)</code></pre>
<pre><code># A tibble: 3 x 4
  station pressure temperature fluorescence
  &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 st10          10          NA           NA
2 st4           10          NA           NA
3 st5           10          NA           NA</code></pre>
</div>
<div id="adding-regression-line" class="section level3">
<h3><span class="header-section-number">14.6.2</span> adding regression line</h3>
<p>you can simply add the regression line by addign a <code>geom_smooth()</code> layer and specify the <code>method = "lm"</code> and we dont need to show the confidence errors, hence we specify <code>se = FALSE</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()  <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-352-1.png" width="672" /></p>
<p>While the geom_point() and geom_smooth() layers in this code both use the same aesthetic mappings, there’s no reason you couldn’t assign different aesthetic mappings to each geometry. Note that if the layers do share some aesthetic mappings, you can specify those as an argument to the ggplot() function</p>
<p>Looking on the generated scatterplot (Figure <a href="#fig:"><strong>??</strong></a>), we notice a negative relation exist between temperature and fluorescence—stations with high temperature have relatively low concentration of fluorescence and viceversa. We also notice that 16 stations are clustered within <span class="math inline">\(25-25.25^{\circ}\)</span> C and only three are found at temperature range between <span class="math inline">\(25.75-26^{\circ}\)</span> C. We can identify these pattern by adding a <code>col</code> argument in <code>aes</code> by setting <code>aes(x = temperature, y = fluorescence, col = Lat.label))</code>. The code for creating figure <a href="#fig:"><strong>??</strong></a> is written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> Lat.label)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-354-1.png" width="672" /></p>
<p>Looking on the color of thelegend, it clearly indicate the two stations with temperatur above <span class="math inline">\(25.75^{\circ}\)</span> C are found along the transect lies along latitude 5.49°S in Pemba Channel and and one at latitde7.04°S off the Kimbiji.</p>
<p>We may also be interested to knwo whether dissolved oxygen has influrence on the the association of temperature and fluoresce. We can achieve that by simply parsing the the <code>shape = oxygen</code>, arguments into the <code>aes</code>thetic component. Figure <a href="#fig:"><strong>??</strong></a> clearly shows the stations with relatively high chlorophyll value have bigger shape (high DO value) and found in relatively less warmer waters in contrast to stations with low chl-value have smaller shape size, indicating low DO and found in relatively warmer water. The chunk for making figure <a href="#fig:"><strong>??</strong></a> is written as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">size =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
<div class="figure"><span id="fig:unnamed-chunk-356"></span>
<img src="spatil_r_files/figure-html/unnamed-chunk-356-1.png" alt="Scatterplot showing the association between temperature and fluorescence at 10  meter water from the surface and the influence of dissolved oxygen" width="672" />
<p class="caption">
Figure 14.4: Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface and the influence of dissolved oxygen
</p>
</div>
</div>
</div>
<div id="linegraph" class="section level2">
<h2><span class="header-section-number">14.7</span> Linegraph</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># I donwloaded the data using the code below and save it into the project directory. This chunk will never run but rather the proceeding step will use the data that was downloade and processed with code in this chunk.</span>
result =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">searchData</span>(<span class="st">&quot;datasetname:mday&quot;</span>)

<span class="co">##  sst, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span>
xtractomatic<span class="op">::</span><span class="kw">getInfo</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhsstdmday&quot;</span>)
<span class="co">##  Chlorophyll-a, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span>
xtractomatic<span class="op">::</span><span class="kw">getInfo</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhchlamday&quot;</span>)


sst =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">xtracto_3D</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhsstdmday&quot;</span>, 
                               <span class="dt">xpos =</span> <span class="kw">c</span>(<span class="fl">38.79272</span>,<span class="fl">40.24292</span>), 
                               <span class="dt">ypos =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.692232</span>,<span class="op">-</span><span class="fl">5.451759</span>), 
                               <span class="dt">tpos =</span> <span class="kw">c</span>(<span class="st">&quot;2014-11-02&quot;</span>, <span class="st">&quot;2019-04-16&quot;</span>))

chl =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">xtracto_3D</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhchlamday&quot;</span>, 
                               <span class="dt">xpos =</span> <span class="kw">c</span>(<span class="fl">38.79272</span>, <span class="fl">40.24292</span>), 
                               <span class="dt">ypos =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.692232</span>, <span class="fl">-5.451759</span>), 
                               <span class="dt">tpos =</span> <span class="kw">c</span>(<span class="st">&quot;2003-01-17&quot;</span>, <span class="st">&quot;2019-04-16&quot;</span>))</code></pre>
<p>The next basic graph of ggplot2 is the linegraph. Linegraphs is similar to drawing points, except that it conncets the points with line. often times you dont show the points. Linegraphs are commonly used to show time series data. Its inappropriate to use the linegraphs for data that has no clear sequential ordering . Let’s illustrate how to create linegraphs using another dataset of<code>chlorophyll</code> concentration in the Pemba channel. This is a monthly average data from MODIS satellite. I processed the data and stored them in <code>.RData</code> format. We can load this dataset from the working directory with the <code>load()</code> function as shown in the chunk below;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;modis_pemba.RData&quot;</span>)</code></pre>
<p>Exploring further the dataset, we notice that its an array with 35 longitude spacing and 7 latitude spacing and 196 matrix collected every month from 2003-01-16 to 2019-04-16. Being an array, this dataset is not in the right format, since <strong>ggplot2</strong> only accept the data frame format.</p>
<pre class="sourceCode r"><code class="sourceCode r">chl<span class="op">$</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>();chl<span class="op">$</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">dim</span>()</code></pre>
<pre><code>[1] &quot;array&quot;</code></pre>
<pre><code>[1]  35   7 196</code></pre>
<p>Therefore, we need to tidy this dataset from the array into the data frame and find average chlorophyll concentration for each month for 196 months. Because there are 196 matrix, that is a lot of work to do it one after the other. The easiest solution is to loop the process with a <code>for</code> loop. If you are not familiar with how loop works in R, I suggest you check section__ of chapter__, which describe in details. The chunk below highlight the <code>for</code> loop used to convert an array to matrix</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## preallocate object</span>
sst.tb =<span class="st"> </span><span class="kw">list</span>()
chl.tb =<span class="st"> </span><span class="kw">list</span>()

<span class="co">## loop sst</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sst<span class="op">$</span>time)){
  
  sst.tb[[i]] =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> sst<span class="op">$</span>longitude, 
                          <span class="dt">y =</span> sst<span class="op">$</span>latitude, 
                          <span class="dt">data =</span> sst<span class="op">$</span>data[,,i]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">time =</span> sst<span class="op">$</span>time[i] <span class="op">%&gt;%</span><span class="kw">as.Date</span>()) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">    </span><span class="kw">select</span>(<span class="dt">date =</span> time,<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">sst =</span> value) 
}

<span class="co">## loop chl</span>
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(chl<span class="op">$</span>time)){
  chl.tb[[j]] =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> chl<span class="op">$</span>longitude, 
                          <span class="dt">y =</span> chl<span class="op">$</span>latitude, 
                          <span class="dt">data =</span> chl<span class="op">$</span>data[,,j]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">time =</span> chl<span class="op">$</span>time[j] <span class="op">%&gt;%</span><span class="kw">as.Date</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(<span class="dt">date =</span> time,<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">chl =</span> value) 
}
<span class="co">## unlist the listed sst and chl files</span>
sst.tb =<span class="st"> </span>sst.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(sst.tb)
chl.tb =<span class="st"> </span>chl.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(chl.tb)</code></pre>
<p>We then used the function in <code>lubridate::year()</code> and <code>lubridate::month()</code> to create the <code>year</code> and <code>month</code> variables from the <code>date</code> variables</p>
<pre class="sourceCode r"><code class="sourceCode r">chl.decompose =<span class="st"> </span>chl.tb <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abb =</span> <span class="ot">TRUE</span>), 
         <span class="dt">year =</span> lubridate<span class="op">::</span><span class="kw">year</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()) </code></pre>
<p>To make a plot of annual average of chlorophyll concentration in the Pemba Channel, we need to monthly mean. We exclude data for year 2003 and 2019 because there only seven months in 2003 and four months in 2019, which can affect the analysis. computing annual average can be written as;</p>
<pre class="sourceCode r"><code class="sourceCode r">chl.yearly =<span class="st"> </span>chl.decompose <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>( year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2003</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2018</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
<p>Let’s create linegraph of annual average chlorophyll-a concentration in the Pemba Channel. Like the scatterplot we made earlier, where supply the data frame in <code>data</code> argument and specified the <code>aes</code>thetic mapping with <code>x</code> and <code>y</code> cooridnates, but instead of using <code>geom_point()</code>, we use the <code>geom_line()</code>. The code to make the line graphy of annual average chlorophyll-a conceration shown in figure <a href="#fig:"><strong>??</strong></a> are written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.yearly, 
       <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-364-1.png" width="672" /></p>
<p>Since the selected area is affected with monsoon season, we can further decode the months into their respective southeast (SE) and northeast (NE) and inter-monsoon (IN) seasons using the <code>decode()</code> function from <strong>dplyr</strong> package as the chunk below show;</p>
<pre class="sourceCode r"><code class="sourceCode r">chl.season =<span class="st"> </span>chl.decompose <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">season =</span> month <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>(), 
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jan =</span> <span class="st">&quot;NE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Feb =</span> <span class="st">&quot;NE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Mar =</span> <span class="st">&quot;NE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Apr =</span> <span class="st">&quot;IN&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">May =</span> <span class="st">&quot;SE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jun =</span> <span class="st">&quot;SE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jul =</span> <span class="st">&quot;SE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Aug =</span> <span class="st">&quot;SE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Sep =</span> <span class="st">&quot;SE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Oct =</span> <span class="st">&quot;IN&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Nov =</span> <span class="st">&quot;NE&quot;</span>),
         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Dec =</span> <span class="st">&quot;NE&quot;</span>))</code></pre>
<p>We then compute the year average of chlorophyll-a at each season as written in the chunk below</p>
<pre class="sourceCode r"><code class="sourceCode r">chl.season =<span class="st"> </span>chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>( year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2003</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2019</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(year,season) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
<p>To make a linegraphy that show annual average of chlorophyll-a concetration for each season as in figure <a href="#fig:"><strong>??</strong></a>, we simply parse the argument <code>col == season</code> in the <code>aes()</code> component as the chunk below hightlight</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season, 
       <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> chl, <span class="dt">col =</span> season))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2002</span>,<span class="dv">2019</span>,<span class="dv">2</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-367-1.png" width="672" /></p>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">14.7.1</span> histogram</h3>
<p>A histogram is a plot that can be used to examine the shape and spread of continuous data. It looks very similar to a bar graph and organized in intervals or classes.
. It divides the range of the data into <code>bin</code> equal intervals (also called bins or classes), count the number of observations n in each bin, and display the frequency distribution of observations as a bar plot. Such histogram plots provide valuable information on the characteristics of the data, such as the <code>central tendency</code>, the <code>dispersion</code> and the general <code>shape</code> of the distribution.</p>
<p>Let’s consider the <code>chl</code> variable in the <code>chl.tb</code> data frame. Since histogram works for single variable that contains quantitative values, you can not bother looking for relationship as we have seen in previous plots, but histogram offers an opportunity to answer question like</p>
<ol style="list-style-type: decimal">
<li>What are the smallest and largest values of chl-a?</li>
<li>What is the center value?
3 How does these values spread out?</li>
</ol>
<p>We can make a histogram shown in figure <a href="#fig:"><strong>??</strong></a> by simply setting <code>aes(x = chl)</code> and add <code>geom_histogram()</code>. Within the geom_histogram(), we simply specify the number of bins <code>bins = 28</code> and also the color seprating each column of the histogram with <code>col == "white"</code>. The code to create figure <a href="#fig:"><strong>??</strong></a>, which displays a histogram with twenty eight classes, is written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.decompose <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(chl <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">28</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-370"></span>
<img src="spatil_r_files/figure-html/unnamed-chunk-370-1.png" alt="Histogram showing the distribution of chlorophyll concentration" width="672" />
<p class="caption">
Figure 14.5: Histogram showing the distribution of chlorophyll concentration
</p>
</div>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">14.7.2</span> boxplot</h3>
<p>The box plot is a standardized way of displaying the distribution of data based on the five number summary: minimum, first quartile, median, third quartile, and maximum. Box plots are useful for detecting outliers and for comparing distributions. These five number summary also called the 25<sup>th</sup> percentile, median, and 75<sup>th</sup> percentile of the quantitative data. The whisker (vertical lines) capture reoungly 99% of a distribution, and observaion outside this range are plottted as points representing outliers as shown in figure <a href="plotting-in-r-with-ggplot2.html#fig:boxplot">14.6</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./images/boxplot-01.png&quot;</span>)</code></pre>
<div class="figure"><span id="fig:boxplot"></span>
<img src="images/boxplot-01.png" alt="Boxplot five numbers" width="298" />
<p class="caption">
Figure 14.6: Boxplot five numbers
</p>
</div>
<p>Box plots can be created by using the <code>geom_boxplot()</code> function and specify the data variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.decompose <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-371-1.png" width="672" /></p>
<p>The firstinput must be a categorical variable and the second must be a continuous variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
<p>the <code>geom_boxplot()</code> has <code>outlier_</code> arguments that allows to highlight and modify the color, shape, size, alpha … etc of outliers —extreme observation. For instance, you can highlight the outlier with;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-373-1.png" width="672" /></p>
<p>We can also map the fill and color to variable in to distinguish boxplot. for example, we can specify the <code>fill = season</code> argument in the <code>aes()</code> to fill the boxplot based on season.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> sst.season , 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> sst, <span class="dt">fill =</span> season))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span><span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-375-1.png" width="672" /></p>
<p>We can add the points on top of the boxplot with the <code>geom_jitter()</code>. It also allows for specifying other arguments like colors and width of the points.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.05</span>, <span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
<div id="barplot" class="section level3">
<h3><span class="header-section-number">14.7.3</span> barplot</h3>
<p>Bar graphs are perhaps the widely used plot. They are typically used to display numeric values on the y-axis for different groups on the x-axis. There is an important distiction you should be aware of when making bar graphs. The heigh of a bar in barplot may represent either the counts or values of elements in the dataset. Let’s begin with the former—count. We use the drifter observations, which passed at the confluence—where the South Equatorial Current splits to form the northward flowing called the East Africa Coastal Current and the southward flowing the Mozambique Current. We first load the daset as the code highlight;</p>
<pre class="sourceCode r"><code class="sourceCode r">drifter_confluence =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;drifter_confluence.csv&quot;</span>)</code></pre>
<div id="barplot-for-count" class="section level4">
<h4><span class="header-section-number">14.7.3.1</span> barplot for count</h4>
<p>To make the bar graph that show the number of drifters crossed the ares per month over the entire period you you simply specify the the variable <code>month</code> in the <code>x</code> coordinates in the <code>aes</code>thetic and add the <code>geom_bar()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter_confluence, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-379-1.png" width="672" /></p>
<p>Sometimes you may wish to stack bars. For instance drifter have drogued—an anchor, which reduce speed of the drifter wind effect. When the drogue is lost, drifter slip and tend to overestimate the current speed. In our dataset, the drogue are coded with <code>0 == Absent</code>, and <code>1 = Present</code>. Because zero and ones make no sense, we create a new variables of that replace zero with <code>LOST</code> and ones with <code>PRESENT.</code> we use the <code>if_else()</code> function from <strong>dplyr</strong> to convert these values and assign the object as <code>drifter.drogue</code>. The conversion can be attained with code written as;</p>
<pre class="sourceCode r"><code class="sourceCode r">drifter.drouge =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">drogue.status =</span> <span class="kw">if_else</span>(<span class="dt">condition =</span> drogue<span class="op">==</span><span class="dv">1</span>, <span class="dt">true =</span> <span class="st">&quot;PRESENT&quot;</span>, <span class="dt">false =</span> <span class="st">&quot;LOST&quot;</span>))</code></pre>
<p>Then to stack the bar based on the drogue status, we simpy add the <code>fill = drogue.status</code> in <code>aes()</code> part</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-381-1.png" width="672" /></p>
<p>You can flip the order of bar with <code>position = position_stack(reverse = TRUE)</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
<p>Instead of stacking, you can dodge the bar with <code>position = position_dodge()</code> argument</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-383-1.png" width="672" /></p>
<p>To add a black stroke color of the bar, add the argument <code>col = "black"</code> inside the <code>geom_bar()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-384-1.png" width="672" /></p>
<p>And to specify the width of the bar you specify a value in <code>width</code> argument in <code>geom_bar()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="fl">.75</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
<p>Sometimes you want to map bar with different colors for negative and positive values. For this case we will use the sea surface temperature from drifter observation and create a new variable called anomaly—indicate the temperature value above (positive value) and below (negative) the climatological mean. The code for computing anomaly is;</p>
<pre class="sourceCode r"><code class="sourceCode r">sst.anomaly =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average =</span> <span class="kw">mean</span>(sst, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">anomaly =</span> average <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(average), 
         <span class="dt">anomaly.status =</span> <span class="kw">if_else</span>(anomaly <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> , <span class="st">&quot;Above&quot;</span>, <span class="st">&quot;Below&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1996</span>)</code></pre>
<p>once we have computed the anomaly of sea surface temperature for each year, we can plot the withe <code>geom_col()</code> and specify <code>x = year</code>, and <code>y = anomaly</code> and <code>fill = anomaly.status</code>. We also need to specify the <code>position == "identity"</code> to prevent notification message of poor defined stacking for bar with negative values.</p>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">ggplot</span>(<span class="dt">data =</span>sst.anomaly,
         <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> anomaly, <span class="dt">fill =</span> anomaly.status)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">.8</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
<p>Although the plot looks good but sometimes we may wish to reverse the filled color.We can reorder the color with the <code>scale</code> layer. Because the variable used to fill the bar is categorical, the appropriate scale is <code>scale_fill_discrete()</code> and you specify the limits with <code>limits =  c("Below", "Above")</code>. The legend is this plot is not important and we can remove from th plot with <code>guides(fill = FALSE)</code></p>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">ggplot</span>(<span class="dt">data =</span>sst.anomaly,
         <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> anomaly, <span class="dt">fill =</span> anomaly.status)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">.8</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Below&quot;</span>, <span class="st">&quot;Above&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-388-1.png" width="672" />
The red</p>
</div>
</div>
<div id="barplot-for-values" class="section level3">
<h3><span class="header-section-number">14.7.4</span> barplot for values</h3>
<p>We have seen how to make barplot that show the count with <code>geom_bar()</code>. You can also use the barplot to show the values with the <code>geom_col()</code> function and specify what variables you want on the <code>x</code> and <code>y</code> axis. For instance, we want to show how surface current varies over twelve months. Because the <code>geom_col()</code> requires summarized statistics, we need to compute the average current speed for each month. The chunk below highlight how to compute the mean, maximum, minimum and standard deviation of surface current velocity for each month.</p>
<pre class="sourceCode r"><code class="sourceCode r">current.speed.monthly =<span class="st"> </span>drifter.drouge <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">speed =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(month, drogue.status) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">speed_min =</span> <span class="kw">min</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">speed_mean =</span> <span class="kw">mean</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">speed_max =</span> <span class="kw">max</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">speed_sd =</span> <span class="kw">sd</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre>
<p>Once we have computed the statistics, we can use them to make barplot. Note that unlike the <code>geom_bar()</code> that need only the <code>x</code> variable, <code>geom_col()</code> requires <code>x</code> and <code>y</code> variables specified. For illustration, we specified the <code>x = month</code>, and <code>y = speed_mean</code> in the <code>aes()</code> to make a barplot that show the monthly monthly mean surface current.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_mean))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-390-1.png" width="672" /></p>
<p>Although ggplot2 allows to stack the barplot that present values, although they seems appealing, you must avoid making such kind of plot, because they tend to mislead and difficult to distinguish betwen the groups.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_max, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
<p>The appropriate way if you want to compare two or more groups with <code>geom_col()</code>, you better doge the bar instead of stacking them. This makes easier to compare. For instance, in the case here, its cleary to see months of which drifter with lost drogues move relatively faster than those with droguue.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, 
       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_max, <span class="dt">fill =</span> drogue.status))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-392-1.png" width="672" /></p>
<p>Note: the basic barplot that present count or frequency has one categorical variable on the x axis and you can make with <code>geom_bar()</code>And the barplot that present the values for instance the average of the variable has one categorical variable on the <code>x</code> axis and continuos variable on the <code>y</code> axis and you create them with <code>geom_col()</code> function. You can make a grouped bar plot by mapping that variable to <code>fill</code>, which represent the fill color of the bars. Like the variables mapped to the x axis, variables that are specified to the fill color of bars must be categorical instead of continuous.</p>
<pre class="sourceCode r"><code class="sourceCode r">drifter.interest =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="dt">begin =</span> dplyr<span class="op">::</span><span class="kw">first</span>(date), <span class="dt">end =</span> dplyr<span class="op">::</span><span class="kw">last</span>(date), <span class="dt">period =</span> lubridate<span class="op">::</span><span class="kw">interval</span>(<span class="dt">start =</span> begin, <span class="dt">end =</span> end, <span class="dt">tzone =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>lubridate<span class="op">::</span><span class="kw">as.duration</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="st">&quot;hours&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(period <span class="op">&gt;</span><span class="dv">1000</span>)

drifter.interest.point =<span class="st"> </span>drifter.interest <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(drifter_confluence, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id.drifter =</span> <span class="kw">paste</span>(<span class="st">&quot;ids&quot;</span>, id, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.interest.point , <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">col =</span> id.drifter))<span class="op">+</span><span class="kw">geom_path</span>()<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">.3</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_y_latitude</span>(<span class="dt">ticks =</span> <span class="fl">.4</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
</div>
<div id="advanced-plots" class="section level2">
<h2><span class="header-section-number">14.8</span> Advanced plots</h2>
<p><strong>ggplot2</strong> with its add-in packages provides extensive capabilities for visualizing your data. You can produce 2D plots, 3D plots, and animations; you can view images; and you can create histograms, contour and surfaces plots, and other graphical representations of your data.</p>
<p>its’s fun to explore pattern over time with linegraphy. Time is so embedded in our day–to–day life tha so many aspects of visualizing temporal data are fairly intuitive. You understand thing changing and evolving—the hard part is figuring out by how much is changing and look for that change in the graph. It’s easy to glance over some lines on a plot and say something is increasing, which is good as that is the core function of visualization to help you see the patterns. But, because of averaging, we sometimes miss some subtle changes that hidden when we lumped data together.</p>
<pre class="sourceCode r"><code class="sourceCode r">chl.tb <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date), <span class="dt">year =</span> lubridate<span class="op">::</span><span class="kw">year</span>(date)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, month) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2019</span>) <span class="op">%$%</span>
<span class="st">  </span><span class="kw">interpolate2</span>(<span class="dt">x =</span> year , <span class="dt">y =</span> month, <span class="dt">z =</span> chl, <span class="dt">n =</span> <span class="dv">16</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">year =</span> x, <span class="dt">month =</span> y, <span class="dt">chl =</span> z) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(chl <span class="op">&lt;</span><span class="st"> </span><span class="fl">.4</span>)<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span>year, <span class="dt">y =</span> month, <span class="dt">z =</span> chl))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsJet</span>(<span class="dt">n =</span> <span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, 
                  <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), 
                              lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2002</span>,<span class="dv">2017</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">%+%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concetration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}))))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-394-1.png" width="672" /></p>
<p>I used <code>oce::oce.colorsJet(120)</code> and specify 120 color gradient to obtain color scheme similar to the Matlab Jet scheme. It widely used for maps but works great for general visualization like heatmaps.</p>
<div id="facets" class="section level3">
<h3><span class="header-section-number">14.8.1</span> Facets</h3>
<p>Sometimes you may wish to split your plot into facets—subplots that each display one subset of the data. Faceting is used when you wish make subplots from categorical variables. It creates multiple copies of the same type of plot with matching x and y axes. There is a <code>scale()</code>, which allows you to adjust the x and y axes according to groups in the categorical variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## list files from the working directory</span>
tafiri =<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">pattern =</span> <span class="st">&quot;tafiri_&quot;</span>)

<span class="co">## make a vector of variables. The order must be consistency with the files order in </span>
var =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chl&quot;</span>, <span class="st">&quot;pp&quot;</span>, <span class="st">&quot;sst&quot;</span>)
<span class="co">## make a vector of site. The order must be consistency with the sheets in files</span>
sites =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Zanzibar&quot;</span>, <span class="st">&quot;Mafia&quot;</span>, <span class="st">&quot;EEZ&quot;</span>)

<span class="co">## preallocate an empty object</span>
tafiri.data =<span class="st"> </span><span class="ot">NULL</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(var)){
  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sites)){
    
  data =<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="dt">path =</span> tafiri[i], <span class="dt">sheet =</span> j)<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">date =</span> <span class="dv">1</span>, <span class="dt">year =</span> <span class="dv">2</span>, <span class="dt">value =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date), 
         <span class="dt">day =</span> <span class="dv">15</span>,
         <span class="dt">site =</span> sites[j], 
         <span class="dt">variable =</span> var[i],
         <span class="dt">date =</span> lubridate<span class="op">::</span><span class="kw">make_date</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> day)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(date)
    
<span class="co">## stitch processed data frame from each sheet    </span>
tafiri.data =<span class="st"> </span>tafiri.data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_rows</span>(data)
 
  }
}</code></pre>
<p>For instance, suppose we’re interested in looking at how the hovmoller of monthly primary productivity varies over time across the four stations, We split this heatmaps by the four stations. We achieve this by simply adding <code>facet_wrap(~site, nrow = 2)</code> layer;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;February&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;August&quot;</span>, <span class="st">&quot;October&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-396-1.png" width="672" />
Note the use of the tilde <code>~</code> before the <code>site</code> in <code>facet_wrap()</code>. The tilde is required when you want specify the variable that will be used to split the plots into subplots. We can add other arguments in the <code>facet_wrap()</code> function. Let say we want our plot to be in one rows and four columns by simply adding the argument <code>nrow = 1</code></p>
</div>
<div id="sea-surface-temperature" class="section level3">
<h3><span class="header-section-number">14.8.2</span> Sea Surface Temperature</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;sst&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;February&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;August&quot;</span>, <span class="st">&quot;October&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">title =</span> <span class="kw">expression</span>(Sea<span class="op">~</span>Surface<span class="op">~</span>Temperature<span class="op">~</span>(degree<span class="op">*</span>C))))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
</div>
<div id="subplot" class="section level3">
<h3><span class="header-section-number">14.8.3</span> Subplot</h3>
<p>There are occasions when it is convenient to display several plots side-by-side. In these instances,
you will want to use the <strong>cowplot</strong> package. we first create <strong>ggplot2</strong> object of Primary productivity for the channels we are interested: for Mafia Channel we assign the name <code>mafia.pp</code> and for Zanzibar Channel <code>zanzibar.pp</code>. The chunk below show how to create the these object.</p>
<pre class="sourceCode r"><code class="sourceCode r">mafia.pp =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span> <span class="op">&amp;</span><span class="st"> </span>site <span class="op">==</span><span class="st"> &quot;Mafia&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), 
                                            lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>),<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))

zanzibar.pp =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span> <span class="op">&amp;</span><span class="st"> </span>site <span class="op">==</span><span class="st"> &quot;Zanzibar&quot;</span>),
                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), 
                                            lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>), <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>())<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),
                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, 
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), 
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))</code></pre>
<p>Once we have the <strong>ggplot2</strong> objects, we can now combine them side by side with the <code>cowplot::plot_grid()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(mafia.pp, 
                   zanzibar.pp, 
                   <span class="dt">nrow =</span> <span class="dv">1</span>, 
                   <span class="dt">rel_widths =</span> <span class="kw">c</span>(.<span class="dv">8</span>,<span class="dv">1</span>), 
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Mafia&quot;</span>, <span class="st">&quot;Zanzibar&quot;</span>), 
                   <span class="dt">label_x =</span> <span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">001</span>), 
                   <span class="dt">label_y =</span> <span class="fl">.98</span>, 
                   <span class="dt">label_fontface =</span> <span class="st">&quot;plain&quot;</span>, 
                   <span class="dt">label_size =</span> <span class="dv">12</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
<hr />
<pre class="sourceCode r"><code class="sourceCode r">profile =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station <span class="op">==</span><span class="st"> &quot;st2&quot;</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-400-1.png" width="672" /></p>
<p>This produce a scatterplot shown in figure <a href="#fig:"><strong>??</strong></a>, which shows a strong correlation as the water depth increase the temperature decrease. Using the *grammar of graphics<strong> of the </strong>ggplot2**, the structure of the code used to make figure <a href="#fig:"><strong>??</strong></a> is defined by;</p>
<ul>
<li>Data: <code>profile</code>,</li>
<li>Aesthetic mapping: <code>temperature</code> values mapped to <code>x</code> position, pressure values mapped to <code>y</code> position</li>
<li>Geometry: <code>points</code></li>
</ul>
<p>In <strong>ggplot2</strong>, a plot is created with the <code>ggplot()</code> function, where data and aesthetic mappings are supplied as arguments, then layers are added on with <code>+</code>.</p>
</div>
</div>
<div id="colour" class="section level2">
<h2><span class="header-section-number">14.9</span> Colour</h2>
<p>The aesthetic component in <strong>ggplot2</strong> allows to add additional variables to a graph. For instance, We can map the colors of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, 
           <span class="dt">y =</span> pressure, 
           <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
<div id="size" class="section level2">
<h2><span class="header-section-number">14.10</span> size</h2>
<p>The aesthetic component in <strong>ggplot2</strong> also allows to distinguish the plot with <code>size</code> of the variableh. For instance, We can map the size of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_frac</span>(.<span class="dv">25</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen, <span class="dt">size =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-402-1.png" width="672" /></p>
<p>Although we can map the temperature profile as points, it is appropriate to plot this profile as line. We can replace the <code>geom_point()</code> with <code>geom_path()</code> for that purpose</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
</div>
<div id="scaling" class="section level2">
<h2><span class="header-section-number">14.11</span> scaling</h2>
<p>A scale controls the mapping from data to aesthetic attributes. Its recommended to manipulate the scale for every aesthetic used on a plot. For example we want the x-axis labels to be position at the top and reverse the y-axis. The code can be writeen as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, 
                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, 
                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), 
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
<p>We might want to change the default color provided with <strong>ggplot2</strong> on the legend. Since we commanded the plot to display gradient colors from dissolved oxygen, We use the <code>scale_color_gradientn()</code> function. The code can be writeen as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, 
                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, 
                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), 
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_gradientn</span>(<span class="dt">colours =</span> <span class="kw">rainbow</span>(<span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rev</span>())</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-405-1.png" width="672" /></p>
</div>
<div id="guides" class="section level2">
<h2><span class="header-section-number">14.12</span> Guides</h2>
<p>Context is provided by <em>guides</em>. A guide help a human reader to understand the meaning of the visual cues. For example</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, 
       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, 
                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, 
                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), 
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_gradientn</span>(<span class="dt">colours =</span> <span class="kw">rainbow</span>(<span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rev</span>())<span class="op">+</span>
<span class="st">  </span><span class="co"># theme(legend.position = &quot;right&quot;) +</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="st">&quot;Dissolved oxygen (ml/L)&quot;</span>, 
                                <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, 
                                <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),
                                <span class="dt">barheight =</span> <span class="dv">15</span>, 
                                <span class="dt">barwidth =</span> <span class="fl">.95</span>, 
                                <span class="dt">title.hjust =</span> <span class="fl">.5</span>, 
                                <span class="dt">ticks.colour =</span> <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>),
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-407-1.png" width="672" /></p>
</div>
<div id="add-on-packages" class="section level2">
<h2><span class="header-section-number">14.13</span> Add-on packages</h2>
<p>The R community has developed packages that extend the capability of <strong>ggplot2</strong>. Some of the packages include:</p>
<ul>
<li><strong>metR</strong>: Provide addition tools for plotting filled contour, and label contour lines</li>
<li><strong>ggrepel</strong>: Contains tools for automatically position non-overlapping text labels</li>
<li><strong>ggspatial</strong>: Spatial Data Framework for <strong>ggplot2</strong></li>
<li><strong>RcolorBrewer</strong>: Contains color palettes for continuous and discrete plots</li>
<li><strong>cowplot</strong>: Contains addition themes and tools to combine <strong>ggplot2</strong> plots in one panel</li>
<li><strong>egg</strong>: Provide tools for plot aligning and symmetrised <strong>ggplot2</strong> plots</li>
<li><strong>oce</strong>: Provide color pallete for visualization of Oceanographic Data</li>
<li><strong>ggsn</strong>: Provide tools for mapping North symbols and scale bars on maps created with <strong>ggplot2</strong></li>
<li><strong>gganimate</strong>: convert static ggplot2 plots to animations</li>
<li><strong>ggformula</strong>: adds some additional plot options to <strong>ggplot2</strong></li>
<li><strong>sf</strong> : Add capabilities of <strong>ggplot2</strong> to map spatial data such as simple features</li>
<li><strong>ggthemes</strong>: contains extra themes, scales, and geoms, and functions for and related to ggplot2</li>
<li><strong>ggridges</strong>: extend the geom_density function by plotiing closed polygons insted of ridgelines</li>
</ul>
</div>
<div id="ggridges" class="section level2">
<h2><span class="header-section-number">14.14</span> ggridges</h2>
<p>Althoug ehe <strong>ggridges</strong> package provides <code>geom_ridgeline</code> and <code>geom_density_ridges</code>, we focus on the latter because it has ability to estimates data densities and then draws those using ridgelines.The geom <code>geom_density_ridges</code> calculates density estimates from the provided data and then plots those, using the ridgeline visualization.</p>
<pre class="sourceCode r"><code class="sourceCode r">ctd =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strata =</span> <span class="kw">cut</span>(<span class="dt">x =</span> pressure, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">120</span>,<span class="dv">200</span>), 
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Upper&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Lower&quot;</span>)))

ctd.strata =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(strata, pressure, lon,lat) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">temperature =</span> <span class="kw">mean</span>(temperature, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">salinity =</span> <span class="kw">mean</span>(salinity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">oxygen =</span> <span class="kw">mean</span>(oxygen, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">fluorescence =</span> <span class="kw">mean</span>(fluorescence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(strata))



<span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
<p>Trailing tails can be cut off using the <code>rel_min_height()</code> aesthetic. This aesthetic sets a percent cutoff relative to the highest point of any of the density curves. A value of 0.01 usually works well, but you may have to modify this parameter for different datasets.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-409-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="dt">scale =</span> <span class="dv">8</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =80, substantial overlap</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
</div>
<div id="varying-fill-colors-along-the-x-axis" class="section level2">
<h2><span class="header-section-number">14.15</span> Varying fill colors along the x axis</h2>
<p>Sometimes we would like to have the area under a ridgeline not filled with a single solid color but rather with colors that vary in some form along the x axis. This effect can be achieved with the geoms geom_ridgeline_gradient and geom_density_ridges_gradient. Both geoms work just like geom_ridgeline and geom_density_ridges, except that they allow for varying fill colors. However, they do not allow for alpha transparency in the fill. For technical reasons, we can have changing fill colors or transparency but not both.</p>
<p>Here is a simple example of changing fill colors with geom_ridgeline_gradient:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata,  <span class="dt">fill =</span> strata))<span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges_gradient</span>(<span class="dt">scale =</span> <span class="dv">5</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =5, substantial overlap</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-411-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata,  <span class="dt">fill =</span> ..x..))<span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges_gradient</span>(<span class="dt">scale =</span> <span class="dv">5</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =5, substantial overlap</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsTemperature</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">14</span>,<span class="dv">26</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Temperature<span class="op">~</span><span class="er">~</span>(degree<span class="op">*</span>C)),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">TRUE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
</div>
<div id="metr" class="section level2">
<h2><span class="header-section-number">14.16</span> metR</h2>
<pre class="sourceCode r"><code class="sourceCode r">transect2 =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>( lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-8</span> <span class="op">&amp;</span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-6</span> <span class="op">&amp;</span><span class="st">  </span>pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">205</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> transect2,
             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> pressure, <span class="dt">z =</span> fluorescence))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="co"># metR::geom_contour2()+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">205</span>,<span class="dv">30</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span>
<span class="st">                                               </span><span class="kw">pull</span>()<span class="op">%&gt;%</span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,.<span class="dv">2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;Water depth [m]&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), 
             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;ivory&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-413-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">depth  =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)
algoa =<span class="st"> </span><span class="ot">NULL</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(depth)){

strata =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="fl">39.3</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="fl">40.5</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-10</span> <span class="op">&amp;</span><span class="st"> </span>pressure <span class="op">==</span><span class="st"> </span>depth[i]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">9</span>)

Lon =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(lon)
Lat =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(lat)
data =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)


  <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(data)){
  
  algoa.interp =<span class="st"> </span>strata <span class="op">%$%</span><span class="st"> </span>oce<span class="op">::</span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> Lon, <span class="dt">y =</span> Lat, <span class="dt">z =</span> data[j]<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>())
  
  algoa.tb =<span class="st"> </span>algoa.interp <span class="op">%$%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> xg, <span class="dt">y =</span> yg, <span class="dt">data =</span> zg) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">colnames</span>(data[j]), <span class="dt">pressure =</span> depth[i])
  
  algoa =<span class="st"> </span>algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(algoa.tb)
  }
}

<span class="co"># algoa  %&gt;% group_by(pressure, variable) %&gt;% summarise(average = mean(value, na.rm = TRUE))</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;fluorescence&quot;</span>),
              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-415-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;temperature&quot;</span>),
              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;oxygen&quot;</span>),
              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Dissolved<span class="op">~</span>oxygen<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-417-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;salinity&quot;</span>),
              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), 
                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Salinity),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,
                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),
                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ggplot">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="raster.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-grammar-for-graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
