<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Making Maps | A glimpse of GIS and Remote Sensing with R</title>
  <meta name="description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Making Maps | A glimpse of GIS and Remote Sensing with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Making Maps | A glimpse of GIS and Remote Sensing with R" />
  
  <meta name="twitter:description" content="Introdution to geographical information system and remote sensing using an open source and powerful statical tool, R" />
  

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2019-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-grammar-for-graphics.html">
<link rel="next" href="animation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.6/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/Dygraph.Plugins.Unzoom-1.0/unzoom.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A glimpse of GIS and Remote Sensing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i>Sources</a></li>
<li class="chapter" data-level="" data-path="note-to-the-reader.html"><a href="note-to-the-reader.html"><i class="fa fa-check"></i>Note to the reader</a></li>
<li class="chapter" data-level="" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why-learn-computer-programming"><i class="fa fa-check"></i><b>1.1</b> Why learn computer Programming?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-to-program"><i class="fa fa-check"></i><b>1.2</b> Learning to program</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#programming-in-r"><i class="fa fa-check"></i><b>1.3</b> Programming in R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-r-1"><i class="fa fa-check"></i><b>1.3.1</b> What is R?</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.3.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#basic-features-of-rstudio"><i class="fa fa-check"></i><b>1.3.4</b> Basic Features of RStudio</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio-editor"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio editor</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.6</b> Rmarkdown</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#use-descriptive-names"><i class="fa fa-check"></i><b>1.3.7</b> Use descriptive names</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#use-comments"><i class="fa fa-check"></i><b>1.3.8</b> Use comments</a></li>
<li class="chapter" data-level="1.3.9" data-path="intro.html"><a href="intro.html#getting-help-in-r"><i class="fa fa-check"></i><b>1.3.9</b> Getting Help in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-started.html"><a href="get-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="get-started.html"><a href="get-started.html#maths-in-r"><i class="fa fa-check"></i><b>2.1</b> Maths in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-started.html"><a href="get-started.html#r-operators"><i class="fa fa-check"></i><b>2.1.1</b> R operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-started.html"><a href="get-started.html#precedence"><i class="fa fa-check"></i><b>2.1.2</b> Precedence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-started.html"><a href="get-started.html#assignment-operator"><i class="fa fa-check"></i><b>2.2</b> Assignment operator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-started.html"><a href="get-started.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-started.html"><a href="get-started.html#naming-conventions"><i class="fa fa-check"></i><b>2.2.2</b> Naming conventions</a></li>
<li class="chapter" data-level="2.2.3" data-path="get-started.html"><a href="get-started.html#functions"><i class="fa fa-check"></i><b>2.2.3</b> Functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="get-started.html"><a href="get-started.html#essential-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-started.html"><a href="get-started.html#wdirectory"><i class="fa fa-check"></i><b>2.3</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.4" data-path="get-started.html"><a href="get-started.html#packages-or-libraries"><i class="fa fa-check"></i><b>2.4</b> Packages or Libraries</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-started.html"><a href="get-started.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-started.html"><a href="get-started.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="get-started.html"><a href="get-started.html#understanding-data-in-r"><i class="fa fa-check"></i><b>2.5</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="get-started.html"><a href="get-started.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="get-started.html"><a href="get-started.html#vectors"><i class="fa fa-check"></i><b>2.5.2</b> Vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="get-started.html"><a href="get-started.html#indexing-the-element"><i class="fa fa-check"></i><b>2.5.3</b> Indexing the element</a></li>
<li class="chapter" data-level="2.5.4" data-path="get-started.html"><a href="get-started.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>2.5.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="2.5.5" data-path="get-started.html"><a href="get-started.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>2.5.5</b> Number of elements in a vector</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="get-started.html"><a href="get-started.html#data-frame"><i class="fa fa-check"></i><b>2.6</b> Data Frame</a></li>
<li class="chapter" data-level="2.7" data-path="get-started.html"><a href="get-started.html#tibbles"><i class="fa fa-check"></i><b>2.7</b> tibbles</a><ul>
<li class="chapter" data-level="2.7.1" data-path="get-started.html"><a href="get-started.html#column-names"><i class="fa fa-check"></i><b>2.7.1</b> Column Names</a></li>
<li class="chapter" data-level="2.7.2" data-path="get-started.html"><a href="get-started.html#add-rows-and-columns"><i class="fa fa-check"></i><b>2.7.2</b> Add rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="get-started.html"><a href="get-started.html#exercise"><i class="fa fa-check"></i><b>2.8</b> Exercise</a></li>
<li class="chapter" data-level="2.9" data-path="get-started.html"><a href="get-started.html#exercise-1"><i class="fa fa-check"></i><b>2.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html"><i class="fa fa-check"></i><b>3</b> Get familiar with R Markdown</a><ul>
<li class="chapter" data-level="3.1" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#r-markdown"><i class="fa fa-check"></i><b>3.1</b> R Markdown</a></li>
<li class="chapter" data-level="3.2" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#text-formating"><i class="fa fa-check"></i><b>3.2</b> Text Formating</a></li>
<li class="chapter" data-level="3.3" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#hyperlinks"><i class="fa fa-check"></i><b>3.3</b> Hyperlinks</a></li>
<li class="chapter" data-level="3.4" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#images"><i class="fa fa-check"></i><b>3.4</b> Images</a></li>
<li class="chapter" data-level="3.5" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#tables"><i class="fa fa-check"></i><b>3.5</b> Tables</a></li>
<li class="chapter" data-level="3.6" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#cross-referencing"><i class="fa fa-check"></i><b>3.6</b> Cross-referencing</a></li>
<li class="chapter" data-level="3.7" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#bibliographies"><i class="fa fa-check"></i><b>3.7</b> Bibliographies</a></li>
<li class="chapter" data-level="3.8" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#create-.rmd-file"><i class="fa fa-check"></i><b>3.8</b> Create .Rmd FIle</a></li>
<li class="chapter" data-level="3.9" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#rendering-markdown"><i class="fa fa-check"></i><b>3.9</b> Rendering Markdown</a></li>
<li class="chapter" data-level="3.10" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#structure-of-an-rmarkdown-file"><i class="fa fa-check"></i><b>3.10</b> Structure of an Rmarkdown FIle</a></li>
<li class="chapter" data-level="3.11" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inserting-code-chunk"><i class="fa fa-check"></i><b>3.11</b> Inserting code chunk</a></li>
<li class="chapter" data-level="3.12" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-name"><i class="fa fa-check"></i><b>3.12</b> Chunk name</a></li>
<li class="chapter" data-level="3.13" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#chunk-options"><i class="fa fa-check"></i><b>3.13</b> Chunk options</a></li>
<li class="chapter" data-level="3.14" data-path="get-familiar-with-r-markdown.html"><a href="get-familiar-with-r-markdown.html#inline-code"><i class="fa fa-check"></i><b>3.14</b> Inline code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>4</b> Understanding Data in R</a><ul>
<li class="chapter" data-level="4.0.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types-1"><i class="fa fa-check"></i><b>4.0.1</b> Data Types</a></li>
<li class="chapter" data-level="4.0.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors-1"><i class="fa fa-check"></i><b>4.0.2</b> Vectors</a></li>
<li class="chapter" data-level="4.0.3" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element-1"><i class="fa fa-check"></i><b>4.0.3</b> Indexing the element</a></li>
<li class="chapter" data-level="4.0.4" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.4</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="4.0.5" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector-1"><i class="fa fa-check"></i><b>4.0.5</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="4.0.6" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>4.0.6</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="4.0.7" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>4.0.7</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="4.0.8" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>4.0.8</b> Rounding off numbers</a></li>
<li class="chapter" data-level="4.1" data-path="dataTypes.html"><a href="dataTypes.html#data-frame-1"><i class="fa fa-check"></i><b>4.1</b> Data Frame</a><ul>
<li class="chapter" data-level="4.1.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>4.1.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>4.2</b> Matrix</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>4.2.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>4.2.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>4.3</b> Arrays</a></li>
<li class="chapter" data-level="4.4" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>4.4</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>5</b> Vector Data</a><ul>
<li class="chapter" data-level="5.1" data-path="vector.html"><a href="vector.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="vector.html"><a href="vector.html#numeric-vector"><i class="fa fa-check"></i><b>5.2</b> Numeric Vector</a></li>
<li class="chapter" data-level="5.3" data-path="vector.html"><a href="vector.html#integer-vector"><i class="fa fa-check"></i><b>5.3</b> Integer vector</a></li>
<li class="chapter" data-level="5.4" data-path="vector.html"><a href="vector.html#character-vector"><i class="fa fa-check"></i><b>5.4</b> Character vector</a></li>
<li class="chapter" data-level="5.5" data-path="vector.html"><a href="vector.html#logical-vector"><i class="fa fa-check"></i><b>5.5</b> Logical Vector</a></li>
<li class="chapter" data-level="5.6" data-path="vector.html"><a href="vector.html#vector-data"><i class="fa fa-check"></i><b>5.6</b> Vector Data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="vector.html"><a href="vector.html#simple-features"><i class="fa fa-check"></i><b>5.6.1</b> Simple features</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="vector.html"><a href="vector.html#reading-vector-data"><i class="fa fa-check"></i><b>5.7</b> Reading vector data</a><ul>
<li class="chapter" data-level="5.7.1" data-path="vector.html"><a href="vector.html#reading-shapefiles"><i class="fa fa-check"></i><b>5.7.1</b> Reading shapefiles</a></li>
<li class="chapter" data-level="5.7.2" data-path="vector.html"><a href="vector.html#reading-gpx-file"><i class="fa fa-check"></i><b>5.7.2</b> Reading GPX file</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="vector.html"><a href="vector.html#make-shapefiles-from-tabular-data"><i class="fa fa-check"></i><b>5.8</b> Make shapefiles from Tabular data</a></li>
<li class="chapter" data-level="5.9" data-path="vector.html"><a href="vector.html#export-simple-feature-as-shapefile"><i class="fa fa-check"></i><b>5.9</b> Export simple feature as shapefile</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Introduction to tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>6.1</b> readr</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>6.2</b> dplyr</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#tidyr"><i class="fa fa-check"></i><b>6.3</b> tidyr</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#ggplot2"><i class="fa fa-check"></i><b>6.4</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#readr"><i class="fa fa-check"></i><b>7</b> Importing data with <strong>readr</strong></a><ul>
<li class="chapter" data-level="7.1" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>7.1</b> <em>Comma-Separated (.csv)</em></a></li>
<li class="chapter" data-level="7.2" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>7.2</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="7.3" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>7.3</b> Writing t a File</a></li>
<li class="chapter" data-level="7.4" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>7.4</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="7.4.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>7.4.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="7.4.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>7.4.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>8</b> Reshaping data with <strong>tidyr</strong></a><ul>
<li class="chapter" data-level="8.1" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>8.1</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="8.2" data-path="tidy.html"><a href="tidy.html#spread-from-long-to-wide-format"><i class="fa fa-check"></i><b>8.2</b> spread() —from long to wide format</a></li>
<li class="chapter" data-level="8.3" data-path="tidy.html"><a href="tidy.html#separate"><i class="fa fa-check"></i><b>8.3</b> separate()</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>9</b> Manipulating Data with <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="9.1" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>9.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="9.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>9.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="9.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>9.3</b> Data</a></li>
<li class="chapter" data-level="9.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>9.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="9.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>9.5</b> select</a><ul>
<li class="chapter" data-level="9.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>9.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="9.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>9.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>9.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html"><i class="fa fa-check"></i><b>10</b> Working with Dates and Time</a><ul>
<li class="chapter" data-level="10.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#getting-the-date-and-time-with-localtime"><i class="fa fa-check"></i><b>10.1</b> Getting the Date and Time with localtime</a></li>
<li class="chapter" data-level="10.2" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-strings-to-dates"><i class="fa fa-check"></i><b>10.2</b> Converting strings to Dates</a><ul>
<li class="chapter" data-level="10.2.1" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#convert-strings-to-dates"><i class="fa fa-check"></i><b>10.2.1</b> convert strings to dates</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#converting-date-with-lubridate-package"><i class="fa fa-check"></i><b>10.3</b> Converting date with <strong>lubridate</strong> package</a></li>
<li class="chapter" data-level="10.4" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#create-dates-by-merging-data"><i class="fa fa-check"></i><b>10.4</b> Create Dates by Merging Data</a></li>
<li class="chapter" data-level="10.5" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#isodate-converts-to-a-posixct-object"><i class="fa fa-check"></i><b>10.5</b> ISOdate converts to a POSIXct object</a></li>
<li class="chapter" data-level="10.6" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#extract-and-manipulate-parts-of-dates"><i class="fa fa-check"></i><b>10.6</b> Extract and Manipulate Parts of Dates</a></li>
<li class="chapter" data-level="10.7" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#creating-date-sequences"><i class="fa fa-check"></i><b>10.7</b> Creating Date Sequences</a></li>
<li class="chapter" data-level="10.8" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#calculations-with-dates"><i class="fa fa-check"></i><b>10.8</b> Calculations with Dates</a></li>
<li class="chapter" data-level="10.9" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-difference-of-15-days"><i class="fa fa-check"></i><b>10.9</b> Time difference of 15 days</a></li>
<li class="chapter" data-level="10.10" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#example-with-time-zones"><i class="fa fa-check"></i><b>10.10</b> example with time zones</a></li>
<li class="chapter" data-level="10.11" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#time-interval"><i class="fa fa-check"></i><b>10.11</b> Time Interval</a></li>
<li class="chapter" data-level="10.12" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#ctd-list"><i class="fa fa-check"></i><b>10.12</b> ctd list</a></li>
<li class="chapter" data-level="10.13" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#arithmetic-with-date-times"><i class="fa fa-check"></i><b>10.13</b> Arithmetic with date times</a></li>
<li class="chapter" data-level="10.14" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#dealing-with-time-zones"><i class="fa fa-check"></i><b>10.14</b> Dealing with Time Zones</a></li>
<li class="chapter" data-level="10.15" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#case-study-working-with-date-and-time-of-argo-float-observations"><i class="fa fa-check"></i><b>10.15</b> Case study: Working with Date and Time of Argo float observations</a></li>
<li class="chapter" data-level="10.16" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-1"><i class="fa fa-check"></i><b>10.16</b> Data</a></li>
<li class="chapter" data-level="10.17" data-path="working-with-dates-and-time.html"><a href="working-with-dates-and-time.html#data-processing"><i class="fa fa-check"></i><b>10.17</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>11</b> Control flow</a><ul>
<li class="chapter" data-level="11.1" data-path="control-flow.html"><a href="control-flow.html#for-loop"><i class="fa fa-check"></i><b>11.1</b> for loop</a><ul>
<li class="chapter" data-level="11.1.1" data-path="control-flow.html"><a href="control-flow.html#for-loop-on-array"><i class="fa fa-check"></i><b>11.1.1</b> For loop on array</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="control-flow.html"><a href="control-flow.html#if-and-else-statement"><i class="fa fa-check"></i><b>11.2</b> if and else statement</a></li>
<li class="chapter" data-level="11.3" data-path="control-flow.html"><a href="control-flow.html#functions-1"><i class="fa fa-check"></i><b>11.3</b> Functions</a><ul>
<li class="chapter" data-level="11.3.1" data-path="control-flow.html"><a href="control-flow.html#core-functions"><i class="fa fa-check"></i><b>11.3.1</b> core functions</a></li>
<li class="chapter" data-level="11.3.2" data-path="control-flow.html"><a href="control-flow.html#user-defined-functions"><i class="fa fa-check"></i><b>11.3.2</b> user defined functions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="control-flow.html"><a href="control-flow.html#packages"><i class="fa fa-check"></i><b>11.4</b> packages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functions-and-packages.html"><a href="functions-and-packages.html"><i class="fa fa-check"></i><b>12</b> Functions and packages</a><ul>
<li class="chapter" data-level="12.0.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#core-functions-1"><i class="fa fa-check"></i><b>12.0.1</b> core functions</a></li>
<li class="chapter" data-level="12.0.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#user-defined-functions-1"><i class="fa fa-check"></i><b>12.0.2</b> user defined functions</a></li>
<li class="chapter" data-level="12.1" data-path="functions-and-packages.html"><a href="functions-and-packages.html#packages-1"><i class="fa fa-check"></i><b>12.1</b> packages</a></li>
<li class="chapter" data-level="12.2" data-path="functions-and-packages.html"><a href="functions-and-packages.html#function-pipelines"><i class="fa fa-check"></i><b>12.2</b> function pipelines</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>13</b> Raster Data</a><ul>
<li class="chapter" data-level="13.1" data-path="raster.html"><a href="raster.html#introduction-to-raster-data"><i class="fa fa-check"></i><b>13.1</b> Introduction to Raster data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="raster.html"><a href="raster.html#geotiff"><i class="fa fa-check"></i><b>13.1.1</b> GeoTiff</a></li>
<li class="chapter" data-level="13.1.2" data-path="raster.html"><a href="raster.html#explore-the-raster-attribute"><i class="fa fa-check"></i><b>13.1.2</b> Explore the raster attribute</a></li>
<li class="chapter" data-level="13.1.3" data-path="raster.html"><a href="raster.html#read-a-geotiff-raster-data"><i class="fa fa-check"></i><b>13.1.3</b> Read a GeoTIFF raster data</a></li>
<li class="chapter" data-level="13.1.4" data-path="raster.html"><a href="raster.html#view-raster-coordinate-reference-system"><i class="fa fa-check"></i><b>13.1.4</b> View Raster Coordinate Reference System</a></li>
<li class="chapter" data-level="13.1.5" data-path="raster.html"><a href="raster.html#dealing-with-missing-data-in-raster"><i class="fa fa-check"></i><b>13.1.5</b> Dealing with missing data in raster</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="raster.html"><a href="raster.html#assign-projection-and-reproject-raster-data-in-r"><i class="fa fa-check"></i><b>13.2</b> Assign projection and Reproject Raster Data in R</a></li>
<li class="chapter" data-level="13.3" data-path="raster.html"><a href="raster.html#raster-resolution"><i class="fa fa-check"></i><b>13.3</b> Raster resolution</a></li>
<li class="chapter" data-level="13.4" data-path="raster.html"><a href="raster.html#raster-calculation"><i class="fa fa-check"></i><b>13.4</b> Raster Calculation</a></li>
<li class="chapter" data-level="13.5" data-path="raster.html"><a href="raster.html#multi-bands-satellite-imagery"><i class="fa fa-check"></i><b>13.5</b> Multi-bands satellite imagery</a><ul>
<li class="chapter" data-level="13.5.1" data-path="raster.html"><a href="raster.html#rater-stacks"><i class="fa fa-check"></i><b>13.5.1</b> Rater Stacks</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="raster.html"><a href="raster.html#manipulate-raster"><i class="fa fa-check"></i><b>13.6</b> Manipulate raster</a></li>
<li class="chapter" data-level="13.7" data-path="raster.html"><a href="raster.html#raster-time-series-data"><i class="fa fa-check"></i><b>13.7</b> Raster time series data</a></li>
<li class="chapter" data-level="13.8" data-path="raster.html"><a href="raster.html#comparing-ndvi-from-two-different-sites"><i class="fa fa-check"></i><b>13.8</b> comparing NDVI from Two different sites</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>14</b> Plotting in R with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="14.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>14.1</b> A dataset</a></li>
<li class="chapter" data-level="14.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>14.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="14.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>14.3</b> Building a plot</a><ul>
<li class="chapter" data-level="14.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>14.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="14.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>14.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="14.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>14.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>14.4</b> Customize glidline and axis labels</a><ul>
<li class="chapter" data-level="14.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>14.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>14.5</b> Modify the position of the legend</a><ul>
<li class="chapter" data-level="14.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>14.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="14.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>14.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="14.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>14.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="14.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>14.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="14.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>14.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="14.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>14.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="14.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>14.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="14.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>14.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="14.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>14.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="14.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>14.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>14.6</b> Basic plots</a><ul>
<li class="chapter" data-level="14.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>14.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="14.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>14.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>14.7</b> Linegraph</a><ul>
<li class="chapter" data-level="14.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>14.7.1</b> histogram</a></li>
<li class="chapter" data-level="14.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>14.7.2</b> boxplot</a></li>
<li class="chapter" data-level="14.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>14.7.3</b> barplot</a></li>
<li class="chapter" data-level="14.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>14.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>14.8</b> Advanced plots</a><ul>
<li class="chapter" data-level="14.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>14.8.1</b> Facets</a></li>
<li class="chapter" data-level="14.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>14.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="14.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>14.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>14.9</b> Colour</a></li>
<li class="chapter" data-level="14.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>14.10</b> size</a></li>
<li class="chapter" data-level="14.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>14.11</b> scaling</a></li>
<li class="chapter" data-level="14.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>14.12</b> Guides</a></li>
<li class="chapter" data-level="14.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>14.13</b> Add-on packages</a></li>
<li class="chapter" data-level="14.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>14.14</b> ggridges</a></li>
<li class="chapter" data-level="14.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>14.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="14.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>14.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>15</b> A grammar for graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>15.1</b> geoms</a><ul>
<li class="chapter" data-level="15.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>15.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="15.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>15.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>15.2</b> aes()</a><ul>
<li class="chapter" data-level="15.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>15.2.1</b> Color</a></li>
<li class="chapter" data-level="15.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>15.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>15.3</b> Axis and labels</a></li>
<li class="chapter" data-level="15.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>15.4</b> Text annotaion</a></li>
<li class="chapter" data-level="15.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>15.5</b> Scales</a></li>
<li class="chapter" data-level="15.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>15.6</b> Guides</a></li>
<li class="chapter" data-level="15.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>15.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>16</b> Making Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="graphics.html"><a href="graphics.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>16.1</b> Geographical data in a tidy format</a><ul>
<li class="chapter" data-level="16.1.1" data-path="graphics.html"><a href="graphics.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>16.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="16.1.2" data-path="graphics.html"><a href="graphics.html#importing-shapefile"><i class="fa fa-check"></i><b>16.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="16.1.3" data-path="graphics.html"><a href="graphics.html#reading-other-format"><i class="fa fa-check"></i><b>16.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="graphics.html"><a href="graphics.html#introduction-1"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="graphics.html"><a href="graphics.html#static-maps"><i class="fa fa-check"></i><b>16.3</b> Static Maps</a><ul>
<li class="chapter" data-level="16.3.1" data-path="graphics.html"><a href="graphics.html#the-bathmetry-data"><i class="fa fa-check"></i><b>16.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="graphics.html"><a href="graphics.html#basemap"><i class="fa fa-check"></i><b>16.4</b> Basemap</a></li>
<li class="chapter" data-level="16.5" data-path="graphics.html"><a href="graphics.html#creating-contour-map"><i class="fa fa-check"></i><b>16.5</b> Creating contour map</a></li>
<li class="chapter" data-level="16.6" data-path="graphics.html"><a href="graphics.html#inset-maps"><i class="fa fa-check"></i><b>16.6</b> Inset maps</a><ul>
<li class="chapter" data-level="16.6.1" data-path="graphics.html"><a href="graphics.html#choropleth-maps"><i class="fa fa-check"></i><b>16.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="graphics.html"><a href="graphics.html#animated-maps"><i class="fa fa-check"></i><b>16.7</b> Animated maps</a></li>
<li class="chapter" data-level="16.8" data-path="graphics.html"><a href="graphics.html#interactive-maps"><i class="fa fa-check"></i><b>16.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="animation.html"><a href="animation.html"><i class="fa fa-check"></i><b>17</b> Animation</a><ul>
<li class="chapter" data-level="17.1" data-path="animation.html"><a href="animation.html#animation-1"><i class="fa fa-check"></i><b>17.1</b> Animation</a></li>
<li class="chapter" data-level="17.2" data-path="animation.html"><a href="animation.html#isosurface"><i class="fa fa-check"></i><b>17.2</b> isosurface</a></li>
<li class="chapter" data-level="17.3" data-path="animation.html"><a href="animation.html#checking-for-proper-interpolation-methods"><i class="fa fa-check"></i><b>17.3</b> checking for proper interpolation methods</a><ul>
<li class="chapter" data-level="17.3.1" data-path="animation.html"><a href="animation.html#fluorescence-section"><i class="fa fa-check"></i><b>17.3.1</b> Fluorescence section</a></li>
<li class="chapter" data-level="17.3.2" data-path="animation.html"><a href="animation.html#temperature-section"><i class="fa fa-check"></i><b>17.3.2</b> Temperature section</a></li>
<li class="chapter" data-level="17.3.3" data-path="animation.html"><a href="animation.html#dissolved-oxygen-section"><i class="fa fa-check"></i><b>17.3.3</b> Dissolved Oxygen section</a></li>
<li class="chapter" data-level="17.3.4" data-path="animation.html"><a href="animation.html#salinity-section"><i class="fa fa-check"></i><b>17.3.4</b> Salinity section</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="forecast-time-series.html"><a href="forecast-time-series.html"><i class="fa fa-check"></i><b>18</b> Forecast time series</a><ul>
<li class="chapter" data-level="18.1" data-path="forecast-time-series.html"><a href="forecast-time-series.html#introduction-2"><i class="fa fa-check"></i><b>18.1</b> introduction</a></li>
<li class="chapter" data-level="18.2" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-2"><i class="fa fa-check"></i><b>18.2</b> Data</a></li>
<li class="chapter" data-level="18.3" data-path="forecast-time-series.html"><a href="forecast-time-series.html#data-processing-1"><i class="fa fa-check"></i><b>18.3</b> Data processing</a></li>
<li class="chapter" data-level="18.4" data-path="forecast-time-series.html"><a href="forecast-time-series.html#forecasting"><i class="fa fa-check"></i><b>18.4</b> Forecasting</a></li>
<li class="chapter" data-level="18.5" data-path="forecast-time-series.html"><a href="forecast-time-series.html#visualize-the-forecasted-values"><i class="fa fa-check"></i><b>18.5</b> Visualize the forecasted values</a></li>
<li class="chapter" data-level="18.6" data-path="forecast-time-series.html"><a href="forecast-time-series.html#conclusion"><i class="fa fa-check"></i><b>18.6</b> conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="reading-netcdf.html"><a href="reading-netcdf.html"><i class="fa fa-check"></i><b>19</b> Reading NetCDF</a><ul>
<li class="chapter" data-level="19.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#introduction-3"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#types-of-netcdf-file"><i class="fa fa-check"></i><b>19.2</b> Types of netCDF file</a></li>
<li class="chapter" data-level="19.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#rading-netcdf-with-ncdf4-package"><i class="fa fa-check"></i><b>19.3</b> Rading NetCDF with ncdf4 package</a><ul>
<li class="chapter" data-level="19.3.1" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-dimensions"><i class="fa fa-check"></i><b>19.3.1</b> Extracting the dimensions</a></li>
<li class="chapter" data-level="19.3.2" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-time"><i class="fa fa-check"></i><b>19.3.2</b> Extracting time</a></li>
<li class="chapter" data-level="19.3.3" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-latitude"><i class="fa fa-check"></i><b>19.3.3</b> Extracting Latitude</a></li>
<li class="chapter" data-level="19.3.4" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-longitude"><i class="fa fa-check"></i><b>19.3.4</b> Extracting Longitude</a></li>
<li class="chapter" data-level="19.3.5" data-path="reading-netcdf.html"><a href="reading-netcdf.html#extracting-the-variable"><i class="fa fa-check"></i><b>19.3.5</b> Extracting the variable</a></li>
<li class="chapter" data-level="19.3.6" data-path="reading-netcdf.html"><a href="reading-netcdf.html#replace-fillvalue-with-na"><i class="fa fa-check"></i><b>19.3.6</b> Replace FillValue with NA</a></li>
<li class="chapter" data-level="19.3.7" data-path="reading-netcdf.html"><a href="reading-netcdf.html#obtain-a-slice"><i class="fa fa-check"></i><b>19.3.7</b> Obtain a slice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="packages-2.html"><a href="packages-2.html"><i class="fa fa-check"></i><b>20</b> packages</a><ul>
<li class="chapter" data-level="20.1" data-path="packages-2.html"><a href="packages-2.html#one-sample-t-test"><i class="fa fa-check"></i><b>20.1</b> One Sample t Test</a></li>
<li class="chapter" data-level="20.2" data-path="packages-2.html"><a href="packages-2.html#paired-t-test"><i class="fa fa-check"></i><b>20.2</b> Paired t test</a></li>
<li class="chapter" data-level="20.3" data-path="packages-2.html"><a href="packages-2.html#levenes-test"><i class="fa fa-check"></i><b>20.3</b> Levene’s Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A glimpse of GIS and Remote Sensing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> Making Maps</h1>
<p>Along with all the geographical data makingits way into the public domain, a variety of tools to map that data have also been devoped. For a long time R base provides tools to map geographical data—data with latitude and longitude coordinates attached to it. However, mapping in the early days of R was not easy, it was not elegant either. Recently, some packages have been deveoped for mapping geographical data that align with the <strong>ggplot</strong> framework. So they allow us to map spatial data in similar ways as other plots, because mapping also is based on the <em>grammar of graphic</em> principle. For example Edzer Pebesma <span class="citation">(<a href="#ref-sf">2018</a>)</span> developed an awesome <strong>sf</strong> package for mapping vector data in R. The power of this function lies in the fact that it structure the spatial data in tidy format, allowing for easy manipulation with the tidyverse function and also for plotting with the <strong>ggplot2</strong> flavor. The <strong>sf</strong> package allows you to read in and work with geogrphica data in a tidy format.</p>
<div id="geographical-data-in-a-tidy-format" class="section level2">
<h2><span class="header-section-number">16.1</span> Geographical data in a tidy format</h2>
<p>The <strong>sf</strong> package allows you to create a <code>simple feature</code>—a data frame with additional columns that hold spatial component called the <code>geometry</code>. This column contains the geometrical nature of the data needed to draw the data. Often the <code>sf</code> object has two classes—the <code>simple feature</code> and the <code>data.fram</code>e classes. The <code>data.frame</code> holds attribute information of the dataset and the <code>geometry</code> contains the geographical coordinates. For example, the simple feature displayed below is a dataset of sampling stations, where each row gives the data for each station. The data.frame here holds the first four columns— the <code>id</code>, <code>type</code>, <code>depth</code> and <code>sst</code>, whereas the <code>geometry</code> column include the <code>geometry</code> type, for this case the <code>point</code> and the embedded <code>latitude</code> and <code>longitude</code> geographical coordinates. There different ways to create simple feature in R using the <strong>sf</strong> package. We will create a few of them later that we will use for mapping examples.</p>
<pre><code>FALSE Reading layer `simple_feature&#39; from data source `E:\bookdown\spatil_r\data\simple_feature.shp&#39; using driver `ESRI Shapefile&#39;
FALSE Simple feature collection with 11 features and 4 fields
FALSE geometry type:  POINT
FALSE dimension:      XY
FALSE bbox:           xmin: 39.50958 ymin: -8.425115 xmax: 42.00623 ymax: -6.414011
FALSE epsg (SRID):    4326
FALSE proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre><code>FALSE Simple feature collection with 11 features and 4 fields
FALSE geometry type:  POINT
FALSE dimension:      XY
FALSE bbox:           xmin: 39.50958 ymin: -8.425115 xmax: 42.00623 ymax: -6.414011
FALSE epsg (SRID):    4326
FALSE proj4string:    +proj=longlat +datum=WGS84 +no_defs
FALSE First 10 features:
FALSE     id   type depth      sst                   geometry
FALSE 1  294 marker    29 27.87999 POINT (39.50958 -6.438159)
FALSE 2  300 marker  -604 27.97999  POINT (39.6318 -6.621774)
FALSE 3  306 marker  -569 27.97999 POINT (39.65447 -6.746649)
FALSE 4  312 marker  -485 28.03999 POINT (39.62563 -6.805321)
FALSE 5  318 marker  -325 28.03999 POINT (39.58374 -6.833973)
FALSE 6  326 marker  -461 28.03999 POINT (39.66476 -6.837384)
FALSE 7  414 marker  -505 28.02999 POINT (39.95728 -7.843535)
FALSE 8  428 marker  -132 28.23999 POINT (39.67712 -8.136846)
FALSE 9  434 marker  -976 28.16999 POINT (39.74853 -8.425115)
FALSE 10 456 marker -3311 28.33999 POINT (42.00623 -7.025368)</code></pre>
<div id="create-simple-feature-from-data.frame" class="section level3">
<h3><span class="header-section-number">16.1.1</span> Create simple feature from data.frame</h3>
<p>If you have a regular dataframe, you can convert it into a <code>simple feature</code> object with tools in the <strong>sf</strong> package. For instance, in the working directory we have a dataset of eleven stations named <code>points.csv</code>. We can simply import this dataset into R session with the <code>read_csv()</code> function. If we print the file, it give about the variables and rows presented in the datasete. There six variables—id, type, depth and sst along with the latitude and longitude coordinates. These stations contains measured variable of sea surface temperature and their maximum depth.</p>
<pre class="sourceCode r"><code class="sourceCode r">stations =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;./data/points.csv&quot;</span>)
stations</code></pre>
<pre><code># A tibble: 11 x 6
     lon   lat    id type   depth   sst
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1  39.5 -6.44   294 marker    29  27.9
 2  39.6 -6.62   300 marker  -604  28.0
 3  39.7 -6.75   306 marker  -569  28.0
 4  39.6 -6.81   312 marker  -485  28.0
 5  39.6 -6.83   318 marker  -325  28.0
 6  39.7 -6.84   326 marker  -461  28.0
 7  40.0 -7.84   414 marker  -505  28.0
 8  39.7 -8.14   428 marker  -132  28.2
 9  39.7 -8.43   434 marker  -976  28.2
10  42.0 -7.03   456 marker -3311  28.3
11  41.8 -6.41   462 marker -3248  28.6</code></pre>
<p>Athough this dataset contains geographical coordinates in it (latitude and longitude), it’s just a regular data frame. We can use the geographical coordinates in the dataframe to convert it to simple feature with the <code>st_as_sf()</code> function, and specify the columns with the geographical information using the <code>coords</code> parameter.</p>
<pre class="sourceCode r"><code class="sourceCode r">simple_feature =<span class="st"> </span>stations <span class="op">%&gt;%</span>
<span class="st">  </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>))</code></pre>
<p>Once we have the simple feature object, we can set the geographica coordinate system to <code>World Geodetic System</code> of 1984 (WGS84). I prefer using its code, which is easy to punch in instead of the whole text. If we print out the simple feature we just created, it gives the extra information at the top of the print-out, which include the number of features and columls(fields), the geometry type as <code>point</code>, the geographical extent (the bounding box) of and the projection both in <code>epsg</code> code and <code>string</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">simple_feature =<span class="st"> </span>simple_feature <span class="op">%&gt;%</span>
<span class="st">  </span>sf<span class="op">::</span><span class="kw">st_set_crs</span>(<span class="dv">4326</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> simple_feature, <span class="kw">aes</span>(<span class="dt">col =</span> sst, <span class="dt">size =</span> <span class="kw">inverse_hyperbolic</span>((sst))))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-460-1.png" width="672" /></p>
</div>
<div id="importing-shapefile" class="section level3">
<h3><span class="header-section-number">16.1.2</span> Importing shapefile</h3>
<p>When you create maps, you will often want to import shapefile—a widely used format for storing geographical data in GIS. <strong>sf</strong> package offers tools to read and load shapefiles into R. Let’s import africa’s country boundary shapefile from the working directory. We use the st_read() function from <strong>sf</strong> package to read the shapefile boundary layer. Like the simple features we created, the shapefile also display extra information at the top confirming that it’s no longer a shapefile but rather a simple feature.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## read</span>
africa =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="st">&quot;./data/africa.shp&quot;</span>)</code></pre>
<pre><code>Reading layer `africa&#39; from data source `E:\bookdown\spatil_r\data\africa.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 59 features and 7 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -25.35875 ymin: -34.83983 xmax: 57.80085 ymax: 37.34962
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">africa</code></pre>
<pre><code>Simple feature collection with 59 features and 7 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -25.35875 ymin: -34.83983 xmax: 57.80085 ymax: 37.34962
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   COUNT               CNTRY_NAME FIPS_CNTRY LAND_AREA_ REGIONA
1     34                   Angola         AO     124670    &lt;NA&gt;
2    114                  Burundi         BY       2783    &lt;NA&gt;
3     77                    Benin         BN      11262    &lt;NA&gt;
4    301             Burkina Faso         UV      27400    &lt;NA&gt;
5     25                 Botswana         BC      58173    &lt;NA&gt;
6     51 Central African Republic         CT      62298    &lt;NA&gt;
7     51                 Cameroon         CM      47544    &lt;NA&gt;
8    186              Ivory Coast         IV      32246    &lt;NA&gt;
9     46                    Congo         CF      34200    &lt;NA&gt;
10    15               Cape Verde         CV        403    &lt;NA&gt;
   EMPTY EMPTY2                       geometry
1      0      0 MULTIPOLYGON (((12.84118 -6...
2      0      0 MULTIPOLYGON (((29.05021 -2...
3      0      0 MULTIPOLYGON (((3.849006 10...
4      0      0 MULTIPOLYGON (((-5.272945 1...
5      0      0 MULTIPOLYGON (((23.14635 -1...
6      0      0 MULTIPOLYGON (((22.03557 4....
7      0      0 MULTIPOLYGON (((9.640797 3....
8      0      0 MULTIPOLYGON (((-6.091862 4...
9      0      0 MULTIPOLYGON (((16.45276 2....
10     0      0 MULTIPOLYGON (((-24.64849 1...</code></pre>
<p>Since the layer is for the whole Africa, to reduce the processing time, we must reduce the geographical extent to the area of interest. We use the <code>st_crop()</code> function to chop the area that we want to map and discard the rest.</p>
<pre class="sourceCode r"><code class="sourceCode r">kimbiji =<span class="st"> </span>africa <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>sf<span class="op">::</span><span class="kw">st_crop</span>(<span class="dt">xmin =</span> <span class="fl">38.0</span>,
              <span class="dt">xmax =</span> <span class="fl">40.5</span>, 
              <span class="dt">ymin =</span> <span class="dv">-8</span>, 
              <span class="dt">ymax =</span> <span class="fl">-5.5</span>)</code></pre>
</div>
<div id="reading-other-format" class="section level3">
<h3><span class="header-section-number">16.1.3</span> Reading other format</h3>
<p>Sometimes you have geographical data that are neither in tabular form or shapefile. In that situation, you ought to use the <code>st_layers()</code> function to identify, first the driver used to create the file and, second, the layer name you want to extract. Once you have identified the layer of interest, you can use the <code>st_read()</code> function to import the layer from the file. For example, we have the track file that was recorded with a GPS device. Let’s explore the layer it contains with the `st_layers() function.</p>
<pre class="sourceCode r"><code class="sourceCode r">tracks =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_layers</span>(<span class="st">&quot;./tracks/Track-181204-075451.gpx&quot;</span>)
tracks</code></pre>
<pre><code>Driver: GPX 
Available layers:
    layer_name     geometry_type features fields
1    waypoints             Point        1     19
2       routes       Line String        0     12
3       tracks Multi Line String        1     12
4 route_points             Point        0     21
5 track_points             Point     1467     24</code></pre>
<p>Once we print, it shows that i’s a GPX format with five layer’s name. We are only interested with the <code>tracks</code> and <code>track_points</code> layers. We can extract them with the <code>st_read()</code> function, by specifying the <code>dsn</code> and the <code>layer</code>. This can be written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## obtain track points</span>
track.points =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="dt">dsn =</span><span class="st">&quot;./tracks/Track-181204-075451.gpx&quot;</span> ,<span class="dt">layer =</span> <span class="st">&quot;track_points&quot;</span>)</code></pre>
<pre><code>Reading layer `track_points&#39; from data source `E:\bookdown\spatil_r\tracks\Track-181204-075451.gpx&#39; using driver `GPX&#39;
Simple feature collection with 1467 features and 24 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 39.68927 ymin: -8.033337 xmax: 39.75059 ymax: -7.977127
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## drop other variable that are not needed</span>
track.points =<span class="st"> </span>track.points <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">elevation =</span> ele, time, speed)
<span class="co">## display</span>
track.points</code></pre>
<pre><code>Simple feature collection with 1467 features and 3 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 39.68927 ymin: -8.033337 xmax: 39.75059 ymax: -7.977127
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
First 10 features:
   elevation                time    speed
1       -3.7 2018-12-04 07:54:55 1.471591
2       -5.0 2018-12-04 07:54:58 1.479312
3       -5.6 2018-12-04 07:55:00 1.358867
4       -5.8 2018-12-04 07:55:02 1.530269
5       -5.9 2018-12-04 07:55:04 1.424751
6       -6.1 2018-12-04 07:55:05 1.381000
7       -6.2 2018-12-04 07:55:07 1.437619
8       -6.3 2018-12-04 07:55:09 0.994958
9       -6.3 2018-12-04 07:55:11 1.032018
10      -6.4 2018-12-04 07:55:13 1.369676
                     geometry
1  POINT (39.75051 -7.977127)
2  POINT (39.75052 -7.977157)
3  POINT (39.75052 -7.977185)
4  POINT (39.75052 -7.977215)
5  POINT (39.75052 -7.977243)
6  POINT (39.75052 -7.977262)
7   POINT (39.75052 -7.97729)
8   POINT (39.75051 -7.97731)
9   POINT (39.75051 -7.97733)
10  POINT (39.7505 -7.977353)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">track =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="dt">dsn =</span><span class="st">&quot;./tracks/Track-181204-075451.gpx&quot;</span> ,<span class="dt">layer =</span> <span class="st">&quot;tracks&quot;</span>)</code></pre>
<pre><code>Reading layer `tracks&#39; from data source `E:\bookdown\spatil_r\tracks\Track-181204-075451.gpx&#39; using driver `GPX&#39;
Simple feature collection with 1 feature and 12 fields
geometry type:  MULTILINESTRING
dimension:      XY
bbox:           xmin: 39.68927 ymin: -8.033337 xmax: 39.75059 ymax: -7.977127
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">track</code></pre>
<pre><code>Simple feature collection with 1 feature and 12 fields
geometry type:  MULTILINESTRING
dimension:      XY
bbox:           xmin: 39.68927 ymin: -8.033337 xmax: 39.75059 ymax: -7.977127
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
                               name  cmt
1 Tracking android:60fd0ef637a6eb1b &lt;NA&gt;
                                     desc  src link1_href
1 Tracking recently started 12/4/18 07:54 &lt;NA&gt;       &lt;NA&gt;
  link1_text link1_type link2_href link2_text link2_type number
1       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;  10193
  type                       geometry
1 &lt;NA&gt; MULTILINESTRING ((39.75051 ...</code></pre>
</div>
</div>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">16.2</span> Introduction</h2>
<p>A satisfying and important aspect of geographic research is communicating the results in spatial context. With recent advance in technology from satellite, internet and mobile location services, the amount of geographical data has increased significantly. Plenty of data are generated daily with latitude and longitude coordinates attached to it both from satellite observation and social media. To be able to build up a good mental model of the spatial data, you need to invest considerable effort in making your maps as self-explanatory as possible. In this chapter, you’ll learn some of the tools that <strong>ggplot2</strong> provides to make elegand maps and graphics <span class="citation">(Wickham <a href="#ref-ggplot">2016</a>)</span>.</p>
<p>Maps are great way to understand patterns from data over space. They are scaled down versions of the physical world, and they’re everywhere. R has several systems for making graphs, but <strong>ggplot2</strong> is one of the most elegant and most versatile. <strong>ggplot2</strong> implements the <em>grammar of graphics</em>, a coherent system for describing and building graphs. The chapter also introduce you to some extended functionalities from <strong>sf</strong> <span class="citation">(Pebesma <a href="#ref-sf">2018</a>)</span>, <strong>cowplot</strong> <span class="citation">(Wilke <a href="#ref-cowplot">2019</a>)</span>, <strong>ggsn</strong> <span class="citation">(Santos Baquero <a href="#ref-ggsn">2019</a>)</span>, <strong>ggsci</strong> <span class="citation">(Xiao <a href="#ref-ggsci">2018</a>)</span>, <strong>metR</strong> <span class="citation">(Campitelli <a href="#ref-metr">2019</a>)</span>, <strong>ggrepel</strong> <span class="citation">(Slowikowski <a href="#ref-ggrepel">2018</a>)</span>, <strong>gganimate</strong> <span class="citation">(Pedersen and Robinson <a href="#ref-gganimate">2019</a>)</span> and <strong>egg</strong> <span class="citation">(Auguie <a href="#ref-egg">2018</a>)</span> packages. Therefore, this chapter focuses on the tools you need to create good graphics. Rather than loading those extensions here, we’ll refer to their functions explicitly, using the <code>::</code> notation. This will help make it clear which functions are built into <strong>ggplot2</strong>, and which come from other packages. Ensure you have these packages in your machine, otherwise install them with <code>install.packages()</code> if you don’t already have them.</p>
</div>
<div id="static-maps" class="section level2">
<h2><span class="header-section-number">16.3</span> Static Maps</h2>
<p>Static maps are the most common type of visual output from spatial objects. Fixed images for printed outputs, common formats for static maps include .<code>png</code> and <code>.pd</code>f, for raster and vector outputs, respectively. Initially static maps were the only type of map that R could produce. Things have advanced greatly since <code>sp</code> was released (see <span class="citation">Bivand, Pebesma, and Gomez-Rubio (<a href="#ref-sp">2013</a>)</span>). Many new techniques for map making have been developed since then. However, a decade later static plotting was still the emphasis of geographic data visualisation in R (Cheshire and Lovelace 2015).</p>
<p>Despite the innovation of interactive mapping in R, static maps are still the foundation of mapping in R. The base <code>plot()</code> function is often the fastest way to create static maps from vector and raster spatial objects. Sometimes simplicity and speed are priorities, especially during the development phase of a project, and this is where <code>plot()</code> excels. The base R approach is also extensible, with <code>plot()</code> offering dozens of arguments. Another low-level approach is the <strong>grid</strong> package, which provides functions for low-level control of graphical outputs. This section, however, focus on how to make static maps with <strong>ggplot2</strong>, emphasizing the important aesthetic and layout options.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)</code></pre>
<div id="the-bathmetry-data" class="section level3">
<h3><span class="header-section-number">16.3.1</span> The bathmetry data</h3>
<p><strong>ggplot2</strong> works with data that are tidy—data frame arranged in such way that observations are in rows and variables are in columns and each value must have its own cell. But, the bathmetry data is from ETOPO1 and came in <code>.asc</code> format. First read the file with the <code>raster::raster()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## read the ascii file</span>
tz.bath =<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="st">&quot;e:/GIS/ROADMAP/Etopo 1/Tanzania_etopo1/tanz1_-3432.asc&quot;</span>)
tz.bath <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>()</code></pre>
<pre><code>[1] &quot;RasterLayer&quot;
attr(,&quot;package&quot;)
[1] &quot;raster&quot;</code></pre>
<p>We notice that the file is raster and ggplot2 requires data.frame. To continue, we need to convert the data and tidy in format that is **plot2–readable. Specifically, we need to convert raster file into data frame with <code>raster::as.data.frame(xy = TRUE)</code> and specify the <code>xy = TRUE</code> argument. We then rename the x to lon, y to lat and convert bathmetry values from the double presion to integer and select values within the geographical extend of interest and depth between 0 and 1200 meter deep.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## convert raster to data frame</span>
tz.bath.df =<span class="st"> </span>tz.bath <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>raster<span class="op">::</span><span class="kw">as.data.frame</span>(<span class="dt">xy =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>()

<span class="co">## rename the variable</span>
tz.bath.df =<span class="st"> </span>tz.bath.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">depth =</span> <span class="dv">3</span>)<span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">depth =</span> <span class="kw">as.integer</span>(depth))

<span class="co">## chop the area of interest </span>
off.kimbiji =<span class="st"> </span>tz.bath.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="fl">38.5</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">40</span> <span class="op">&amp;</span><span class="st"> </span>
<span class="st">           </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="fl">-7.2</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="dv">6</span> <span class="op">&amp;</span><span class="st"> </span>
<span class="st">           </span>depth <span class="op">&gt;</span><span class="st"> </span><span class="dv">-1200</span><span class="op">&amp;</span><span class="st"> </span>depth <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>  )</code></pre>
<p>The bathmetry file now contain three variables, the <code>lon</code>, <code>lat</code> and <code>depth</code> as seen in table <a href="graphics.html#tab:tab91">16.1</a></p>
<pre class="sourceCode r"><code class="sourceCode r">off.kimbiji <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Depth (meters)&quot;</span>), <span class="dt">digits =</span> <span class="dv">3</span>,
               <span class="dt">caption =</span> <span class="st">&quot;Ten randomly selected points of bathmetry values off Kimbiji, Tanzania&quot;</span>, <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>)<span class="op">%&gt;%</span>
<span class="st">  </span>kableExtra<span class="op">::</span><span class="kw">column_spec</span>(<span class="dt">column =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">width =</span> <span class="st">&quot;3cm&quot;</span>)<span class="op">%&gt;%</span>
<span class="st">  </span>kableExtra<span class="op">::</span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;Coordinate (Degree)&quot;</span> =<span class="st"> </span><span class="dv">2</span>,<span class="st">&quot;&quot;</span>))</code></pre>
<table>
<caption>
<span id="tab:tab91">Table 16.1: </span>Ten randomly selected points of bathmetry values off Kimbiji, Tanzania
</caption>
<thead>
<tr>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordinate (Degree)
</div>
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:center;">
Longitude
</th>
<th style="text-align:center;">
Latitude
</th>
<th style="text-align:center;">
Depth (meters)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
39.983
</td>
<td style="text-align:center;width: 3cm; ">
-6.733
</td>
<td style="text-align:center;width: 3cm; ">
-512
</td>
</tr>
<tr>
<td style="text-align:center;">
39.133
</td>
<td style="text-align:center;width: 3cm; ">
-6.200
</td>
<td style="text-align:center;width: 3cm; ">
-1
</td>
</tr>
<tr>
<td style="text-align:center;">
39.017
</td>
<td style="text-align:center;width: 3cm; ">
-6.317
</td>
<td style="text-align:center;width: 3cm; ">
-4
</td>
</tr>
<tr>
<td style="text-align:center;">
39.067
</td>
<td style="text-align:center;width: 3cm; ">
-6.317
</td>
<td style="text-align:center;width: 3cm; ">
-2
</td>
</tr>
<tr>
<td style="text-align:center;">
39.333
</td>
<td style="text-align:center;width: 3cm; ">
-6.517
</td>
<td style="text-align:center;width: 3cm; ">
-18
</td>
</tr>
<tr>
<td style="text-align:center;">
39.767
</td>
<td style="text-align:center;width: 3cm; ">
-6.700
</td>
<td style="text-align:center;width: 3cm; ">
-504
</td>
</tr>
<tr>
<td style="text-align:center;">
39.650
</td>
<td style="text-align:center;width: 3cm; ">
-6.400
</td>
<td style="text-align:center;width: 3cm; ">
-310
</td>
</tr>
<tr>
<td style="text-align:center;">
39.117
</td>
<td style="text-align:center;width: 3cm; ">
-6.017
</td>
<td style="text-align:center;width: 3cm; ">
-6
</td>
</tr>
<tr>
<td style="text-align:center;">
39.150
</td>
<td style="text-align:center;width: 3cm; ">
-6.250
</td>
<td style="text-align:center;width: 3cm; ">
-4
</td>
</tr>
<tr>
<td style="text-align:center;">
39.900
</td>
<td style="text-align:center;width: 3cm; ">
-6.717
</td>
<td style="text-align:center;width: 3cm; ">
-419
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="basemap" class="section level2">
<h2><span class="header-section-number">16.4</span> Basemap</h2>
<p>We also need basemap—country boundary layer. We use the st_read() function from <strong>sf</strong> package to read the shapefile boundary layer. Since the layer is for the whole Africa, to reduce the processing time for ploting the map of africa, we use the <code>st_crop()</code> function to chop the area of interest.</p>
<pre class="sourceCode r"><code class="sourceCode r">africa =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="st">&quot;./data/africa.shp&quot;</span>)</code></pre>
<pre><code>Reading layer `africa&#39; from data source `E:\bookdown\spatil_r\data\africa.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 59 features and 7 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -25.35875 ymin: -34.83983 xmax: 57.80085 ymax: 37.34962
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">kimbiji =<span class="st"> </span>africa <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_crop</span>(<span class="dt">xmin =</span> <span class="fl">38.0</span>, <span class="dt">xmax =</span> <span class="fl">40.5</span>, <span class="dt">ymin =</span> <span class="dv">-8</span>, <span class="dt">ymax =</span> <span class="fl">-5.5</span>)</code></pre>
</div>
<div id="creating-contour-map" class="section level2">
<h2><span class="header-section-number">16.5</span> Creating contour map</h2>
<p>Once we have the data ready, we can tools in <strong>ggplot2</strong> and add-on packages to create the bathmetry map off–Kimbiji located between longitude 38.5°E and 40.1°E and latitude 7.2°S and `r LatLabel(-6.0). The code block below was used to create figure <a href="graphics.html#fig:fig901">16.1</a></p>
<div class="figure"><span id="fig:fig901"></span>
<img src="spatil_r_files/figure-html/fig901-1.png" alt="Map of Off-Kimbiji showing contour lines. The grey lines are contour at 50 m interval and the black line are contoured at 200 m intervals" width="672" />
<p class="caption">
Figure 16.1: Map of Off-Kimbiji showing contour lines. The grey lines are contour at 50 m interval and the black line are contoured at 200 m intervals
</p>
</div>
<p>There are fourteen lined of codes in the chunk to make figure <a href="graphics.html#fig:fig901">16.1</a>. That’s a lot! Don’t get intimidated, I will explain in detail how each line of code work together to make this figure. As before, you start plotting <strong>ggplot2</strong> with the <code>ggplot()</code> function as the first line. Surprisingly, the <code>ggplot()</code> is empty without any argument specified. When mapping with <code>geom_sf()</code> function in <strong>ggplot2</strong> package, you are advised to leave the <code>ggplot()</code> function empty. This will allow the geom_sf() to label the axes with the appropriate geographical labelling for longitude and latitude. The second line of gode add a simple feature with a <code>geom_sf()</code> function from <strong>sf</strong> package. Note however, I specified the <code>geom_sf()</code> to fill the boundary layer with grey of 90 shade and the stroke with black colour.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-470-1.png" width="672" /></p>
<p>note that <strong>ggplot2</strong> plot the map with default aesthetic settings. The plot background is filled with gray color and without stroke but the grids are white colored. The third line add the contour lines spaced at 50 meter intervals. Instead of using <code>geom_contour()</code> from ggplot2, the <code>geom_contour2()</code> from <strong>metR</strong> package was used. They both serve the same task.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
<p>Like the third line, the fourth line add contour lines, but instead of spacing them into meters, these are spaced at 200 meters interval and are black in color.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-472-1.png" width="672" /></p>
<p>The fifth line add the label on contour spaced at 200 meter interval with <code>geom_text_contour()</code> function from <strong>metR</strong> package. Here is where you will find the useful of package like <strong>metR</strong> that extends the <strong>ggplot2</strong>, for which the current version (2.3.1.1) is unable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
<p>The sixth line zoom the map to only the geographical extent we are interested with using the <code>coord_sf()</code> function from <strong>sf</strong> package. We could also use the <code>coord_cartesin()</code> to limit the area.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-474-1.png" width="672" /></p>
<p>We got a glimpse of the map now, let us use theme to make some changes. The background was set to white with <code>panel.background = element_rect(fill = "white")</code>, and removed grids with <code>panel.grid = element_line(colour = NA)</code> and change the font size of the axis label to 11 points with <code>axis.text = element_text(size = 11)</code>. The <code>theme_bw()</code> just set the border of the plot to black with solid line.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
<p>The good thing to start making maps is with an understanding of the map elements. A static map can be composed of many different map elements. These include <code>main map body</code>, <code>legend</code>, <code>title</code>, <code>scale indicator</code>, <code>orientation indicator</code>, <code>inset map</code> and <code>source</code> or <code>ancillary</code> information. By increasing the font size of axis textual label to 11, the axes are cluttered. adding the scale can improve the labelling. <code>scale_x_continuous(breaks = seq(39.2, 39.8, .2))</code> in line 9 force ggplot2 to label the x–axis four letter that are spaced with 0.2 latitude and <code>scale_y_continuous(breaks = seq(-6.95, -6.35, length.out = 4))</code> in line 10 label four digits of longitude.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-476-1.png" width="672" /></p>
<p>Because the axes are abbreviated with longitude and latitude symbol, line 11 in the code remove the axes title label. Line 12 to 14 add textual label on the map with the <code>annotate()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.28</span>, <span class="dt">y =</span> <span class="fl">-6.48</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar </span><span class="ch">\n</span><span class="st">Channel&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.5</span>, <span class="dt">y =</span> <span class="fl">-6.37</span>, <span class="dt">label =</span> <span class="st">&quot;Unguja </span><span class="ch">\n</span><span class="st">Island&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.3</span>, <span class="dt">y =</span> <span class="fl">-6.91</span>, <span class="dt">label =</span> <span class="st">&quot;Dar es Salaam&quot;</span>)</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-477-1.png" width="672" />
Close look of figure <a href="graphics.html#fig:fig901">16.1</a>, the north arrrow and the scale bar are missing. The last two lines of our code inset the scalebar and north arrow on map using the <code>ggsn::scalebar()</code> from <strong>ggsn</strong> package and <code>ggspatial::annotation_north_arrow()</code> functions from <strong>ggspatial</strong> package.</p>
<p>In a nutshell, making this map using <strong>ggplot2</strong> and ancillary extensions used fiften line codes and hundred of arguments. This are very common task of making maps with the combination of tools from different packages.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.28</span>, <span class="dt">y =</span> <span class="fl">-6.48</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar </span><span class="ch">\n</span><span class="st">Channel&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.5</span>, <span class="dt">y =</span> <span class="fl">-6.37</span>, <span class="dt">label =</span> <span class="st">&quot;Unguja </span><span class="ch">\n</span><span class="st">Island&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.3</span>, <span class="dt">y =</span> <span class="fl">-6.91</span>, <span class="dt">label =</span> <span class="st">&quot;Dar es Salaam&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggsn<span class="op">::</span><span class="kw">scalebar</span>(<span class="dt">location =</span> <span class="st">&quot;bottomleft&quot;</span>, <span class="dt">x.min =</span> <span class="fl">39.2</span>, <span class="dt">x.max =</span> <span class="fl">39.8</span>,
                 <span class="dt">y.min =</span> <span class="fl">-6.98</span>, <span class="dt">y.max =</span> <span class="fl">-6.35</span>, <span class="dt">dist =</span> <span class="dv">10</span>, <span class="dt">dist_unit =</span> <span class="st">&quot;km&quot;</span>,
                 <span class="dt">transform =</span> <span class="ot">TRUE</span>, <span class="dt">model =</span> <span class="st">&quot;WGS84&quot;</span>, <span class="dt">st.dist =</span> <span class="fl">0.03</span>, <span class="dt">st.size =</span> <span class="dv">4</span>,
                 <span class="dt">height =</span> <span class="fl">0.03</span>)<span class="op">+</span>
<span class="st">  </span><span class="co"># ggspatial::annotation_scale(height = unit(.35, &quot;cm&quot;), pad_x = unit(.5, &quot;cm&quot;), </span>
<span class="st">  </span><span class="co">#                             tick_height = unit(3, &quot;cm&quot;), pad_y = unit(.5, &quot;cm&quot;), text_cex = .85)+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/unnamed-chunk-478-1.png" width="672" /></p>
<p><strong>metR</strong> package has <code>geom_contour_fill()</code> function that draw filled contour lines and <code>geom_contour_tanaka()</code>, which illunate contours with varying brithtness to create an illusion of relief. The code chunk to create highlighted filled contour using <strong>metR</strong> function can be written as;</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_tanaka</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
                          <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.0</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsGebco</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.28</span>, <span class="dt">y =</span> <span class="fl">-6.48</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar </span><span class="ch">\n</span><span class="st">Channel&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.5</span>, <span class="dt">y =</span> <span class="fl">-6.37</span>, <span class="dt">label =</span> <span class="st">&quot;Unguja </span><span class="ch">\n</span><span class="st">Island&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.3</span>, <span class="dt">y =</span> <span class="fl">-6.91</span>, <span class="dt">label =</span> <span class="st">&quot;Dar es Salaam&quot;</span>)<span class="op">+</span>
<span class="st">   </span>ggsn<span class="op">::</span><span class="kw">scalebar</span>(<span class="dt">location =</span> <span class="st">&quot;bottomleft&quot;</span>, <span class="dt">x.min =</span> <span class="fl">39.2</span>, <span class="dt">x.max =</span> <span class="fl">39.8</span>,
                 <span class="dt">y.min =</span> <span class="fl">-6.98</span>, <span class="dt">y.max =</span> <span class="fl">-6.35</span>, <span class="dt">dist =</span> <span class="dv">10</span>, <span class="dt">dist_unit =</span> <span class="st">&quot;km&quot;</span>,
                 <span class="dt">transform =</span> <span class="ot">TRUE</span>, <span class="dt">model =</span> <span class="st">&quot;WGS84&quot;</span>, <span class="dt">st.dist =</span> <span class="fl">0.03</span>, <span class="dt">st.size =</span> <span class="dv">4</span>,
                 <span class="dt">height =</span> <span class="fl">0.03</span>)<span class="op">+</span>
<span class="st">  </span><span class="co"># ggspatial::annotation_scale(location = &quot;bl&quot;)+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">height =</span> <span class="kw">unit</span>(<span class="fl">1.0</span>, <span class="st">&quot;cm&quot;</span>))</code></pre>
<p><img src="spatil_r_files/figure-html/fig903-1.png" width="672" /></p>
</div>
<div id="inset-maps" class="section level2">
<h2><span class="header-section-number">16.6</span> Inset maps</h2>
<p>An inset map is a smaller map rendered within or next to the main map. It could serve many different purposes, including showing the relative position of the study area in regional area. In figure <a href="#fig:fig9011"><strong>??</strong></a> is the map showing the contour interval off-kimbiji, Tanzania. The inset map show the area of Kimbiji in the Western Indian Ocean Region. The chunk below was used to create figure <a href="graphics.html#fig:fig911">16.2</a>. In a nutshell, we assign the study area map as <code>main.map</code> and the regional map as <code>inset.map</code> and then we used function from the <strong>cowplot</strong> package to combine the two maps.</p>
<pre class="sourceCode r"><code class="sourceCode r">main.map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), 
               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.28</span>, <span class="dt">y =</span> <span class="fl">-6.48</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar </span><span class="ch">\n</span><span class="st">Channel&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.5</span>, <span class="dt">y =</span> <span class="fl">-6.37</span>, <span class="dt">label =</span> <span class="st">&quot;Unguja </span><span class="ch">\n</span><span class="st">Island&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.3</span>, <span class="dt">y =</span> <span class="fl">-6.91</span>, <span class="dt">label =</span> <span class="st">&quot;Dar es Salaam&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>)

world =<span class="st"> </span>spData<span class="op">::</span>world
aoi =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">38.5</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="fl">38.5</span>, <span class="fl">38.5</span>), 
                 <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">-8</span>, <span class="dv">-6</span>, <span class="dv">-6</span>, <span class="dv">-8</span>))

inset.map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">37</span>, <span class="dv">45</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">12</span>,<span class="op">-</span><span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> aoi, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)

cowplot<span class="op">::</span><span class="kw">ggdraw</span>()<span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> main.map, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> inset.map, <span class="dt">x =</span> <span class="fl">.558</span>, <span class="dt">y =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.3</span>,<span class="dt">height =</span> <span class="fl">.3</span>)</code></pre>
<div class="figure"><span id="fig:fig911"></span>
<img src="spatil_r_files/figure-html/fig911-1.png" alt="The main map with the inset map showing the positon of the study areas in the region" width="672" />
<p class="caption">
Figure 16.2: The main map with the inset map showing the positon of the study areas in the region
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">main.map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_tanaka</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> off.kimbiji, 
               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth), <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="fl">3.4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> kimbiji, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="ot">NA</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.2</span>, <span class="fl">39.8</span>, <span class="fl">.2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">6.95</span>, <span class="fl">-6.35</span>, <span class="dt">length.out =</span> <span class="dv">4</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsGebco</span>(<span class="dv">120</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.28</span>, <span class="dt">y =</span> <span class="fl">-6.48</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar </span><span class="ch">\n</span><span class="st">Channel&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.5</span>, <span class="dt">y =</span> <span class="fl">-6.37</span>, <span class="dt">label =</span> <span class="st">&quot;Unguja </span><span class="ch">\n</span><span class="st">Island&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.3</span>, <span class="dt">y =</span> <span class="fl">-6.91</span>, <span class="dt">label =</span> <span class="st">&quot;Dar es Salaam&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>)<span class="op">+</span>
<span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">75</span>, <span class="st">&quot;cm&quot;</span>))

world =<span class="st"> </span>spData<span class="op">::</span>world
aoi =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">38.5</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="fl">38.5</span>, <span class="fl">38.5</span>), 
                 <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">-8</span>, <span class="dv">-6</span>, <span class="dv">-6</span>, <span class="dv">-8</span>))

inset.map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> world, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">37</span>, <span class="dv">45</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">12</span>,<span class="op">-</span><span class="dv">1</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> aoi, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)

cowplot<span class="op">::</span><span class="kw">ggdraw</span>()<span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> main.map, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> inset.map, <span class="dt">x =</span> <span class="fl">.558</span>, <span class="dt">y =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.3</span>,<span class="dt">height =</span> <span class="fl">.3</span>)</code></pre>
<div class="figure"><span id="fig:fig912"></span>
<img src="spatil_r_files/figure-html/fig912-1.png" alt="The main map with the inset map showing the positon of the study areas in the region" width="672" />
<p class="caption">
Figure 16.3: The main map with the inset map showing the positon of the study areas in the region
</p>
</div>
<div id="choropleth-maps" class="section level3">
<h3><span class="header-section-number">16.6.1</span> Choropleth maps</h3>
<p>Chloropleth maps use color or shading on predefined areas to map values of a numeric or categorical variable in that area. For example we are interested to map the different coral reefs in Jibondo Island, Mafia, Tanzania. First we import the data into R using the <code>st_read()</code> function from <strong>sf</strong> package <span class="citation">(Pebesma <a href="#ref-sf">2018</a>)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">jibondo.reefs =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="dt">dsn =</span> <span class="st">&quot;./data/jibondo_reefs.shp&quot;</span>)</code></pre>
<pre><code>Reading layer `jibondo_reefs&#39; from data source `E:\bookdown\spatil_r\data\jibondo_reefs.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 16 features and 4 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: 39.58571 ymin: -8.135198 xmax: 39.83 ymax: -7.903451
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>The <code>jibondo.reefs</code> file is simple feature (equivalent to shapefile) with sixteeen polygons in four groups—coastal-shallow areas, islands, reef flat and submerged reefs. We use the variable type to map the different coastal features in Jibondo. The code used to make figure <a href="graphics.html#fig:fig904">16.4</a> is written as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(RColorBrewer)

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> jibondo.reefs, <span class="kw">aes</span>(<span class="dt">fill =</span> type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.57</span>, <span class="fl">39.88</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.15</span>,<span class="op">-</span><span class="fl">7.88</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf_text</span>(<span class="dt">data =</span> jibondo.reefs, <span class="kw">aes</span>(<span class="dt">label =</span> mwamba), <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">8</span>,.<span class="dv">18</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Accent&quot;</span>) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">0.1</span>) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_y_latitude</span>(<span class="dt">ticks =</span> <span class="fl">0.08</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Reef Type&quot;</span>,
                             <span class="dt">title.position =</span>  <span class="st">&quot;top&quot;</span>,
                             <span class="dt">keywidth =</span> <span class="fl">1.1</span>,
                             <span class="dt">ncol =</span> <span class="dv">1</span>))</code></pre>
<div class="figure"><span id="fig:fig904"></span>
<img src="spatil_r_files/figure-html/fig904-1.png" alt="Reefs and non-reeef features in Jibondo Island, Mafia" width="672" />
<p class="caption">
Figure 16.4: Reefs and non-reeef features in Jibondo Island, Mafia
</p>
</div>
<p>The variable used to make Figure <a href="graphics.html#fig:fig904">16.4</a> is a categorical, but we can also map continuous variables. For this case, we want to map the catch per unit effort (CPUE) of octopus at each reef to identify octopus catches at different reefs as seen in figure</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(RColorBrewer)

<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> jibondo.reefs, 
          <span class="kw">aes</span>(<span class="dt">fill =</span> cpue <span class="op">%&gt;%</span><span class="kw">round</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.factor</span>()))<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.57</span>, <span class="fl">39.88</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.15</span>,<span class="op">-</span><span class="fl">7.88</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf_text</span>(<span class="dt">data =</span> jibondo.reefs, <span class="kw">aes</span>(<span class="dt">label =</span> mwamba), <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+%</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">25</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co"># scale_fill_brewer(palette = &quot;Accent&quot;) +</span>
<span class="st">  </span>ggsci<span class="op">::</span><span class="kw">scale_fill_d3</span>()<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">0.1</span>) <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_y_latitude</span>(<span class="dt">ticks =</span> <span class="fl">0.08</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span>  <span class="st">&quot;top&quot;</span>,
                             <span class="dt">keywidth =</span> <span class="fl">1.1</span>,
                             <span class="dt">ncol =</span> <span class="dv">1</span>, 
                             <span class="dt">title =</span> <span class="st">&quot;CPUE&quot;</span>))</code></pre>
<div class="figure"><span id="fig:fig905"></span>
<img src="spatil_r_files/figure-html/fig905-1.png" alt="Catches of Octopus at Jibondo Island" width="672" />
<p class="caption">
Figure 16.5: Catches of Octopus at Jibondo Island
</p>
</div>
<p>Finally let’s map the the spatial patterns of sea surface temperature anomaly. We plot the departure of sea surface temperature from zonal average mean. Let’s import the dataset from the workspace. For more information on how to compute the zonal departure see chapter…</p>
<pre class="sourceCode r"><code class="sourceCode r">temperature.anomaly =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;./data/sst_anomaly.csv&quot;</span>)</code></pre>
<table>
<thead>
<tr>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordinate (Degree)
</div>
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:center;">
Latitude
</th>
<th style="text-align:center;">
Longitude
</th>
<th style="text-align:center;">
Depth
</th>
<th style="text-align:center;">
Anomaly
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
70.5
</td>
<td style="text-align:center;width: 2cm; ">
-11.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-0.18
</td>
</tr>
<tr>
<td style="text-align:center;">
-70.5
</td>
<td style="text-align:center;width: 2cm; ">
-90.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-0.07
</td>
</tr>
<tr>
<td style="text-align:center;">
-15.5
</td>
<td style="text-align:center;width: 2cm; ">
-1.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-3.81
</td>
</tr>
<tr>
<td style="text-align:center;">
-40.5
</td>
<td style="text-align:center;width: 2cm; ">
-168.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
0.81
</td>
</tr>
<tr>
<td style="text-align:center;">
-55.5
</td>
<td style="text-align:center;width: 2cm; ">
34.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-2.13
</td>
</tr>
<tr>
<td style="text-align:center;">
-10.5
</td>
<td style="text-align:center;width: 2cm; ">
119.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
1.32
</td>
</tr>
<tr>
<td style="text-align:center;">
55.5
</td>
<td style="text-align:center;width: 2cm; ">
-45.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-0.53
</td>
</tr>
<tr>
<td style="text-align:center;">
-60.5
</td>
<td style="text-align:center;width: 2cm; ">
-11.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-1.73
</td>
</tr>
<tr>
<td style="text-align:center;">
70.5
</td>
<td style="text-align:center;width: 2cm; ">
-13.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
-0.56
</td>
</tr>
<tr>
<td style="text-align:center;">
55.5
</td>
<td style="text-align:center;width: 2cm; ">
0.5
</td>
<td style="text-align:center;width: 2cm; ">
0
</td>
<td style="text-align:center;width: 2cm; ">
3.26
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> temperature.anomaly,
                          <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> anomaly), <span class="dt">na.fill =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span>  spData<span class="op">::</span>world, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">178</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">85</span>), <span class="dt">clip =</span> <span class="st">&quot;on&quot;</span>, <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), 
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>anomaly<span class="op">~</span>(degree<span class="op">*</span>C)),
                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, 
                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, 
                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),
                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,
                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,
                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),
                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="fl">6.5</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_y_latitude</span>(<span class="dt">ticks =</span> <span class="dv">30</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="dv">45</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</code></pre>
<div class="figure"><span id="fig:fig906"></span>
<img src="spatil_r_files/figure-html/fig906-1.png" alt="center" width="672" />
<p class="caption">
Figure 16.6: center
</p>
</div>
</div>
</div>
<div id="animated-maps" class="section level2">
<h2><span class="header-section-number">16.7</span> Animated maps</h2>
</div>
<div id="interactive-maps" class="section level2">
<h2><span class="header-section-number">16.8</span> Interactive maps</h2>
<hr />

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-egg">
<p>Auguie, Baptiste. 2018. <em>Egg: Extensions for ’Ggplot2’: Custom Geom, Plot Alignment, Symmetrised Scale, and Fixed Panel Size</em>. <a href="https://CRAN.R-project.org/package=egg">https://CRAN.R-project.org/package=egg</a>.</p>
</div>
<div id="ref-sp">
<p>Bivand, Roger S., Edzer Pebesma, and Virgilio Gomez-Rubio. 2013. <em>Applied Spatial Data Analysis with R, Second Edition</em>. Springer, NY. <a href="http://www.asdar-book.org/">http://www.asdar-book.org/</a>.</p>
</div>
<div id="ref-metr">
<p>Campitelli, Elio. 2019. <em>MetR: Tools for Easier Analysis of Meteorological Fields</em>. <a href="https://CRAN.R-project.org/package=metR">https://CRAN.R-project.org/package=metR</a>.</p>
</div>
<div id="ref-sf">
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em>. <a href="https://journal.r-project.org/archive/2018/RJ-2018-009/index.html">https://journal.r-project.org/archive/2018/RJ-2018-009/index.html</a>.</p>
</div>
<div id="ref-gganimate">
<p>Pedersen, Thomas Lin, and David Robinson. 2019. <em>Gganimate: A Grammar of Animated Graphics</em>. <a href="https://CRAN.R-project.org/package=gganimate">https://CRAN.R-project.org/package=gganimate</a>.</p>
</div>
<div id="ref-ggsn">
<p>Santos Baquero, Oswaldo. 2019. <em>Ggsn: North Symbols and Scale Bars for Maps Created with ’Ggplot2’ or ’Ggmap’</em>. <a href="https://CRAN.R-project.org/package=ggsn">https://CRAN.R-project.org/package=ggsn</a>.</p>
</div>
<div id="ref-ggrepel">
<p>Slowikowski, Kamil. 2018. <em>Ggrepel: Automatically Position Non-Overlapping Text Labels with ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.</p>
</div>
<div id="ref-ggplot">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
<div id="ref-cowplot">
<p>Wilke, Claus O. 2019. <em>Cowplot: Streamlined Plot Theme and Plot Annotations for ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.</p>
</div>
<div id="ref-ggsci">
<p>Xiao, Nan. 2018. <em>Ggsci: Scientific Journal and Sci-Fi Themed Color Palettes for ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggsci">https://CRAN.R-project.org/package=ggsci</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-grammar-for-graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="animation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["spatil_r.pdf", "spatil_r.epub", "spatil_r.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
